/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/therapist/availability/template/route";
exports.ids = ["app/api/therapist/availability/template/route"];
exports.modules = {

/***/ "(rsc)/./app/api/therapist/availability/template/route.ts":
/*!**********************************************************!*\
  !*** ./app/api/therapist/availability/template/route.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_server_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/server-auth */ \"(rsc)/./lib/server-auth.ts\");\n/* harmony import */ var _lib_availability_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/availability-service */ \"(rsc)/./lib/availability-service.ts\");\n\n\n\n/**\n * Get availability templates for a therapist\n */ async function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const therapistId = searchParams.get('therapist_id');\n        if (!therapistId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Therapist ID is required'\n            }, {\n                status: 400\n            });\n        }\n        // Get availability in new format\n        const availability = await _lib_availability_service__WEBPACK_IMPORTED_MODULE_2__.AvailabilityService.getTherapistAvailability(therapistId);\n        const overrides = await _lib_availability_service__WEBPACK_IMPORTED_MODULE_2__.AvailabilityService.getAvailabilityOverrides(therapistId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            availability,\n            overrides,\n            templates: [] // Legacy support - can be enhanced later\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error('Error in template GET API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Create or update availability templates for a therapist\n */ async function POST(request) {\n    try {\n        // SECURE Authentication Check - only therapists can modify templates\n        const authResult = await (0,_lib_server_auth__WEBPACK_IMPORTED_MODULE_1__.requireApiAuth)([\n            'therapist'\n        ]);\n        if ('error' in authResult) {\n            return authResult.error;\n        }\n        const { session } = authResult;\n        const body = await request.json();\n        // Support both new and legacy formats\n        if (body.availability) {\n            // New format with WeeklyAvailability\n            const availability = body.availability;\n            if (!availability || !availability.standardHours || !availability.sessionSettings) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Invalid availability data. Standard hours and session settings are required.'\n                }, {\n                    status: 400\n                });\n            }\n            // Verify the therapist is updating their own availability\n            if (session.user.id !== body.therapist_id) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Unauthorized: You can only update your own availability'\n                }, {\n                    status: 403\n                });\n            }\n            // Save using the new service\n            const result = await _lib_availability_service__WEBPACK_IMPORTED_MODULE_2__.AvailabilityService.saveTherapistAvailability(body.therapist_id, availability);\n            if (!result.success) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: result.message\n                }, {\n                    status: 400\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: result.message,\n                templateId: result.templateId\n            }, {\n                status: 200\n            });\n        } else if (body.templates) {\n            // Legacy format support\n            const { therapist_id, templates } = body;\n            if (!therapist_id || !templates || !Array.isArray(templates)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Invalid request data. therapist_id and templates array are required.'\n                }, {\n                    status: 400\n                });\n            }\n            // Verify the therapist is updating their own templates\n            if (session.user.id !== therapist_id) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Unauthorized: You can only update your own templates'\n                }, {\n                    status: 403\n                });\n            }\n            // Validate templates data\n            for (const template of templates){\n                if (!template.day_of_week || template.day_of_week < 0 || template.day_of_week > 6) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'Invalid day_of_week. Must be between 0 (Sunday) and 6 (Saturday).'\n                    }, {\n                        status: 400\n                    });\n                }\n                if (!template.start_time || !template.end_time) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'start_time and end_time are required for each template.'\n                    }, {\n                        status: 400\n                    });\n                }\n                // Validate time format and logic\n                const startTime = new Date(`2000-01-01T${template.start_time}`);\n                const endTime = new Date(`2000-01-01T${template.end_time}`);\n                if (isNaN(startTime.getTime()) || isNaN(endTime.getTime())) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'Invalid time format. Use HH:MM format.'\n                    }, {\n                        status: 400\n                    });\n                }\n                if (startTime >= endTime) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'Start time must be before end time.'\n                    }, {\n                        status: 400\n                    });\n                }\n            }\n            // Delete existing templates for this therapist\n            const { error: deleteError } = await supabase.from('availability_templates').delete().eq('therapist_id', therapist_id);\n            if (deleteError) {\n                console.error('Error deleting existing templates:', deleteError);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Failed to update templates'\n                }, {\n                    status: 500\n                });\n            }\n            // Prepare new templates data\n            const templatesData = templates.map((template)=>({\n                    therapist_id,\n                    day_of_week: template.day_of_week,\n                    start_time: template.start_time,\n                    end_time: template.end_time,\n                    session_duration: template.session_duration || 45,\n                    session_type: template.session_type || 'individual',\n                    max_sessions: template.max_sessions || 1,\n                    is_active: true\n                }));\n            // Insert new templates\n            const { data: insertedTemplates, error: insertError } = await supabase.from('availability_templates').insert(templatesData).select();\n            if (insertError) {\n                console.error('Error inserting templates:', insertError);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Failed to save templates'\n                }, {\n                    status: 500\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: 'Availability templates updated successfully',\n                templates: insertedTemplates,\n                count: insertedTemplates.length\n            }, {\n                status: 200\n            });\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Invalid request format. Provide either availability or templates data.'\n            }, {\n                status: 400\n            });\n        }\n    } catch (error) {\n        console.error('Error in template POST API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Update a specific template\n */ async function PUT(request) {\n    try {\n        // SECURE Authentication Check\n        const authResult = await (0,_lib_server_auth__WEBPACK_IMPORTED_MODULE_1__.requireApiAuth)([\n            'therapist'\n        ]);\n        if ('error' in authResult) {\n            return authResult.error;\n        }\n        const { session } = authResult;\n        const body = await request.json();\n        const { template_id, updates } = body;\n        if (!template_id || !updates) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'template_id and updates are required'\n            }, {\n                status: 400\n            });\n        }\n        // Verify the therapist owns this template\n        const { data: existingTemplate, error: fetchError } = await supabase.from('availability_templates').select('therapist_id').eq('id', template_id).single();\n        if (fetchError || !existingTemplate) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Template not found'\n            }, {\n                status: 404\n            });\n        }\n        if (existingTemplate.therapist_id !== session.user.id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized: You can only update your own templates'\n            }, {\n                status: 403\n            });\n        }\n        // Update the template\n        const { data: updatedTemplate, error: updateError } = await supabase.from('availability_templates').update(updates).eq('id', template_id).select().single();\n        if (updateError) {\n            console.error('Error updating template:', updateError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Failed to update template'\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Template updated successfully',\n            template: updatedTemplate\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error('Error in template PUT API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Delete a specific template\n */ async function DELETE(request) {\n    try {\n        // SECURE Authentication Check\n        const authResult = await (0,_lib_server_auth__WEBPACK_IMPORTED_MODULE_1__.requireApiAuth)([\n            'therapist'\n        ]);\n        if ('error' in authResult) {\n            return authResult.error;\n        }\n        const { session } = authResult;\n        const { searchParams } = new URL(request.url);\n        const templateId = searchParams.get('template_id');\n        if (!templateId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'template_id is required'\n            }, {\n                status: 400\n            });\n        }\n        // Verify the therapist owns this template\n        const { data: existingTemplate, error: fetchError } = await supabase.from('availability_templates').select('therapist_id').eq('id', templateId).single();\n        if (fetchError || !existingTemplate) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Template not found'\n            }, {\n                status: 404\n            });\n        }\n        if (existingTemplate.therapist_id !== session.user.id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized: You can only delete your own templates'\n            }, {\n                status: 403\n            });\n        }\n        // Delete the template\n        const { error: deleteError } = await supabase.from('availability_templates').delete().eq('id', templateId);\n        if (deleteError) {\n            console.error('Error deleting template:', deleteError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Failed to delete template'\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Template deleted successfully'\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error('Error in template DELETE API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3RoZXJhcGlzdC9hdmFpbGFiaWxpdHkvdGVtcGxhdGUvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RDtBQUNMO0FBRWM7QUFJakU7O0NBRUMsR0FDTSxlQUFlRyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJRixRQUFRRyxHQUFHO1FBQzVDLE1BQU1DLGNBQWNILGFBQWFJLEdBQUcsQ0FBQztRQUVyQyxJQUFJLENBQUNELGFBQWE7WUFDaEIsT0FBT1IscURBQVlBLENBQUNVLElBQUksQ0FBQztnQkFDdkJDLE9BQU87WUFDVCxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDbkI7UUFFQSxpQ0FBaUM7UUFDakMsTUFBTUMsZUFBZSxNQUFNWCwwRUFBbUJBLENBQUNZLHdCQUF3QixDQUFDTjtRQUN4RSxNQUFNTyxZQUFZLE1BQU1iLDBFQUFtQkEsQ0FBQ2Msd0JBQXdCLENBQUNSO1FBRXJFLE9BQU9SLHFEQUFZQSxDQUFDVSxJQUFJLENBQUM7WUFDdkJPLFNBQVM7WUFDVEo7WUFDQUU7WUFDQUcsV0FBVyxFQUFFLENBQUMseUNBQXlDO1FBQ3pELEdBQUc7WUFBRU4sUUFBUTtRQUFJO0lBRW5CLEVBQUUsT0FBT0QsT0FBTztRQUNkUSxRQUFRUixLQUFLLENBQUMsOEJBQThCQTtRQUM1QyxPQUFPWCxxREFBWUEsQ0FBQ1UsSUFBSSxDQUFDO1lBQ3ZCQyxPQUFPO1FBQ1QsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDbkI7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZVEsS0FBS2hCLE9BQW9CO0lBQzdDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTWlCLGFBQWEsTUFBTXBCLGdFQUFjQSxDQUFDO1lBQUM7U0FBWTtRQUNyRCxJQUFJLFdBQVdvQixZQUFZO1lBQ3pCLE9BQU9BLFdBQVdWLEtBQUs7UUFDekI7UUFFQSxNQUFNLEVBQUVXLE9BQU8sRUFBRSxH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Q1RjLFNBQVM7UUFDWCxHQUFHO1lBQUVuQixRQUFRO1FBQUk7SUFFbkIsRUFBRSxPQUFPRCxPQUFPO1FBQ2RRLFFBQVFSLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9YLHFEQUFZQSxDQUFDVSxJQUFJLENBQUM7WUFDdkJDLE9BQU87UUFDVCxHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNuQjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvbWFjYm9vay9EZXNrdG9wL3RycGktYXBwL2FwcC9hcGkvdGhlcmFwaXN0L2F2YWlsYWJpbGl0eS90ZW1wbGF0ZS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgcmVxdWlyZUFwaUF1dGggfSBmcm9tICdAL2xpYi9zZXJ2ZXItYXV0aCc7XG5pbXBvcnQgeyBoYW5kbGVBcGlFcnJvciwgVmFsaWRhdGlvbkVycm9yLCBzdWNjZXNzUmVzcG9uc2UgfSBmcm9tICdAL2xpYi9hcGktcmVzcG9uc2UnO1xuaW1wb3J0IHsgQXZhaWxhYmlsaXR5U2VydmljZSB9IGZyb20gJ0AvbGliL2F2YWlsYWJpbGl0eS1zZXJ2aWNlJztcbmltcG9ydCB7IFdlZWtseUF2YWlsYWJpbGl0eSB9IGZyb20gJ0AvdHlwZXMvYXZhaWxhYmlsaXR5JztcbmltcG9ydCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcblxuLyoqXG4gKiBHZXQgYXZhaWxhYmlsaXR5IHRlbXBsYXRlcyBmb3IgYSB0aGVyYXBpc3RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCB0aGVyYXBpc3RJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3RoZXJhcGlzdF9pZCcpO1xuXG4gICAgaWYgKCF0aGVyYXBpc3RJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnVGhlcmFwaXN0IElEIGlzIHJlcXVpcmVkJyBcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGF2YWlsYWJpbGl0eSBpbiBuZXcgZm9ybWF0XG4gICAgY29uc3QgYXZhaWxhYmlsaXR5ID0gYXdhaXQgQXZhaWxhYmlsaXR5U2VydmljZS5nZXRUaGVyYXBpc3RBdmFpbGFiaWxpdHkodGhlcmFwaXN0SWQpO1xuICAgIGNvbnN0IG92ZXJyaWRlcyA9IGF3YWl0IEF2YWlsYWJpbGl0eVNlcnZpY2UuZ2V0QXZhaWxhYmlsaXR5T3ZlcnJpZGVzKHRoZXJhcGlzdElkKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGF2YWlsYWJpbGl0eSxcbiAgICAgIG92ZXJyaWRlcyxcbiAgICAgIHRlbXBsYXRlczogW10gLy8gTGVnYWN5IHN1cHBvcnQgLSBjYW4gYmUgZW5oYW5jZWQgbGF0ZXJcbiAgICB9LCB7IHN0YXR1czogMjAwIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gdGVtcGxhdGUgR0VUIEFQSTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBvciB1cGRhdGUgYXZhaWxhYmlsaXR5IHRlbXBsYXRlcyBmb3IgYSB0aGVyYXBpc3RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBTRUNVUkUgQXV0aGVudGljYXRpb24gQ2hlY2sgLSBvbmx5IHRoZXJhcGlzdHMgY2FuIG1vZGlmeSB0ZW1wbGF0ZXNcbiAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgcmVxdWlyZUFwaUF1dGgoWyd0aGVyYXBpc3QnXSk7XG4gICAgaWYgKCdlcnJvcicgaW4gYXV0aFJlc3VsdCkge1xuICAgICAgcmV0dXJuIGF1dGhSZXN1bHQuZXJyb3I7XG4gICAgfVxuXG4gICAgY29uc3QgeyBzZXNzaW9uIH0gPSBhdXRoUmVzdWx0O1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBcbiAgICAvLyBTdXBwb3J0IGJvdGggbmV3IGFuZCBsZWdhY3kgZm9ybWF0c1xuICAgIGlmIChib2R5LmF2YWlsYWJpbGl0eSkge1xuICAgICAgLy8gTmV3IGZvcm1hdCB3aXRoIFdlZWtseUF2YWlsYWJpbGl0eVxuICAgICAgY29uc3QgYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHkgPSBib2R5LmF2YWlsYWJpbGl0eTtcbiAgICAgIFxuICAgICAgaWYgKCFhdmFpbGFiaWxpdHkgfHwgIWF2YWlsYWJpbGl0eS5zdGFuZGFyZEhvdXJzIHx8ICFhdmFpbGFiaWxpdHkuc2Vzc2lvblNldHRpbmdzKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBhdmFpbGFiaWxpdHkgZGF0YS4gU3RhbmRhcmQgaG91cnMgYW5kIHNlc3Npb24gc2V0dGluZ3MgYXJlIHJlcXVpcmVkLicgXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZlcmlmeSB0aGUgdGhlcmFwaXN0IGlzIHVwZGF0aW5nIHRoZWlyIG93biBhdmFpbGFiaWxpdHlcbiAgICAgIGlmIChzZXNzaW9uLnVzZXIuaWQgIT09IGJvZHkudGhlcmFwaXN0X2lkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnVW5hdXRob3JpemVkOiBZb3UgY2FuIG9ubHkgdXBkYXRlIHlvdXIgb3duIGF2YWlsYWJpbGl0eScgXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDMgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNhdmUgdXNpbmcgdGhlIG5ldyBzZXJ2aWNlXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBBdmFpbGFiaWxpdHlTZXJ2aWNlLnNhdmVUaGVyYXBpc3RBdmFpbGFiaWxpdHkoXG4gICAgICAgIGJvZHkudGhlcmFwaXN0X2lkLCBcbiAgICAgICAgYXZhaWxhYmlsaXR5XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiByZXN1bHQubWVzc2FnZSBcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlLFxuICAgICAgICB0ZW1wbGF0ZUlkOiByZXN1bHQudGVtcGxhdGVJZFxuICAgICAgfSwgeyBzdGF0dXM6IDIwMCB9KTtcblxuICAgIH0gZWxzZSBpZiAoYm9keS50ZW1wbGF0ZXMpIHtcbiAgICAgIC8vIExlZ2FjeSBmb3JtYXQgc3VwcG9ydFxuICAgICAgY29uc3QgeyB0aGVyYXBpc3RfaWQsIHRlbXBsYXRlcyB9ID0gYm9keTtcblxuICAgICAgaWYgKCF0aGVyYXBpc3RfaWQgfHwgIXRlbXBsYXRlcyB8fCAhQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZXMpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnSW52YWxpZCByZXF1ZXN0IGRhdGEuIHRoZXJhcGlzdF9pZCBhbmQgdGVtcGxhdGVzIGFycmF5IGFyZSByZXF1aXJlZC4nIFxuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBWZXJpZnkgdGhlIHRoZXJhcGlzdCBpcyB1cGRhdGluZyB0aGVpciBvd24gdGVtcGxhdGVzXG4gICAgICBpZiAoc2Vzc2lvbi51c2VyLmlkICE9PSB0aGVyYXBpc3RfaWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgICAgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBjYW4gb25seSB1cGRhdGUgeW91ciBvd24gdGVtcGxhdGVzJyBcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgdGVtcGxhdGVzIGRhdGFcbiAgICAgIGZvciAoY29uc3QgdGVtcGxhdGUgb2YgdGVtcGxhdGVzKSB7XG4gICAgICAgIGlmICghdGVtcGxhdGUuZGF5X29mX3dlZWsgfHwgdGVtcGxhdGUuZGF5X29mX3dlZWsgPCAwIHx8IHRlbXBsYXRlLmRheV9vZl93ZWVrID4gNikge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGRheV9vZl93ZWVrLiBNdXN0IGJlIGJldHdlZW4gMCAoU3VuZGF5KSBhbmQgNiAoU2F0dXJkYXkpLicgXG4gICAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGVtcGxhdGUuc3RhcnRfdGltZSB8fCAhdGVtcGxhdGUuZW5kX3RpbWUpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICAgIGVycm9yOiAnc3RhcnRfdGltZSBhbmQgZW5kX3RpbWUgYXJlIHJlcXVpcmVkIGZvciBlYWNoIHRlbXBsYXRlLicgXG4gICAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIHRpbWUgZm9ybWF0IGFuZCBsb2dpY1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZShgMjAwMC0wMS0wMVQke3RlbXBsYXRlLnN0YXJ0X3RpbWV9YCk7XG4gICAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZShgMjAwMC0wMS0wMVQke3RlbXBsYXRlLmVuZF90aW1lfWApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlzTmFOKHN0YXJ0VGltZS5nZXRUaW1lKCkpIHx8IGlzTmFOKGVuZFRpbWUuZ2V0VGltZSgpKSkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHRpbWUgZm9ybWF0LiBVc2UgSEg6TU0gZm9ybWF0LicgXG4gICAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdGFydFRpbWUgPj0gZW5kVGltZSkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgICAgZXJyb3I6ICdTdGFydCB0aW1lIG11c3QgYmUgYmVmb3JlIGVuZCB0aW1lLicgXG4gICAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBEZWxldGUgZXhpc3RpbmcgdGVtcGxhdGVzIGZvciB0aGlzIHRoZXJhcGlzdFxuICAgICAgY29uc3QgeyBlcnJvcjogZGVsZXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhdmFpbGFiaWxpdHlfdGVtcGxhdGVzJylcbiAgICAgICAgLmRlbGV0ZSgpXG4gICAgICAgIC5lcSgndGhlcmFwaXN0X2lkJywgdGhlcmFwaXN0X2lkKTtcblxuICAgICAgaWYgKGRlbGV0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4aXN0aW5nIHRlbXBsYXRlczonLCBkZWxldGVFcnJvcik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSB0ZW1wbGF0ZXMnIFxuICAgICAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBQcmVwYXJlIG5ldyB0ZW1wbGF0ZXMgZGF0YVxuICAgICAgY29uc3QgdGVtcGxhdGVzRGF0YSA9IHRlbXBsYXRlcy5tYXAodGVtcGxhdGUgPT4gKHtcbiAgICAgICAgdGhlcmFwaXN0X2lkLFxuICAgICAgICBkYXlfb2Zfd2VlazogdGVtcGxhdGUuZGF5X29mX3dlZWssXG4gICAgICAgIHN0YXJ0X3RpbWU6IHRlbXBsYXRlLnN0YXJ0X3RpbWUsXG4gICAgICAgIGVuZF90aW1lOiB0ZW1wbGF0ZS5lbmRfdGltZSxcbiAgICAgICAgc2Vzc2lvbl9kdXJhdGlvbjogdGVtcGxhdGUuc2Vzc2lvbl9kdXJhdGlvbiB8fCA0NSxcbiAgICAgICAgc2Vzc2lvbl90eXBlOiB0ZW1wbGF0ZS5zZXNzaW9uX3R5cGUgfHwgJ2luZGl2aWR1YWwnLFxuICAgICAgICBtYXhfc2Vzc2lvbnM6IHRlbXBsYXRlLm1heF9zZXNzaW9ucyB8fCAxLFxuICAgICAgICBpc19hY3RpdmU6IHRydWVcbiAgICAgIH0pKTtcblxuICAgICAgLy8gSW5zZXJ0IG5ldyB0ZW1wbGF0ZXNcbiAgICAgIGNvbnN0IHsgZGF0YTogaW5zZXJ0ZWRUZW1wbGF0ZXMsIGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2F2YWlsYWJpbGl0eV90ZW1wbGF0ZXMnKVxuICAgICAgICAuaW5zZXJ0KHRlbXBsYXRlc0RhdGEpXG4gICAgICAgIC5zZWxlY3QoKTtcblxuICAgICAgaWYgKGluc2VydEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluc2VydGluZyB0ZW1wbGF0ZXM6JywgaW5zZXJ0RXJyb3IpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzYXZlIHRlbXBsYXRlcycgXG4gICAgICAgIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnQXZhaWxhYmlsaXR5IHRlbXBsYXRlcyB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIHRlbXBsYXRlczogaW5zZXJ0ZWRUZW1wbGF0ZXMsXG4gICAgICAgIGNvdW50OiBpbnNlcnRlZFRlbXBsYXRlcy5sZW5ndGhcbiAgICAgIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCByZXF1ZXN0IGZvcm1hdC4gUHJvdmlkZSBlaXRoZXIgYXZhaWxhYmlsaXR5IG9yIHRlbXBsYXRlcyBkYXRhLicgXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHRlbXBsYXRlIFBPU1QgQVBJOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyBcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbi8qKlxuICogVXBkYXRlIGEgc3BlY2lmaWMgdGVtcGxhdGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFNFQ1VSRSBBdXRoZW50aWNhdGlvbiBDaGVja1xuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlQXBpQXV0aChbJ3RoZXJhcGlzdCddKTtcbiAgICBpZiAoJ2Vycm9yJyBpbiBhdXRoUmVzdWx0KSB7XG4gICAgICByZXR1cm4gYXV0aFJlc3VsdC5lcnJvcjtcbiAgICB9XG5cbiAgICBjb25zdCB7IHNlc3Npb24gfSA9IGF1dGhSZXN1bHQ7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgdGVtcGxhdGVfaWQsIHVwZGF0ZXMgfSA9IGJvZHk7XG5cbiAgICBpZiAoIXRlbXBsYXRlX2lkIHx8ICF1cGRhdGVzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICd0ZW1wbGF0ZV9pZCBhbmQgdXBkYXRlcyBhcmUgcmVxdWlyZWQnIFxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgdGhlIHRoZXJhcGlzdCBvd25zIHRoaXMgdGVtcGxhdGVcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nVGVtcGxhdGUsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2F2YWlsYWJpbGl0eV90ZW1wbGF0ZXMnKVxuICAgICAgLnNlbGVjdCgndGhlcmFwaXN0X2lkJylcbiAgICAgIC5lcSgnaWQnLCB0ZW1wbGF0ZV9pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChmZXRjaEVycm9yIHx8ICFleGlzdGluZ1RlbXBsYXRlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICdUZW1wbGF0ZSBub3QgZm91bmQnIFxuICAgICAgfSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICB9XG5cbiAgICBpZiAoZXhpc3RpbmdUZW1wbGF0ZS50aGVyYXBpc3RfaWQgIT09IHNlc3Npb24udXNlci5pZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnVW5hdXRob3JpemVkOiBZb3UgY2FuIG9ubHkgdXBkYXRlIHlvdXIgb3duIHRlbXBsYXRlcycgXG4gICAgICB9LCB7IHN0YXR1czogNDAzIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgdGVtcGxhdGVcbiAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRUZW1wbGF0ZSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2F2YWlsYWJpbGl0eV90ZW1wbGF0ZXMnKVxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxuICAgICAgLmVxKCdpZCcsIHRlbXBsYXRlX2lkKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHRlbXBsYXRlOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byB1cGRhdGUgdGVtcGxhdGUnIFxuICAgICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnVGVtcGxhdGUgdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgdGVtcGxhdGU6IHVwZGF0ZWRUZW1wbGF0ZVxuICAgIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB0ZW1wbGF0ZSBQVVQgQVBJOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyBcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbi8qKlxuICogRGVsZXRlIGEgc3BlY2lmaWMgdGVtcGxhdGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIERFTEVURShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFNFQ1VSRSBBdXRoZW50aWNhdGlvbiBDaGVja1xuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCByZXF1aXJlQXBpQXV0aChbJ3RoZXJhcGlzdCddKTtcbiAgICBpZiAoJ2Vycm9yJyBpbiBhdXRoUmVzdWx0KSB7XG4gICAgICByZXR1cm4gYXV0aFJlc3VsdC5lcnJvcjtcbiAgICB9XG5cbiAgICBjb25zdCB7IHNlc3Npb24gfSA9IGF1dGhSZXN1bHQ7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IHRlbXBsYXRlSWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZW1wbGF0ZV9pZCcpO1xuXG4gICAgaWYgKCF0ZW1wbGF0ZUlkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICd0ZW1wbGF0ZV9pZCBpcyByZXF1aXJlZCcgXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSB0aGUgdGhlcmFwaXN0IG93bnMgdGhpcyB0ZW1wbGF0ZVxuICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdUZW1wbGF0ZSwgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYXZhaWxhYmlsaXR5X3RlbXBsYXRlcycpXG4gICAgICAuc2VsZWN0KCd0aGVyYXBpc3RfaWQnKVxuICAgICAgLmVxKCdpZCcsIHRlbXBsYXRlSWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhZXhpc3RpbmdUZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnVGVtcGxhdGUgbm90IGZvdW5kJyBcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgfVxuXG4gICAgaWYgKGV4aXN0aW5nVGVtcGxhdGUudGhlcmFwaXN0X2lkICE9PSBzZXNzaW9uLnVzZXIuaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZDogWW91IGNhbiBvbmx5IGRlbGV0ZSB5b3VyIG93biB0ZW1wbGF0ZXMnIFxuICAgICAgfSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgICB9XG5cbiAgICAvLyBEZWxldGUgdGhlIHRlbXBsYXRlXG4gICAgY29uc3QgeyBlcnJvcjogZGVsZXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYXZhaWxhYmlsaXR5X3RlbXBsYXRlcycpXG4gICAgICAuZGVsZXRlKClcbiAgICAgIC5lcSgnaWQnLCB0ZW1wbGF0ZUlkKTtcblxuICAgIGlmIChkZWxldGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgdGVtcGxhdGU6JywgZGVsZXRlRXJyb3IpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGRlbGV0ZSB0ZW1wbGF0ZScgXG4gICAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdUZW1wbGF0ZSBkZWxldGVkIHN1Y2Nlc3NmdWxseSdcbiAgICB9LCB7IHN0YXR1czogMjAwIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gdGVtcGxhdGUgREVMRVRFIEFQSTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJlcXVpcmVBcGlBdXRoIiwiQXZhaWxhYmlsaXR5U2VydmljZSIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJ0aGVyYXBpc3RJZCIsImdldCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImF2YWlsYWJpbGl0eSIsImdldFRoZXJhcGlzdEF2YWlsYWJpbGl0eSIsIm92ZXJyaWRlcyIsImdldEF2YWlsYWJpbGl0eU92ZXJyaWRlcyIsInN1Y2Nlc3MiLCJ0ZW1wbGF0ZXMiLCJjb25zb2xlIiwiUE9TVCIsImF1dGhSZXN1bHQiLCJzZXNzaW9uIiwiYm9keSIsInN0YW5kYXJkSG91cnMiLCJzZXNzaW9uU2V0dGluZ3MiLCJ1c2VyIiwiaWQiLCJ0aGVyYXBpc3RfaWQiLCJyZXN1bHQiLCJzYXZlVGhlcmFwaXN0QXZhaWxhYmlsaXR5IiwibWVzc2FnZSIsInRlbXBsYXRlSWQiLCJBcnJheSIsImlzQXJyYXkiLCJ0ZW1wbGF0ZSIsImRheV9vZl93ZWVrIiwic3RhcnRfdGltZSIsImVuZF90aW1lIiwic3RhcnRUaW1lIiwiRGF0ZSIsImVuZFRpbWUiLCJpc05hTiIsImdldFRpbWUiLCJkZWxldGVFcnJvciIsInN1cGFiYXNlIiwiZnJvbSIsImRlbGV0ZSIsImVxIiwidGVtcGxhdGVzRGF0YSIsIm1hcCIsInNlc3Npb25fZHVyYXRpb24iLCJzZXNzaW9uX3R5cGUiLCJtYXhfc2Vzc2lvbnMiLCJpc19hY3RpdmUiLCJkYXRhIiwiaW5zZXJ0ZWRUZW1wbGF0ZXMiLCJpbnNlcnRFcnJvciIsImluc2VydCIsInNlbGVjdCIsImNvdW50IiwibGVuZ3RoIiwiUFVUIiwidGVtcGxhdGVfaWQiLCJ1cGRhdGVzIiwiZXhpc3RpbmdUZW1wbGF0ZSIsImZldGNoRXJyb3IiLCJzaW5nbGUiLCJ1cGRhdGVkVGVtcGxhdGUiLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsIkRFTEVURSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/therapist/availability/template/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/availability-service.ts":
/*!*************************************!*\
  !*** ./lib/availability-service.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AvailabilityService: () => (/* binding */ AvailabilityService)\n/* harmony export */ });\n/* harmony import */ var _types_availability__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/availability */ \"(rsc)/./types/availability.ts\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./lib/supabase.ts\");\n/**\n * Availability Service\n * \n * This service handles data transformation, validation, and management\n * for the 3-level availability system. It provides backward compatibility\n * with existing database schemas while supporting the new enhanced interface.\n */ \n\nclass AvailabilityService {\n    /**\n   * Save therapist availability using the new WeeklyAvailability interface\n   */ static async saveTherapistAvailability(therapistId, availability) {\n        try {\n            // Validate availability data\n            const validation = this.validateWeeklyAvailability(availability);\n            if (!validation.isValid) {\n                return {\n                    success: false,\n                    message: `Validation failed: ${validation.errors.join(', ')}`\n                };\n            }\n            // Transform to legacy format for database storage\n            const legacyTemplates = this.transformToLegacyFormat(availability, therapistId);\n            const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n            // Delete existing templates for this therapist\n            await supabase.from('availability_templates').delete().eq('therapist_id', therapistId);\n            // Insert new templates\n            const { data: insertedTemplates, error: insertError } = await supabase.from('availability_templates').insert(legacyTemplates).select();\n            if (insertError) {\n                console.error('Error inserting templates:', insertError);\n                return {\n                    success: false,\n                    message: 'Failed to save availability templates'\n                };\n            }\n            // Store the new format in a separate table for future use\n            const { error: newFormatError } = await supabase.from('availability_weekly_schedules').upsert({\n                therapist_id: therapistId,\n                weekly_availability: availability,\n                template_name: 'primary',\n                is_active: true,\n                updated_at: new Date().toISOString()\n            });\n            if (newFormatError) {\n                console.warn('Failed to store new format, but legacy format saved:', newFormatError);\n            }\n            return {\n                success: true,\n                message: 'Availability saved successfully',\n                templateId: insertedTemplates?.[0]?.id\n            };\n        } catch (error) {\n            console.error('Error saving therapist availability:', error);\n            return {\n                success: false,\n                message: 'Internal server error'\n            };\n        }\n    }\n    /**\n   * Get therapist availability in the new format\n   */ static async getTherapistAvailability(therapistId) {\n        try {\n            const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n            // Try to get from new format first\n            const { data: newFormatData, error: newFormatError } = await supabase.from('availability_weekly_schedules').select('weekly_availability').eq('therapist_id', therapistId).eq('is_active', true).single();\n            if (!newFormatError && newFormatData?.weekly_availability) {\n                return newFormatData.weekly_availability;\n            }\n            // Fallback to legacy format\n            const { data: legacyTemplates, error: legacyError } = await supabase.from('availability_templates').select('*').eq('therapist_id', therapistId).eq('is_active', true).order('day_of_week', {\n                ascending: true\n            });\n            if (legacyError || !legacyTemplates) {\n                console.warn('No existing availability found, returning default');\n                return this.getDefaultAvailability();\n            }\n            // Transform legacy format to new format\n            return this.transformLegacyToNewFormat(legacyTemplates);\n        } catch (error) {\n            console.error('Error fetching therapist availability:', error);\n            return this.getDefaultAvailability();\n        }\n    }\n    /**\n   * Get availability overrides for a therapist\n   */ static async getAvailabilityOverrides(therapistId, startDate, endDate) {\n        try {\n            const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n            let query = supabase.from('availability_overrides').select('*').eq('therapist_id', therapistId);\n            if (startDate) {\n                query = query.gte('override_date', startDate);\n            }\n            if (endDate) {\n                query = query.lte('override_date', endDate);\n            }\n            const { data: overrides, error } = await query.order('override_date', {\n                ascending: true\n            });\n            if (error) {\n                console.error('Error fetching overrides:', error);\n                return [];\n            }\n            return (overrides || []).map((override)=>this.transformLegacyOverride(override));\n        } catch (error) {\n            console.error('Error fetching availability overrides:', error);\n            return [];\n        }\n    }\n    /**\n   * Save availability override\n   */ static async saveAvailabilityOverride(therapistId, override) {\n        try {\n            const legacyOverride = this.transformNewOverrideToLegacy(override, therapistId);\n            const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.createServerClient)();\n            const { data: insertedOverride, error } = await supabase.from('availability_overrides').upsert(legacyOverride).select().single();\n            if (error) {\n                console.error('Error saving override:', error);\n                return {\n                    success: false,\n                    message: 'Failed to save availability override'\n                };\n            }\n            return {\n                success: true,\n                message: 'Override saved successfully',\n                override: this.transformLegacyOverride(insertedOverride)\n            };\n        } catch (error) {\n            console.error('Error saving availability override:', error);\n            return {\n                success: false,\n                message: 'Internal server error'\n            };\n        }\n    }\n    /**\n   * Transform new WeeklyAvailability format to legacy database format\n   */ static transformToLegacyFormat(availability, therapistId) {\n        const days = [\n            'sunday',\n            'monday',\n            'tuesday',\n            'wednesday',\n            'thursday',\n            'friday',\n            'saturday'\n        ];\n        const templates = [];\n        days.forEach((day, index)=>{\n            const dayAvailability = availability.standardHours[day];\n            if (dayAvailability.enabled && dayAvailability.timeSlots.length > 0) {\n                dayAvailability.timeSlots.forEach((slot)=>{\n                    templates.push({\n                        therapist_id: therapistId,\n                        day_of_week: index,\n                        start_time: slot.start,\n                        end_time: slot.end,\n                        session_duration: slot.duration,\n                        session_type: slot.type,\n                        max_sessions: slot.maxSessions,\n                        is_active: true\n                    });\n                });\n            }\n        });\n        return templates;\n    }\n    /**\n   * Transform legacy database format to new WeeklyAvailability format\n   */ static transformLegacyToNewFormat(legacyTemplates) {\n        const availability = {\n            ..._types_availability__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_WEEKLY_AVAILABILITY\n        };\n        const days = [\n            'sunday',\n            'monday',\n            'tuesday',\n            'wednesday',\n            'thursday',\n            'friday',\n            'saturday'\n        ];\n        // Group templates by day\n        const templatesByDay = legacyTemplates.reduce((acc, template)=>{\n            const dayName = days[template.day_of_week];\n            if (!acc[dayName]) {\n                acc[dayName] = [];\n            }\n            acc[dayName].push(template);\n            return acc;\n        }, {});\n        // Transform each day\n        days.forEach((dayName)=>{\n            const dayTemplates = templatesByDay[dayName] || [];\n            const dayAvailability = {\n                enabled: dayTemplates.length > 0,\n                timeSlots: dayTemplates.map((template)=>({\n                        id: template.id || `slot-${Date.now()}-${Math.random()}`,\n                        start: template.start_time,\n                        end: template.end_time,\n                        duration: template.session_duration || 60,\n                        type: template.session_type || 'individual',\n                        maxSessions: template.max_sessions || 1,\n                        title: `${template.session_type || 'Individual'} Session`,\n                        isAvailable: template.is_active !== false\n                    })),\n                breaks: [],\n                notes: ''\n            };\n            availability.standardHours[dayName] = dayAvailability;\n        });\n        return availability;\n    }\n    /**\n   * Transform legacy override to new format\n   */ static transformLegacyOverride(legacyOverride) {\n        return {\n            id: legacyOverride.id,\n            therapistId: legacyOverride.therapist_id,\n            date: legacyOverride.override_date,\n            type: legacyOverride.is_available ? 'custom_hours' : 'unavailable',\n            isAvailable: legacyOverride.is_available,\n            customHours: legacyOverride.is_available ? {\n                start: legacyOverride.start_time,\n                end: legacyOverride.end_time,\n                timeSlots: [\n                    {\n                        id: `override-${legacyOverride.id}`,\n                        start: legacyOverride.start_time,\n                        end: legacyOverride.end_time,\n                        duration: legacyOverride.session_duration || 60,\n                        type: legacyOverride.session_type || 'individual',\n                        maxSessions: legacyOverride.max_sessions || 1,\n                        title: 'Override Session',\n                        isAvailable: true\n                    }\n                ]\n            } : undefined,\n            reason: legacyOverride.reason || '',\n            notes: legacyOverride.notes,\n            createdAt: legacyOverride.created_at,\n            updatedAt: legacyOverride.updated_at\n        };\n    }\n    /**\n   * Transform new override to legacy format\n   */ static transformNewOverrideToLegacy(override, therapistId) {\n        return {\n            therapist_id: therapistId,\n            override_date: override.date,\n            is_available: override.isAvailable,\n            start_time: override.customHours?.start,\n            end_time: override.customHours?.end,\n            session_duration: override.customHours?.timeSlots?.[0]?.duration || 60,\n            session_type: override.customHours?.timeSlots?.[0]?.type || 'individual',\n            max_sessions: override.customHours?.timeSlots?.[0]?.maxSessions || 1,\n            reason: override.reason,\n            notes: override.notes,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n        };\n    }\n    /**\n   * Validate WeeklyAvailability data\n   */ static validateWeeklyAvailability(availability) {\n        const errors = [];\n        const warnings = [];\n        // Check required fields\n        if (!availability.standardHours) {\n            errors.push('Standard hours are required');\n        }\n        if (!availability.sessionSettings) {\n            errors.push('Session settings are required');\n        }\n        // Validate each day\n        const days = Object.keys(availability.standardHours);\n        days.forEach((day)=>{\n            const dayAvailability = availability.standardHours[day];\n            if (dayAvailability.enabled && dayAvailability.timeSlots.length === 0) {\n                warnings.push(`${day} is enabled but has no time slots`);\n            }\n            // Validate time slots\n            dayAvailability.timeSlots.forEach((slot, index)=>{\n                if (!slot.start || !slot.end) {\n                    errors.push(`${day} slot ${index + 1} is missing start or end time`);\n                }\n                if (slot.duration <= 0) {\n                    errors.push(`${day} slot ${index + 1} has invalid duration`);\n                }\n                if (slot.maxSessions <= 0) {\n                    errors.push(`${day} slot ${index + 1} has invalid max sessions`);\n                }\n            });\n        });\n        // Validate session settings\n        if (availability.sessionSettings.sessionDuration <= 0) {\n            errors.push('Session duration must be greater than 0');\n        }\n        if (availability.sessionSettings.bufferTime < 0) {\n            errors.push('Buffer time cannot be negative');\n        }\n        if (availability.sessionSettings.maxSessionsPerDay <= 0) {\n            errors.push('Max sessions per day must be greater than 0');\n        }\n        return {\n            isValid: errors.length === 0,\n            errors,\n            warnings\n        };\n    }\n    /**\n   * Get default availability configuration\n   */ static getDefaultAvailability() {\n        return {\n            ..._types_availability__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_WEEKLY_AVAILABILITY\n        };\n    }\n    /**\n   * Calculate end time from start time and duration\n   */ static calculateEndTime(startTime, durationMinutes) {\n        const [hours, minutes] = startTime.split(':').map(Number);\n        const startDate = new Date();\n        startDate.setHours(hours, minutes, 0, 0);\n        const endDate = new Date(startDate.getTime() + durationMinutes * 60000);\n        return endDate.toTimeString().slice(0, 5);\n    }\n    /**\n   * Generate time slots for a day based on start/end times and session duration\n   */ static generateTimeSlots(startTime, endTime, sessionDuration, bufferTime = 0) {\n        const slots = [];\n        const [startHour, startMinute] = startTime.split(':').map(Number);\n        const [endHour, endMinute] = endTime.split(':').map(Number);\n        const startMinutes = startHour * 60 + startMinute;\n        const endMinutes = endHour * 60 + endMinute;\n        const totalDuration = sessionDuration + bufferTime;\n        let currentMinutes = startMinutes;\n        let slotIndex = 1;\n        while(currentMinutes + sessionDuration <= endMinutes){\n            const slotStart = this.formatMinutesToTime(currentMinutes);\n            const slotEnd = this.formatMinutesToTime(currentMinutes + sessionDuration);\n            slots.push({\n                ..._types_availability__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_TIME_SLOT,\n                id: `slot-${Date.now()}-${slotIndex}`,\n                start: slotStart,\n                end: slotEnd,\n                duration: sessionDuration,\n                title: `Session ${slotIndex}`\n            });\n            currentMinutes += totalDuration;\n            slotIndex++;\n        }\n        return slots;\n    }\n    /**\n   * Format minutes to HH:MM time string\n   */ static formatMinutesToTime(minutes) {\n        const hours = Math.floor(minutes / 60);\n        const mins = minutes % 60;\n        return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;\n    }\n    /**\n   * Check if two time slots overlap\n   */ static doTimeSlotsOverlap(slot1, slot2) {\n        const start1 = this.timeToMinutes(slot1.start);\n        const end1 = this.timeToMinutes(slot1.end);\n        const start2 = this.timeToMinutes(slot2.start);\n        const end2 = this.timeToMinutes(slot2.end);\n        return start1 < end2 && start2 < end1;\n    }\n    /**\n   * Convert time string to minutes\n   */ static timeToMinutes(time) {\n        const [hours, minutes] = time.split(':').map(Number);\n        return hours * 60 + minutes;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNGO1FBRUEsT0FBT1Q7SUFDVDtJQUVBOztHQUVDLEdBQ0QsT0FBZVcsb0JBQW9CcEIsT0FBZSxFQUFVO1FBQzFELE1BQU1ELFFBQVF6QixLQUFLZ0QsS0FBSyxDQUFDdEIsVUFBVTtRQUNuQyxNQUFNdUIsT0FBT3ZCLFVBQVU7UUFDdkIsT0FBTyxHQUFHRCxNQUFNeUIsUUFBUSxHQUFHQyxRQUFRLENBQUMsR0FBRyxLQUFLLENBQUMsRUFBRUYsS0FBS0MsUUFBUSxHQUFHQyxRQUFRLENBQUMsR0FBRyxNQUFNO0lBQ25GO0lBRUE7O0dBRUMsR0FDRCxPQUFPQyxtQkFBbUJDLEtBQWUsRUFBRUMsS0FBZSxFQUFXO1FBQ25FLE1BQU1DLFNBQVMsSUFBSSxDQUFDQyxhQUFhLENBQUNILE1BQU1yRSxLQUFLO1FBQzdDLE1BQU15RSxPQUFPLElBQUksQ0FBQ0QsYUFBYSxDQUFDSCxNQUFNbkUsR0FBRztRQUN6QyxNQUFNd0UsU0FBUyxJQUFJLENBQUNGLGFBQWEsQ0FBQ0YsTUFBTXRFLEtBQUs7UUFDN0MsTUFBTTJFLE9BQU8sSUFBSSxDQUFDSCxhQUFhLENBQUNGLE1BQU1wRSxHQUFHO1FBRXpDLE9BQU9xRSxTQUFTSSxRQUFRRCxTQUFTRDtJQUNuQztJQUVBOztHQUVDLEdBQ0QsT0FBZUQsY0FBY0ksSUFBWSxFQUFVO1FBQ2pELE1BQU0sQ0FBQ25DLE9BQU9DLFFBQVEsR0FBR2tDLEtBQUtqQyxLQUFLLENBQUMsS0FBS2hFLEdBQUcsQ0FBQ2lFO1FBQzdDLE9BQU9ILFFBQVEsS0FBS0M7SUFDdEI7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL21hY2Jvb2svRGVza3RvcC90cnBpLWFwcC9saWIvYXZhaWxhYmlsaXR5LXNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBdmFpbGFiaWxpdHkgU2VydmljZVxuICogXG4gKiBUaGlzIHNlcnZpY2UgaGFuZGxlcyBkYXRhIHRyYW5zZm9ybWF0aW9uLCB2YWxpZGF0aW9uLCBhbmQgbWFuYWdlbWVudFxuICogZm9yIHRoZSAzLWxldmVsIGF2YWlsYWJpbGl0eSBzeXN0ZW0uIEl0IHByb3ZpZGVzIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAqIHdpdGggZXhpc3RpbmcgZGF0YWJhc2Ugc2NoZW1hcyB3aGlsZSBzdXBwb3J0aW5nIHRoZSBuZXcgZW5oYW5jZWQgaW50ZXJmYWNlLlxuICovXG5cbmltcG9ydCB7IFxuICBXZWVrbHlBdmFpbGFiaWxpdHksIFxuICBBdmFpbGFiaWxpdHlPdmVycmlkZSwgXG4gIEF2YWlsYWJpbGl0eVRlbXBsYXRlLFxuICBUaW1lU2xvdCxcbiAgRGF5QXZhaWxhYmlsaXR5LFxuICBTZXNzaW9uU2V0dGluZ3MsXG4gIERFRkFVTFRfV0VFS0xZX0FWQUlMQUJJTElUWSxcbiAgREVGQVVMVF9EQVlfQVZBSUxBQklMSVRZLFxuICBERUZBVUxUX1RJTUVfU0xPVFxufSBmcm9tICdAL3R5cGVzL2F2YWlsYWJpbGl0eSc7XG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XG5cbmV4cG9ydCBjbGFzcyBBdmFpbGFiaWxpdHlTZXJ2aWNlIHtcbiAgLyoqXG4gICAqIFNhdmUgdGhlcmFwaXN0IGF2YWlsYWJpbGl0eSB1c2luZyB0aGUgbmV3IFdlZWtseUF2YWlsYWJpbGl0eSBpbnRlcmZhY2VcbiAgICovXG4gIHN0YXRpYyBhc3luYyBzYXZlVGhlcmFwaXN0QXZhaWxhYmlsaXR5KFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsIFxuICAgIGF2YWlsYWJpbGl0eTogV2Vla2x5QXZhaWxhYmlsaXR5XG4gICk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBtZXNzYWdlOiBzdHJpbmc7IHRlbXBsYXRlSWQ/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBWYWxpZGF0ZSBhdmFpbGFiaWxpdHkgZGF0YVxuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVXZWVrbHlBdmFpbGFiaWxpdHkoYXZhaWxhYmlsaXR5KTtcbiAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogYFZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJywgJyl9YFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBUcmFuc2Zvcm0gdG8gbGVnYWN5IGZvcm1hdCBmb3IgZGF0YWJhc2Ugc3RvcmFnZVxuICAgICAgY29uc3QgbGVnYWN5VGVtcGxhdGVzID0gdGhpcy50cmFuc2Zvcm1Ub0xlZ2FjeUZvcm1hdChhdmFpbGFiaWxpdHksIHRoZXJhcGlzdElkKTtcbiAgICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ2xpZW50KCk7XG5cbiAgICAgIC8vIERlbGV0ZSBleGlzdGluZyB0ZW1wbGF0ZXMgZm9yIHRoaXMgdGhlcmFwaXN0XG4gICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYXZhaWxhYmlsaXR5X3RlbXBsYXRlcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ3RoZXJhcGlzdF9pZCcsIHRoZXJhcGlzdElkKTtcblxuICAgICAgLy8gSW5zZXJ0IG5ldyB0ZW1wbGF0ZXNcbiAgICAgIGNvbnN0IHsgZGF0YTogaW5zZXJ0ZWRUZW1wbGF0ZXMsIGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2F2YWlsYWJpbGl0eV90ZW1wbGF0ZXMnKVxuICAgICAgICAuaW5zZXJ0KGxlZ2FjeVRlbXBsYXRlcylcbiAgICAgICAgLnNlbGVjdCgpO1xuXG4gICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIHRlbXBsYXRlczonLCBpbnNlcnRFcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBzYXZlIGF2YWlsYWJpbGl0eSB0ZW1wbGF0ZXMnXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFN0b3JlIHRoZSBuZXcgZm9ybWF0IGluIGEgc2VwYXJhdGUgdGFibGUgZm9yIGZ1dHVyZSB1c2VcbiAgICAgIGNvbnN0IHsgZXJyb3I6IG5ld0Zvcm1hdEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYXZhaWxhYmlsaXR5X3dlZWtseV9zY2hlZHVsZXMnKVxuICAgICAgICAudXBzZXJ0KHtcbiAgICAgICAgICB0aGVyYXBpc3RfaWQ6IHRoZXJhcGlzdElkLFxuICAgICAgICAgIHdlZWtseV9hdmFpbGFiaWxpdHk6IGF2YWlsYWJpbGl0eSxcbiAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiAncHJpbWFyeScsXG4gICAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9KTtcblxuICAgICAgaWYgKG5ld0Zvcm1hdEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHN0b3JlIG5ldyBmb3JtYXQsIGJ1dCBsZWdhY3kgZm9ybWF0IHNhdmVkOicsIG5ld0Zvcm1hdEVycm9yKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ0F2YWlsYWJpbGl0eSBzYXZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICB0ZW1wbGF0ZUlkOiBpbnNlcnRlZFRlbXBsYXRlcz8uWzBdPy5pZFxuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgdGhlcmFwaXN0IGF2YWlsYWJpbGl0eTonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ0ludGVybmFsIHNlcnZlciBlcnJvcidcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGVyYXBpc3QgYXZhaWxhYmlsaXR5IGluIHRoZSBuZXcgZm9ybWF0XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0VGhlcmFwaXN0QXZhaWxhYmlsaXR5KHRoZXJhcGlzdElkOiBzdHJpbmcpOiBQcm9taXNlPFdlZWtseUF2YWlsYWJpbGl0eT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVNlcnZlckNsaWVudCgpO1xuICAgICAgXG4gICAgICAvLyBUcnkgdG8gZ2V0IGZyb20gbmV3IGZvcm1hdCBmaXJzdFxuICAgICAgY29uc3QgeyBkYXRhOiBuZXdGb3JtYXREYXRhLCBlcnJvcjogbmV3Rm9ybWF0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhdmFpbGFiaWxpdHlfd2Vla2x5X3NjaGVkdWxlcycpXG4gICAgICAgIC5zZWxlY3QoJ3dlZWtseV9hdmFpbGFiaWxpdHknKVxuICAgICAgICAuZXEoJ3RoZXJhcGlzdF9pZCcsIHRoZXJhcGlzdElkKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKCFuZXdGb3JtYXRFcnJvciAmJiBuZXdGb3JtYXREYXRhPy53ZWVrbHlfYXZhaWxhYmlsaXR5KSB7XG4gICAgICAgIHJldHVybiBuZXdGb3JtYXREYXRhLndlZWtseV9hdmFpbGFiaWxpdHkgYXMgV2Vla2x5QXZhaWxhYmlsaXR5O1xuICAgICAgfVxuXG4gICAgICAvLyBGYWxsYmFjayB0byBsZWdhY3kgZm9ybWF0XG4gICAgICBjb25zdCB7IGRhdGE6IGxlZ2FjeVRlbXBsYXRlcywgZXJyb3I6IGxlZ2FjeUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYXZhaWxhYmlsaXR5X3RlbXBsYXRlcycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ3RoZXJhcGlzdF9pZCcsIHRoZXJhcGlzdElkKVxuICAgICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG4gICAgICAgIC5vcmRlcignZGF5X29mX3dlZWsnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgICAgaWYgKGxlZ2FjeUVycm9yIHx8ICFsZWdhY3lUZW1wbGF0ZXMpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdObyBleGlzdGluZyBhdmFpbGFiaWxpdHkgZm91bmQsIHJldHVybmluZyBkZWZhdWx0Jyk7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHRBdmFpbGFiaWxpdHkoKTtcbiAgICAgIH1cblxuICAgICAgLy8gVHJhbnNmb3JtIGxlZ2FjeSBmb3JtYXQgdG8gbmV3IGZvcm1hdFxuICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtTGVnYWN5VG9OZXdGb3JtYXQobGVnYWN5VGVtcGxhdGVzKTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0aGVyYXBpc3QgYXZhaWxhYmlsaXR5OicsIGVycm9yKTtcbiAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHRBdmFpbGFiaWxpdHkoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGF2YWlsYWJpbGl0eSBvdmVycmlkZXMgZm9yIGEgdGhlcmFwaXN0XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0QXZhaWxhYmlsaXR5T3ZlcnJpZGVzKFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsIFxuICAgIHN0YXJ0RGF0ZT86IHN0cmluZywgXG4gICAgZW5kRGF0ZT86IHN0cmluZ1xuICApOiBQcm9taXNlPEF2YWlsYWJpbGl0eU92ZXJyaWRlW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoKTtcbiAgICAgIFxuICAgICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2F2YWlsYWJpbGl0eV9vdmVycmlkZXMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCd0aGVyYXBpc3RfaWQnLCB0aGVyYXBpc3RJZCk7XG5cbiAgICAgIGlmIChzdGFydERhdGUpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ292ZXJyaWRlX2RhdGUnLCBzdGFydERhdGUpO1xuICAgICAgfVxuICAgICAgaWYgKGVuZERhdGUpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5sdGUoJ292ZXJyaWRlX2RhdGUnLCBlbmREYXRlKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBkYXRhOiBvdmVycmlkZXMsIGVycm9yIH0gPSBhd2FpdCBxdWVyeS5vcmRlcignb3ZlcnJpZGVfZGF0ZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3ZlcnJpZGVzOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gKG92ZXJyaWRlcyB8fCBbXSkubWFwKG92ZXJyaWRlID0+IHRoaXMudHJhbnNmb3JtTGVnYWN5T3ZlcnJpZGUob3ZlcnJpZGUpKTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhdmFpbGFiaWxpdHkgb3ZlcnJpZGVzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2F2ZSBhdmFpbGFiaWxpdHkgb3ZlcnJpZGVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBzYXZlQXZhaWxhYmlsaXR5T3ZlcnJpZGUoXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICBvdmVycmlkZTogT21pdDxBdmFpbGFiaWxpdHlPdmVycmlkZSwgJ2lkJyB8ICd0aGVyYXBpc3RJZCcgfCAnY3JlYXRlZEF0JyB8ICd1cGRhdGVkQXQnPlxuICApOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgbWVzc2FnZTogc3RyaW5nOyBvdmVycmlkZT86IEF2YWlsYWJpbGl0eU92ZXJyaWRlIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbGVnYWN5T3ZlcnJpZGUgPSB0aGlzLnRyYW5zZm9ybU5ld092ZXJyaWRlVG9MZWdhY3kob3ZlcnJpZGUsIHRoZXJhcGlzdElkKTtcbiAgICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ2xpZW50KCk7XG5cbiAgICAgIGNvbnN0IHsgZGF0YTogaW5zZXJ0ZWRPdmVycmlkZSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhdmFpbGFiaWxpdHlfb3ZlcnJpZGVzJylcbiAgICAgICAgLnVwc2VydChsZWdhY3lPdmVycmlkZSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBvdmVycmlkZTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBzYXZlIGF2YWlsYWJpbGl0eSBvdmVycmlkZSdcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ092ZXJyaWRlIHNhdmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIG92ZXJyaWRlOiB0aGlzLnRyYW5zZm9ybUxlZ2FjeU92ZXJyaWRlKGluc2VydGVkT3ZlcnJpZGUpXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBhdmFpbGFiaWxpdHkgb3ZlcnJpZGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2Zvcm0gbmV3IFdlZWtseUF2YWlsYWJpbGl0eSBmb3JtYXQgdG8gbGVnYWN5IGRhdGFiYXNlIGZvcm1hdFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgdHJhbnNmb3JtVG9MZWdhY3lGb3JtYXQoXG4gICAgYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHksIFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmdcbiAgKTogYW55W10ge1xuICAgIGNvbnN0IGRheXMgPSBbJ3N1bmRheScsICdtb25kYXknLCAndHVlc2RheScsICd3ZWRuZXNkYXknLCAndGh1cnNkYXknLCAnZnJpZGF5JywgJ3NhdHVyZGF5J107XG4gICAgY29uc3QgdGVtcGxhdGVzOiBhbnlbXSA9IFtdO1xuXG4gICAgZGF5cy5mb3JFYWNoKChkYXksIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBkYXlBdmFpbGFiaWxpdHkgPSBhdmFpbGFiaWxpdHkuc3RhbmRhcmRIb3Vyc1tkYXkgYXMga2V5b2YgdHlwZW9mIGF2YWlsYWJpbGl0eS5zdGFuZGFyZEhvdXJzXTtcbiAgICAgIFxuICAgICAgaWYgKGRheUF2YWlsYWJpbGl0eS5lbmFibGVkICYmIGRheUF2YWlsYWJpbGl0eS50aW1lU2xvdHMubGVuZ3RoID4gMCkge1xuICAgICAgICBkYXlBdmFpbGFiaWxpdHkudGltZVNsb3RzLmZvckVhY2goc2xvdCA9PiB7XG4gICAgICAgICAgdGVtcGxhdGVzLnB1c2goe1xuICAgICAgICAgICAgdGhlcmFwaXN0X2lkOiB0aGVyYXBpc3RJZCxcbiAgICAgICAgICAgIGRheV9vZl93ZWVrOiBpbmRleCxcbiAgICAgICAgICAgIHN0YXJ0X3RpbWU6IHNsb3Quc3RhcnQsXG4gICAgICAgICAgICBlbmRfdGltZTogc2xvdC5lbmQsXG4gICAgICAgICAgICBzZXNzaW9uX2R1cmF0aW9uOiBzbG90LmR1cmF0aW9uLFxuICAgICAgICAgICAgc2Vzc2lvbl90eXBlOiBzbG90LnR5cGUsXG4gICAgICAgICAgICBtYXhfc2Vzc2lvbnM6IHNsb3QubWF4U2Vzc2lvbnMsXG4gICAgICAgICAgICBpc19hY3RpdmU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGVtcGxhdGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFRyYW5zZm9ybSBsZWdhY3kgZGF0YWJhc2UgZm9ybWF0IHRvIG5ldyBXZWVrbHlBdmFpbGFiaWxpdHkgZm9ybWF0XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyB0cmFuc2Zvcm1MZWdhY3lUb05ld0Zvcm1hdChsZWdhY3lUZW1wbGF0ZXM6IGFueVtdKTogV2Vla2x5QXZhaWxhYmlsaXR5IHtcbiAgICBjb25zdCBhdmFpbGFiaWxpdHkgPSB7IC4uLkRFRkFVTFRfV0VFS0xZX0FWQUlMQUJJTElUWSB9O1xuICAgIGNvbnN0IGRheXMgPSBbJ3N1bmRheScsICdtb25kYXknLCAndHVlc2RheScsICd3ZWRuZXNkYXknLCAndGh1cnNkYXknLCAnZnJpZGF5JywgJ3NhdHVyZGF5J107XG5cbiAgICAvLyBHcm91cCB0ZW1wbGF0ZXMgYnkgZGF5XG4gICAgY29uc3QgdGVtcGxhdGVzQnlEYXkgPSBsZWdhY3lUZW1wbGF0ZXMucmVkdWNlKChhY2MsIHRlbXBsYXRlKSA9PiB7XG4gICAgICBjb25zdCBkYXlOYW1lID0gZGF5c1t0ZW1wbGF0ZS5kYXlfb2Zfd2Vla107XG4gICAgICBpZiAoIWFjY1tkYXlOYW1lXSkge1xuICAgICAgICBhY2NbZGF5TmFtZV0gPSBbXTtcbiAgICAgIH1cbiAgICAgIGFjY1tkYXlOYW1lXS5wdXNoKHRlbXBsYXRlKTtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgYW55W10+KTtcblxuICAgIC8vIFRyYW5zZm9ybSBlYWNoIGRheVxuICAgIGRheXMuZm9yRWFjaChkYXlOYW1lID0+IHtcbiAgICAgIGNvbnN0IGRheVRlbXBsYXRlcyA9IHRlbXBsYXRlc0J5RGF5W2RheU5hbWVdIHx8IFtdO1xuICAgICAgY29uc3QgZGF5QXZhaWxhYmlsaXR5OiBEYXlBdmFpbGFiaWxpdHkgPSB7XG4gICAgICAgIGVuYWJsZWQ6IGRheVRlbXBsYXRlcy5sZW5ndGggPiAwLFxuICAgICAgICB0aW1lU2xvdHM6IGRheVRlbXBsYXRlcy5tYXAoKHRlbXBsYXRlOiBhbnkpID0+ICh7XG4gICAgICAgICAgaWQ6IHRlbXBsYXRlLmlkIHx8IGBzbG90LSR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpfWAsXG4gICAgICAgICAgc3RhcnQ6IHRlbXBsYXRlLnN0YXJ0X3RpbWUsXG4gICAgICAgICAgZW5kOiB0ZW1wbGF0ZS5lbmRfdGltZSxcbiAgICAgICAgICBkdXJhdGlvbjogdGVtcGxhdGUuc2Vzc2lvbl9kdXJhdGlvbiB8fCA2MCxcbiAgICAgICAgICB0eXBlOiB0ZW1wbGF0ZS5zZXNzaW9uX3R5cGUgfHwgJ2luZGl2aWR1YWwnLFxuICAgICAgICAgIG1heFNlc3Npb25zOiB0ZW1wbGF0ZS5tYXhfc2Vzc2lvbnMgfHwgMSxcbiAgICAgICAgICB0aXRsZTogYCR7dGVtcGxhdGUuc2Vzc2lvbl90eXBlIHx8ICdJbmRpdmlkdWFsJ30gU2Vzc2lvbmAsXG4gICAgICAgICAgaXNBdmFpbGFibGU6IHRlbXBsYXRlLmlzX2FjdGl2ZSAhPT0gZmFsc2VcbiAgICAgICAgfSkpLFxuICAgICAgICBicmVha3M6IFtdLFxuICAgICAgICBub3RlczogJydcbiAgICAgIH07XG5cbiAgICAgIGF2YWlsYWJpbGl0eS5zdGFuZGFyZEhvdXJzW2RheU5hbWUgYXMga2V5b2YgdHlwZW9mIGF2YWlsYWJpbGl0eS5zdGFuZGFyZEhvdXJzXSA9IGRheUF2YWlsYWJpbGl0eTtcbiAgICB9KTtcblxuICAgIHJldHVybiBhdmFpbGFiaWxpdHk7XG4gIH1cblxuICAvKipcbiAgICogVHJhbnNmb3JtIGxlZ2FjeSBvdmVycmlkZSB0byBuZXcgZm9ybWF0XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyB0cmFuc2Zvcm1MZWdhY3lPdmVycmlkZShsZWdhY3lPdmVycmlkZTogYW55KTogQXZhaWxhYmlsaXR5T3ZlcnJpZGUge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogbGVnYWN5T3ZlcnJpZGUuaWQsXG4gICAgICB0aGVyYXBpc3RJZDogbGVnYWN5T3ZlcnJpZGUudGhlcmFwaXN0X2lkLFxuICAgICAgZGF0ZTogbGVnYWN5T3ZlcnJpZGUub3ZlcnJpZGVfZGF0ZSxcbiAgICAgIHR5cGU6IGxlZ2FjeU92ZXJyaWRlLmlzX2F2YWlsYWJsZSA/ICdjdXN0b21faG91cnMnIDogJ3VuYXZhaWxhYmxlJyxcbiAgICAgIGlzQXZhaWxhYmxlOiBsZWdhY3lPdmVycmlkZS5pc19hdmFpbGFibGUsXG4gICAgICBjdXN0b21Ib3VyczogbGVnYWN5T3ZlcnJpZGUuaXNfYXZhaWxhYmxlID8ge1xuICAgICAgICBzdGFydDogbGVnYWN5T3ZlcnJpZGUuc3RhcnRfdGltZSxcbiAgICAgICAgZW5kOiBsZWdhY3lPdmVycmlkZS5lbmRfdGltZSxcbiAgICAgICAgdGltZVNsb3RzOiBbe1xuICAgICAgICAgIGlkOiBgb3ZlcnJpZGUtJHtsZWdhY3lPdmVycmlkZS5pZH1gLFxuICAgICAgICAgIHN0YXJ0OiBsZWdhY3lPdmVycmlkZS5zdGFydF90aW1lLFxuICAgICAgICAgIGVuZDogbGVnYWN5T3ZlcnJpZGUuZW5kX3RpbWUsXG4gICAgICAgICAgZHVyYXRpb246IGxlZ2FjeU92ZXJyaWRlLnNlc3Npb25fZHVyYXRpb24gfHwgNjAsXG4gICAgICAgICAgdHlwZTogbGVnYWN5T3ZlcnJpZGUuc2Vzc2lvbl90eXBlIHx8ICdpbmRpdmlkdWFsJyxcbiAgICAgICAgICBtYXhTZXNzaW9uczogbGVnYWN5T3ZlcnJpZGUubWF4X3Nlc3Npb25zIHx8IDEsXG4gICAgICAgICAgdGl0bGU6ICdPdmVycmlkZSBTZXNzaW9uJyxcbiAgICAgICAgICBpc0F2YWlsYWJsZTogdHJ1ZVxuICAgICAgICB9XVxuICAgICAgfSA6IHVuZGVmaW5lZCxcbiAgICAgIHJlYXNvbjogbGVnYWN5T3ZlcnJpZGUucmVhc29uIHx8ICcnLFxuICAgICAgbm90ZXM6IGxlZ2FjeU92ZXJyaWRlLm5vdGVzLFxuICAgICAgY3JlYXRlZEF0OiBsZWdhY3lPdmVycmlkZS5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZEF0OiBsZWdhY3lPdmVycmlkZS51cGRhdGVkX2F0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2Zvcm0gbmV3IG92ZXJyaWRlIHRvIGxlZ2FjeSBmb3JtYXRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHRyYW5zZm9ybU5ld092ZXJyaWRlVG9MZWdhY3koXG4gICAgb3ZlcnJpZGU6IE9taXQ8QXZhaWxhYmlsaXR5T3ZlcnJpZGUsICdpZCcgfCAndGhlcmFwaXN0SWQnIHwgJ2NyZWF0ZWRBdCcgfCAndXBkYXRlZEF0Jz4sXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZ1xuICApOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICB0aGVyYXBpc3RfaWQ6IHRoZXJhcGlzdElkLFxuICAgICAgb3ZlcnJpZGVfZGF0ZTogb3ZlcnJpZGUuZGF0ZSxcbiAgICAgIGlzX2F2YWlsYWJsZTogb3ZlcnJpZGUuaXNBdmFpbGFibGUsXG4gICAgICBzdGFydF90aW1lOiBvdmVycmlkZS5jdXN0b21Ib3Vycz8uc3RhcnQsXG4gICAgICBlbmRfdGltZTogb3ZlcnJpZGUuY3VzdG9tSG91cnM/LmVuZCxcbiAgICAgIHNlc3Npb25fZHVyYXRpb246IG92ZXJyaWRlLmN1c3RvbUhvdXJzPy50aW1lU2xvdHM/LlswXT8uZHVyYXRpb24gfHwgNjAsXG4gICAgICBzZXNzaW9uX3R5cGU6IG92ZXJyaWRlLmN1c3RvbUhvdXJzPy50aW1lU2xvdHM/LlswXT8udHlwZSB8fCAnaW5kaXZpZHVhbCcsXG4gICAgICBtYXhfc2Vzc2lvbnM6IG92ZXJyaWRlLmN1c3RvbUhvdXJzPy50aW1lU2xvdHM/LlswXT8ubWF4U2Vzc2lvbnMgfHwgMSxcbiAgICAgIHJlYXNvbjogb3ZlcnJpZGUucmVhc29uLFxuICAgICAgbm90ZXM6IG92ZXJyaWRlLm5vdGVzLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBXZWVrbHlBdmFpbGFiaWxpdHkgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgdmFsaWRhdGVXZWVrbHlBdmFpbGFiaWxpdHkoYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHkpOiB7XG4gICAgaXNWYWxpZDogYm9vbGVhbjtcbiAgICBlcnJvcnM6IHN0cmluZ1tdO1xuICAgIHdhcm5pbmdzOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gQ2hlY2sgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFhdmFpbGFiaWxpdHkuc3RhbmRhcmRIb3Vycykge1xuICAgICAgZXJyb3JzLnB1c2goJ1N0YW5kYXJkIGhvdXJzIGFyZSByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGlmICghYXZhaWxhYmlsaXR5LnNlc3Npb25TZXR0aW5ncykge1xuICAgICAgZXJyb3JzLnB1c2goJ1Nlc3Npb24gc2V0dGluZ3MgYXJlIHJlcXVpcmVkJyk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgZWFjaCBkYXlcbiAgICBjb25zdCBkYXlzID0gT2JqZWN0LmtleXMoYXZhaWxhYmlsaXR5LnN0YW5kYXJkSG91cnMpO1xuICAgIGRheXMuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgY29uc3QgZGF5QXZhaWxhYmlsaXR5ID0gYXZhaWxhYmlsaXR5LnN0YW5kYXJkSG91cnNbZGF5IGFzIGtleW9mIHR5cGVvZiBhdmFpbGFiaWxpdHkuc3RhbmRhcmRIb3Vyc107XG4gICAgICBcbiAgICAgIGlmIChkYXlBdmFpbGFiaWxpdHkuZW5hYmxlZCAmJiBkYXlBdmFpbGFiaWxpdHkudGltZVNsb3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKGAke2RheX0gaXMgZW5hYmxlZCBidXQgaGFzIG5vIHRpbWUgc2xvdHNgKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgdGltZSBzbG90c1xuICAgICAgZGF5QXZhaWxhYmlsaXR5LnRpbWVTbG90cy5mb3JFYWNoKChzbG90OiBUaW1lU2xvdCwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICBpZiAoIXNsb3Quc3RhcnQgfHwgIXNsb3QuZW5kKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goYCR7ZGF5fSBzbG90ICR7aW5kZXggKyAxfSBpcyBtaXNzaW5nIHN0YXJ0IG9yIGVuZCB0aW1lYCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2xvdC5kdXJhdGlvbiA8PSAwKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goYCR7ZGF5fSBzbG90ICR7aW5kZXggKyAxfSBoYXMgaW52YWxpZCBkdXJhdGlvbmApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNsb3QubWF4U2Vzc2lvbnMgPD0gMCkge1xuICAgICAgICAgIGVycm9ycy5wdXNoKGAke2RheX0gc2xvdCAke2luZGV4ICsgMX0gaGFzIGludmFsaWQgbWF4IHNlc3Npb25zYCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gVmFsaWRhdGUgc2Vzc2lvbiBzZXR0aW5nc1xuICAgIGlmIChhdmFpbGFiaWxpdHkuc2Vzc2lvblNldHRpbmdzLnNlc3Npb25EdXJhdGlvbiA8PSAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnU2Vzc2lvbiBkdXJhdGlvbiBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7XG4gICAgfVxuXG4gICAgaWYgKGF2YWlsYWJpbGl0eS5zZXNzaW9uU2V0dGluZ3MuYnVmZmVyVGltZSA8IDApIHtcbiAgICAgIGVycm9ycy5wdXNoKCdCdWZmZXIgdGltZSBjYW5ub3QgYmUgbmVnYXRpdmUnKTtcbiAgICB9XG5cbiAgICBpZiAoYXZhaWxhYmlsaXR5LnNlc3Npb25TZXR0aW5ncy5tYXhTZXNzaW9uc1BlckRheSA8PSAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnTWF4IHNlc3Npb25zIHBlciBkYXkgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCcpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgd2FybmluZ3NcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWZhdWx0IGF2YWlsYWJpbGl0eSBjb25maWd1cmF0aW9uXG4gICAqL1xuICBzdGF0aWMgZ2V0RGVmYXVsdEF2YWlsYWJpbGl0eSgpOiBXZWVrbHlBdmFpbGFiaWxpdHkge1xuICAgIHJldHVybiB7IC4uLkRFRkFVTFRfV0VFS0xZX0FWQUlMQUJJTElUWSB9O1xuICB9XG5cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGVuZCB0aW1lIGZyb20gc3RhcnQgdGltZSBhbmQgZHVyYXRpb25cbiAgICovXG4gIHN0YXRpYyBjYWxjdWxhdGVFbmRUaW1lKHN0YXJ0VGltZTogc3RyaW5nLCBkdXJhdGlvbk1pbnV0ZXM6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgW2hvdXJzLCBtaW51dGVzXSA9IHN0YXJ0VGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpO1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgc3RhcnREYXRlLnNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCAwLCAwKTtcbiAgICBcbiAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlLmdldFRpbWUoKSArIGR1cmF0aW9uTWludXRlcyAqIDYwMDAwKTtcbiAgICBcbiAgICByZXR1cm4gZW5kRGF0ZS50b1RpbWVTdHJpbmcoKS5zbGljZSgwLCA1KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB0aW1lIHNsb3RzIGZvciBhIGRheSBiYXNlZCBvbiBzdGFydC9lbmQgdGltZXMgYW5kIHNlc3Npb24gZHVyYXRpb25cbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZVRpbWVTbG90cyhcbiAgICBzdGFydFRpbWU6IHN0cmluZyxcbiAgICBlbmRUaW1lOiBzdHJpbmcsXG4gICAgc2Vzc2lvbkR1cmF0aW9uOiBudW1iZXIsXG4gICAgYnVmZmVyVGltZTogbnVtYmVyID0gMFxuICApOiBUaW1lU2xvdFtdIHtcbiAgICBjb25zdCBzbG90czogVGltZVNsb3RbXSA9IFtdO1xuICAgIGNvbnN0IFtzdGFydEhvdXIsIHN0YXJ0TWludXRlXSA9IHN0YXJ0VGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpO1xuICAgIGNvbnN0IFtlbmRIb3VyLCBlbmRNaW51dGVdID0gZW5kVGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpO1xuICAgIFxuICAgIGNvbnN0IHN0YXJ0TWludXRlcyA9IHN0YXJ0SG91ciAqIDYwICsgc3RhcnRNaW51dGU7XG4gICAgY29uc3QgZW5kTWludXRlcyA9IGVuZEhvdXIgKiA2MCArIGVuZE1pbnV0ZTtcbiAgICBjb25zdCB0b3RhbER1cmF0aW9uID0gc2Vzc2lvbkR1cmF0aW9uICsgYnVmZmVyVGltZTtcbiAgICBcbiAgICBsZXQgY3VycmVudE1pbnV0ZXMgPSBzdGFydE1pbnV0ZXM7XG4gICAgbGV0IHNsb3RJbmRleCA9IDE7XG4gICAgXG4gICAgd2hpbGUgKGN1cnJlbnRNaW51dGVzICsgc2Vzc2lvbkR1cmF0aW9uIDw9IGVuZE1pbnV0ZXMpIHtcbiAgICAgIGNvbnN0IHNsb3RTdGFydCA9IHRoaXMuZm9ybWF0TWludXRlc1RvVGltZShjdXJyZW50TWludXRlcyk7XG4gICAgICBjb25zdCBzbG90RW5kID0gdGhpcy5mb3JtYXRNaW51dGVzVG9UaW1lKGN1cnJlbnRNaW51dGVzICsgc2Vzc2lvbkR1cmF0aW9uKTtcbiAgICAgIFxuICAgICAgc2xvdHMucHVzaCh7XG4gICAgICAgIC4uLkRFRkFVTFRfVElNRV9TTE9ULFxuICAgICAgICBpZDogYHNsb3QtJHtEYXRlLm5vdygpfS0ke3Nsb3RJbmRleH1gLFxuICAgICAgICBzdGFydDogc2xvdFN0YXJ0LFxuICAgICAgICBlbmQ6IHNsb3RFbmQsXG4gICAgICAgIGR1cmF0aW9uOiBzZXNzaW9uRHVyYXRpb24sXG4gICAgICAgIHRpdGxlOiBgU2Vzc2lvbiAke3Nsb3RJbmRleH1gXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY3VycmVudE1pbnV0ZXMgKz0gdG90YWxEdXJhdGlvbjtcbiAgICAgIHNsb3RJbmRleCsrO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc2xvdHM7XG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0IG1pbnV0ZXMgdG8gSEg6TU0gdGltZSBzdHJpbmdcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGZvcm1hdE1pbnV0ZXNUb1RpbWUobWludXRlczogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IobWludXRlcyAvIDYwKTtcbiAgICBjb25zdCBtaW5zID0gbWludXRlcyAlIDYwO1xuICAgIHJldHVybiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWlucy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0d28gdGltZSBzbG90cyBvdmVybGFwXG4gICAqL1xuICBzdGF0aWMgZG9UaW1lU2xvdHNPdmVybGFwKHNsb3QxOiBUaW1lU2xvdCwgc2xvdDI6IFRpbWVTbG90KTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc3RhcnQxID0gdGhpcy50aW1lVG9NaW51dGVzKHNsb3QxLnN0YXJ0KTtcbiAgICBjb25zdCBlbmQxID0gdGhpcy50aW1lVG9NaW51dGVzKHNsb3QxLmVuZCk7XG4gICAgY29uc3Qgc3RhcnQyID0gdGhpcy50aW1lVG9NaW51dGVzKHNsb3QyLnN0YXJ0KTtcbiAgICBjb25zdCBlbmQyID0gdGhpcy50aW1lVG9NaW51dGVzKHNsb3QyLmVuZCk7XG4gICAgXG4gICAgcmV0dXJuIHN0YXJ0MSA8IGVuZDIgJiYgc3RhcnQyIDwgZW5kMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHRpbWUgc3RyaW5nIHRvIG1pbnV0ZXNcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHRpbWVUb01pbnV0ZXModGltZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBbaG91cnMsIG1pbnV0ZXNdID0gdGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpO1xuICAgIHJldHVybiBob3VycyAqIDYwICsgbWludXRlcztcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkRFRkFVTFRfV0VFS0xZX0FWQUlMQUJJTElUWSIsIkRFRkFVTFRfVElNRV9TTE9UIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwiQXZhaWxhYmlsaXR5U2VydmljZSIsInNhdmVUaGVyYXBpc3RBdmFpbGFiaWxpdHkiLCJ0aGVyYXBpc3RJZCIsImF2YWlsYWJpbGl0eSIsInZhbGlkYXRpb24iLCJ2YWxpZGF0ZVdlZWtseUF2YWlsYWJpbGl0eSIsImlzVmFsaWQiLCJzdWNjZXNzIiwibWVzc2FnZSIsImVycm9ycyIsImpvaW4iLCJsZWdhY3lUZW1wbGF0ZXMiLCJ0cmFuc2Zvcm1Ub0xlZ2FjeUZvcm1hdCIsInN1cGFiYXNlIiwiZnJvbSIsImRlbGV0ZSIsImVxIiwiZGF0YSIsImluc2VydGVkVGVtcGxhdGVzIiwiZXJyb3IiLCJpbnNlcnRFcnJvciIsImluc2VydCIsInNlbGVjdCIsImNvbnNvbGUiLCJuZXdGb3JtYXRFcnJvciIsInVwc2VydCIsInRoZXJhcGlzdF9pZCIsIndlZWtseV9hdmFpbGFiaWxpdHkiLCJ0ZW1wbGF0ZV9uYW1lIiwiaXNfYWN0aXZlIiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIndhcm4iLCJ0ZW1wbGF0ZUlkIiwiaWQiLCJnZXRUaGVyYXBpc3RBdmFpbGFiaWxpdHkiLCJuZXdGb3JtYXREYXRhIiwic2luZ2xlIiwibGVnYWN5RXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsImdldERlZmF1bHRBdmFpbGFiaWxpdHkiLCJ0cmFuc2Zvcm1MZWdhY3lUb05ld0Zvcm1hdCIsImdldEF2YWlsYWJpbGl0eU92ZXJyaWRlcyIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJxdWVyeSIsImd0ZSIsImx0ZSIsIm92ZXJyaWRlcyIsIm1hcCIsIm92ZXJyaWRlIiwidHJhbnNmb3JtTGVnYWN5T3ZlcnJpZGUiLCJzYXZlQXZhaWxhYmlsaXR5T3ZlcnJpZGUiLCJsZWdhY3lPdmVycmlkZSIsInRyYW5zZm9ybU5ld092ZXJyaWRlVG9MZWdhY3kiLCJpbnNlcnRlZE92ZXJyaWRlIiwiZGF5cyIsInRlbXBsYXRlcyIsImZvckVhY2giLCJkYXkiLCJpbmRleCIsImRheUF2YWlsYWJpbGl0eSIsInN0YW5kYXJkSG91cnMiLCJlbmFibGVkIiwidGltZVNsb3RzIiwibGVuZ3RoIiwic2xvdCIsInB1c2giLCJkYXlfb2Zfd2VlayIsInN0YXJ0X3RpbWUiLCJzdGFydCIsImVuZF90aW1lIiwiZW5kIiwic2Vzc2lvbl9kdXJhdGlvbiIsImR1cmF0aW9uIiwic2Vzc2lvbl90eXBlIiwidHlwZSIsIm1heF9zZXNzaW9ucyIsIm1heFNlc3Npb25zIiwidGVtcGxhdGVzQnlEYXkiLCJyZWR1Y2UiLCJhY2MiLCJ0ZW1wbGF0ZSIsImRheU5hbWUiLCJkYXlUZW1wbGF0ZXMiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidGl0bGUiLCJpc0F2YWlsYWJsZSIsImJyZWFrcyIsIm5vdGVzIiwiZGF0ZSIsIm92ZXJyaWRlX2RhdGUiLCJpc19hdmFpbGFibGUiLCJjdXN0b21Ib3VycyIsInVuZGVmaW5lZCIsInJlYXNvbiIsImNyZWF0ZWRBdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkQXQiLCJ3YXJuaW5ncyIsInNlc3Npb25TZXR0aW5ncyIsIk9iamVjdCIsImtleXMiLCJzZXNzaW9uRHVyYXRpb24iLCJidWZmZXJUaW1lIiwibWF4U2Vzc2lvbnNQZXJEYXkiLCJjYWxjdWxhdGVFbmRUaW1lIiwic3RhcnRUaW1lIiwiZHVyYXRpb25NaW51dGVzIiwiaG91cnMiLCJtaW51dGVzIiwic3BsaXQiLCJOdW1iZXIiLCJzZXRIb3VycyIsImdldFRpbWUiLCJ0b1RpbWVTdHJpbmciLCJzbGljZSIsImdlbmVyYXRlVGltZVNsb3RzIiwiZW5kVGltZSIsInNsb3RzIiwic3RhcnRIb3VyIiwic3RhcnRNaW51dGUiLCJlbmRIb3VyIiwiZW5kTWludXRlIiwic3RhcnRNaW51dGVzIiwiZW5kTWludXRlcyIsInRvdGFsRHVyYXRpb24iLCJjdXJyZW50TWludXRlcyIsInNsb3RJbmRleCIsInNsb3RTdGFydCIsImZvcm1hdE1pbnV0ZXNUb1RpbWUiLCJzbG90RW5kIiwiZmxvb3IiLCJtaW5zIiwidG9TdHJpbmciLCJwYWRTdGFydCIsImRvVGltZVNsb3RzT3ZlcmxhcCIsInNsb3QxIiwic2xvdDIiLCJzdGFydDEiLCJ0aW1lVG9NaW51dGVzIiwiZW5kMSIsInN0YXJ0MiIsImVuZDIiLCJ0aW1lIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/availability-service.ts\n");

/***/ }),

/***/ "(rsc)/./lib/server-auth.ts":
/*!****************************!*\
  !*** ./lib/server-auth.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getServerSession: () => (/* binding */ getServerSession),\n/* harmony export */   requireApiAuth: () => (/* binding */ requireApiAuth),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/navigation */ \"(rsc)/./node_modules/next/dist/api/navigation.react-server.js\");\n/* harmony import */ var _session_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./session-manager */ \"(rsc)/./lib/session-manager.ts\");\n\n\n\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__.createClient)(\"https://frzciymslvpohhyefmtr.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n// Short-lived session cache to reduce database load\nconst sessionCache = new Map();\nconst CACHE_TTL_MS = 10000 // 10 seconds - balance between performance and security\n;\n/**\n * Securely verify server-side session from HTTP-only cookie\n * This replaces the insecure cookie parsing in API routes\n */ async function getServerSession() {\n    try {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        // Try different cookie names based on user type\n        // Priority: unified session > specific user types\n        const cookieNames = [\n            'quiet_session',\n            'quiet_therapist_user',\n            'quiet_partner_user',\n            'quiet_admin_user',\n            'quiet_individual_user',\n            'quiet_user' // Legacy cookie name\n        ];\n        let userCookie = null;\n        let cookieData = null;\n        for (const cookieName of cookieNames){\n            userCookie = cookieStore.get(cookieName);\n            console.log('🔍 DEBUG: Checking cookie:', cookieName, userCookie ? 'FOUND' : 'NOT FOUND');\n            if (userCookie) {\n                try {\n                    // Handle unified session cookie (JWT token) differently\n                    if (cookieName === 'quiet_session') {\n                        // This is a JWT token, not JSON data\n                        const { jwtVerify } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/jose\").then(__webpack_require__.bind(__webpack_require__, /*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/index.js\"));\n                        const JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || 'your-secret-key');\n                        const { payload } = await jwtVerify(userCookie.value, JWT_SECRET);\n                        // Convert JWT payload to expected format\n                        cookieData = {\n                            session_token: userCookie.value,\n                            id: payload.id,\n                            email: payload.email,\n                            full_name: payload.name,\n                            user_type: payload.user_type || payload.role,\n                            is_verified: payload.is_verified,\n                            is_active: payload.is_active\n                        };\n                        console.log('🔍 DEBUG: Parsed JWT session data:', {\n                            cookieName,\n                            cookieData\n                        });\n                        break;\n                    } else {\n                        // Handle legacy JSON cookies\n                        cookieData = JSON.parse(decodeURIComponent(userCookie.value));\n                        console.log('🔍 DEBUG: Parsed cookie data:', {\n                            cookieName,\n                            cookieData\n                        });\n                        break;\n                    }\n                } catch (error) {\n                    console.log('🔍 DEBUG: Failed to parse cookie:', cookieName, error);\n                    continue;\n                }\n            }\n        }\n        if (!cookieData) {\n            return null;\n        }\n        // If this is a unified session (JWT), we can trust it directly\n        if (cookieData.id && cookieData.email) {\n            console.log('✅ Using unified session data directly');\n            const session = {\n                user: {\n                    id: cookieData.id,\n                    email: cookieData.email,\n                    full_name: cookieData.full_name,\n                    user_type: cookieData.user_type,\n                    is_verified: cookieData.is_verified,\n                    is_active: cookieData.is_active\n                },\n                session_token: cookieData.session_token || 'unified-session',\n                expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours from now\n            };\n            return session;\n        }\n        // Fallback to database verification for legacy sessions\n        if (!cookieData.session_token) {\n            return null;\n        }\n        const sessionToken = cookieData.session_token;\n        // Check cache first for performance\n        const cached = sessionCache.get(sessionToken);\n        if (cached && cached.expiry > Date.now()) {\n            console.log('✅ Session loaded from cache');\n            return cached.session;\n        }\n        // Verify the session token against the database\n        console.log('🔍 DEBUG: Looking for session token:', sessionToken);\n        const { data: sessionData, error: sessionError } = await supabase.from('user_sessions').select(`\n        user_id,\n        session_token,\n        expires_at,\n        users (\n          id,\n          email,\n          full_name,\n          user_type,\n          is_verified,\n          is_active\n        )\n      `).eq('session_token', sessionToken).single();\n        console.log('🔍 DEBUG: Session query result:', {\n            sessionData,\n            sessionError\n        });\n        if (sessionError || !sessionData) {\n            console.log('❌ Invalid session token:', sessionError);\n            // Remove from cache if it was invalid\n            sessionCache.delete(sessionToken);\n            return null;\n        }\n        // Check if session is expired\n        const expiresAt = new Date(sessionData.expires_at);\n        if (expiresAt < new Date()) {\n            console.log('❌ Session expired');\n            // Clean up expired session and cache\n            sessionCache.delete(sessionToken);\n            await supabase.from('user_sessions').delete().eq('session_token', sessionToken);\n            return null;\n        }\n        // Create session object\n        const session = {\n            user: {\n                id: sessionData.users.id,\n                email: sessionData.users.email,\n                full_name: sessionData.users.full_name,\n                user_type: sessionData.users.user_type,\n                is_verified: sessionData.users.is_verified,\n                is_active: sessionData.users.is_active\n            },\n            session_token: sessionData.session_token,\n            expires_at: expiresAt\n        };\n        // Cache the validated session\n        sessionCache.set(sessionToken, {\n            session,\n            expiry: Date.now() + CACHE_TTL_MS\n        });\n        // Update last accessed time (async, don't wait)\n        supabase.from('user_sessions').update({\n            last_accessed_at: new Date().toISOString()\n        }).eq('session_token', sessionToken).then((result)=>{\n            if (result.error) {\n                console.warn('⚠️ Failed to update session access time:', result.error);\n            } else {\n                console.log('✅ Session access time updated');\n            }\n        });\n        return session;\n    } catch (error) {\n        console.error('❌ Error verifying server session:', error);\n        return null;\n    }\n}\n/**\n * Require authentication and optionally specific user type\n * Throws redirect if not authenticated or wrong user type\n */ async function requireAuth(allowedUserTypes) {\n    const session = await getServerSession();\n    if (!session) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)('/login');\n    }\n    if (!session.user.is_active) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)('/account-disabled');\n    }\n    if (allowedUserTypes && !allowedUserTypes.includes(session.user.user_type)) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)('/unauthorized');\n    }\n    return session;\n}\n/**\n * Require specific user type for API routes\n * Returns error response if not authorized\n */ async function requireApiAuth(allowedUserTypes) {\n    // Try unified session first\n    const unifiedSession = await _session_manager__WEBPACK_IMPORTED_MODULE_2__.SessionManager.getSession();\n    if (unifiedSession) {\n        // Convert unified session to ServerSession format\n        const session = {\n            user: {\n                id: unifiedSession.id,\n                email: unifiedSession.email,\n                full_name: unifiedSession.name,\n                user_type: unifiedSession.user_type,\n                is_verified: unifiedSession.is_verified,\n                is_active: unifiedSession.is_active\n            },\n            session_token: unifiedSession.session_token || '',\n            expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours from now\n        };\n        if (!session.user.is_active) {\n            return {\n                error: new Response(JSON.stringify({\n                    error: 'Account disabled'\n                }), {\n                    status: 403,\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n            };\n        }\n        if (allowedUserTypes && !allowedUserTypes.includes(session.user.user_type)) {\n            return {\n                error: new Response(JSON.stringify({\n                    error: 'Insufficient permissions'\n                }), {\n                    status: 403,\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n            };\n        }\n        return {\n            session\n        };\n    }\n    // Fallback to old session system\n    const session = await getServerSession();\n    if (!session) {\n        return {\n            error: new Response(JSON.stringify({\n                error: 'Authentication required'\n            }), {\n                status: 401,\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n            })\n        };\n    }\n    if (!session.user.is_active) {\n        return {\n            error: new Response(JSON.stringify({\n                error: 'Account disabled'\n            }), {\n                status: 403,\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n            })\n        };\n    }\n    if (allowedUserTypes && !allowedUserTypes.includes(session.user.user_type)) {\n        return {\n            error: new Response(JSON.stringify({\n                error: 'Insufficient permissions'\n            }), {\n                status: 403,\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n            })\n        };\n    }\n    return {\n        session\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQ1osT0FBTztZQUNMRCxPQUFPLElBQUlnQyxTQUNUbkMsS0FBS29DLFNBQVMsQ0FBQztnQkFBRWpDLE9BQU87WUFBMEIsSUFDbEQ7Z0JBQUVrQyxRQUFRO2dCQUFLQyxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFBRTtRQUVuRTtJQUNGO0lBRUEsSUFBSSxDQUFDbEMsUUFBUUMsSUFBSSxDQUFDTixTQUFTLEVBQUU7UUFDM0IsT0FBTztZQUNMSSxPQUFPLElBQUlnQyxTQUNUbkMsS0FBS29DLFNBQVMsQ0FBQztnQkFBRWpDLE9BQU87WUFBbUIsSUFDM0M7Z0JBQUVrQyxRQUFRO2dCQUFLQyxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFBRTtRQUVuRTtJQUNGO0lBRUEsSUFBSVIsb0JBQW9CLENBQUNBLGlCQUFpQkMsUUFBUSxDQUFDM0IsUUFBUUMsSUFBSSxDQUFDVCxTQUFTLEdBQUc7UUFDMUUsT0FBTztZQUNMTyxPQUFPLElBQUlnQyxTQUNUbkMsS0FBS29DLFNBQVMsQ0FBQztnQkFBRWpDLE9BQU87WUFBMkIsSUFDbkQ7Z0JBQUVrQyxRQUFRO2dCQUFLQyxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFBRTtRQUVuRTtJQUNGO0lBRUEsT0FBTztRQUFFbEM7SUFBUTtBQUNuQiIsInNvdXJjZXMiOlsiL1VzZXJzL21hY2Jvb2svRGVza3RvcC90cnBpLWFwcC9saWIvc2VydmVyLWF1dGgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCB7IHJlZGlyZWN0IH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJ1xuaW1wb3J0IHsgU2Vzc2lvbk1hbmFnZXIgfSBmcm9tICcuL3Nlc3Npb24tbWFuYWdlcidcblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhXG4pXG5cbi8vIFNob3J0LWxpdmVkIHNlc3Npb24gY2FjaGUgdG8gcmVkdWNlIGRhdGFiYXNlIGxvYWRcbmNvbnN0IHNlc3Npb25DYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCB7IHNlc3Npb246IFNlcnZlclNlc3Npb247IGV4cGlyeTogbnVtYmVyIH0+KClcbmNvbnN0IENBQ0hFX1RUTF9NUyA9IDEwXzAwMCAvLyAxMCBzZWNvbmRzIC0gYmFsYW5jZSBiZXR3ZWVuIHBlcmZvcm1hbmNlIGFuZCBzZWN1cml0eVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcnZlclNlc3Npb24ge1xuICB1c2VyOiB7XG4gICAgaWQ6IHN0cmluZ1xuICAgIGVtYWlsOiBzdHJpbmdcbiAgICBmdWxsX25hbWU6IHN0cmluZ1xuICAgIHVzZXJfdHlwZTogJ2luZGl2aWR1YWwnIHwgJ3RoZXJhcGlzdCcgfCAncGFydG5lcicgfCAnYWRtaW4nXG4gICAgaXNfdmVyaWZpZWQ6IGJvb2xlYW5cbiAgICBpc19hY3RpdmU6IGJvb2xlYW5cbiAgfVxuICBzZXNzaW9uX3Rva2VuOiBzdHJpbmdcbiAgZXhwaXJlc19hdDogRGF0ZVxufVxuXG4vKipcbiAqIFNlY3VyZWx5IHZlcmlmeSBzZXJ2ZXItc2lkZSBzZXNzaW9uIGZyb20gSFRUUC1vbmx5IGNvb2tpZVxuICogVGhpcyByZXBsYWNlcyB0aGUgaW5zZWN1cmUgY29va2llIHBhcnNpbmcgaW4gQVBJIHJvdXRlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VydmVyU2Vzc2lvbigpOiBQcm9taXNlPFNlcnZlclNlc3Npb24gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgICBcbiAgICAvLyBUcnkgZGlmZmVyZW50IGNvb2tpZSBuYW1lcyBiYXNlZCBvbiB1c2VyIHR5cGVcbiAgICAvLyBQcmlvcml0eTogdW5pZmllZCBzZXNzaW9uID4gc3BlY2lmaWMgdXNlciB0eXBlc1xuICAgIGNvbnN0IGNvb2tpZU5hbWVzID0gW1xuICAgICAgJ3F1aWV0X3Nlc3Npb24nLCAvLyBVbmlmaWVkIHNlc3Npb24gY29va2llIChoaWdoZXN0IHByaW9yaXR5KVxuICAgICAgJ3F1aWV0X3RoZXJhcGlzdF91c2VyJyxcbiAgICAgICdxdWlldF9wYXJ0bmVyX3VzZXInLCBcbiAgICAgICdxdWlldF9hZG1pbl91c2VyJyxcbiAgICAgICdxdWlldF9pbmRpdmlkdWFsX3VzZXInLFxuICAgICAgJ3F1aWV0X3VzZXInIC8vIExlZ2FjeSBjb29raWUgbmFtZVxuICAgIF1cbiAgICBcbiAgICBsZXQgdXNlckNvb2tpZSA9IG51bGxcbiAgICBsZXQgY29va2llRGF0YSA9IG51bGxcbiAgICBcbiAgICBmb3IgKGNvbnN0IGNvb2tpZU5hbWUgb2YgY29va2llTmFtZXMpIHtcbiAgICAgIHVzZXJDb29raWUgPSBjb29raWVTdG9yZS5nZXQoY29va2llTmFtZSlcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIERFQlVHOiBDaGVja2luZyBjb29raWU6JywgY29va2llTmFtZSwgdXNlckNvb2tpZSA/ICdGT1VORCcgOiAnTk9UIEZPVU5EJylcbiAgICAgIGlmICh1c2VyQ29va2llKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gSGFuZGxlIHVuaWZpZWQgc2Vzc2lvbiBjb29raWUgKEpXVCB0b2tlbikgZGlmZmVyZW50bHlcbiAgICAgICAgICBpZiAoY29va2llTmFtZSA9PT0gJ3F1aWV0X3Nlc3Npb24nKSB7XG4gICAgICAgICAgICAvLyBUaGlzIGlzIGEgSldUIHRva2VuLCBub3QgSlNPTiBkYXRhXG4gICAgICAgICAgICBjb25zdCB7IGp3dFZlcmlmeSB9ID0gYXdhaXQgaW1wb3J0KCdqb3NlJylcbiAgICAgICAgICAgIGNvbnN0IEpXVF9TRUNSRVQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUocHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zZWNyZXQta2V5JylcbiAgICAgICAgICAgIGNvbnN0IHsgcGF5bG9hZCB9ID0gYXdhaXQgand0VmVyaWZ5KHVzZXJDb29raWUudmFsdWUsIEpXVF9TRUNSRVQpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnZlcnQgSldUIHBheWxvYWQgdG8gZXhwZWN0ZWQgZm9ybWF0XG4gICAgICAgICAgICBjb29raWVEYXRhID0ge1xuICAgICAgICAgICAgICBzZXNzaW9uX3Rva2VuOiB1c2VyQ29va2llLnZhbHVlLFxuICAgICAgICAgICAgICBpZDogcGF5bG9hZC5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHBheWxvYWQuZW1haWwsXG4gICAgICAgICAgICAgIGZ1bGxfbmFtZTogcGF5bG9hZC5uYW1lLFxuICAgICAgICAgICAgICB1c2VyX3R5cGU6IHBheWxvYWQudXNlcl90eXBlIHx8IHBheWxvYWQucm9sZSxcbiAgICAgICAgICAgICAgaXNfdmVyaWZpZWQ6IHBheWxvYWQuaXNfdmVyaWZpZWQsXG4gICAgICAgICAgICAgIGlzX2FjdGl2ZTogcGF5bG9hZC5pc19hY3RpdmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIERFQlVHOiBQYXJzZWQgSldUIHNlc3Npb24gZGF0YTonLCB7IGNvb2tpZU5hbWUsIGNvb2tpZURhdGEgfSlcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBsZWdhY3kgSlNPTiBjb29raWVzXG4gICAgICAgICAgICBjb29raWVEYXRhID0gSlNPTi5wYXJzZShkZWNvZGVVUklDb21wb25lbnQodXNlckNvb2tpZS52YWx1ZSkpXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBERUJVRzogUGFyc2VkIGNvb2tpZSBkYXRhOicsIHsgY29va2llTmFtZSwgY29va2llRGF0YSB9KVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CflI0gREVCVUc6IEZhaWxlZCB0byBwYXJzZSBjb29raWU6JywgY29va2llTmFtZSwgZXJyb3IpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoIWNvb2tpZURhdGEpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gSWYgdGhpcyBpcyBhIHVuaWZpZWQgc2Vzc2lvbiAoSldUKSwgd2UgY2FuIHRydXN0IGl0IGRpcmVjdGx5XG4gICAgaWYgKGNvb2tpZURhdGEuaWQgJiYgY29va2llRGF0YS5lbWFpbCkge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBVc2luZyB1bmlmaWVkIHNlc3Npb24gZGF0YSBkaXJlY3RseScpXG4gICAgICBjb25zdCBzZXNzaW9uOiBTZXJ2ZXJTZXNzaW9uID0ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGNvb2tpZURhdGEuaWQsXG4gICAgICAgICAgZW1haWw6IGNvb2tpZURhdGEuZW1haWwsXG4gICAgICAgICAgZnVsbF9uYW1lOiBjb29raWVEYXRhLmZ1bGxfbmFtZSxcbiAgICAgICAgICB1c2VyX3R5cGU6IGNvb2tpZURhdGEudXNlcl90eXBlLFxuICAgICAgICAgIGlzX3ZlcmlmaWVkOiBjb29raWVEYXRhLmlzX3ZlcmlmaWVkLFxuICAgICAgICAgIGlzX2FjdGl2ZTogY29va2llRGF0YS5pc19hY3RpdmVcbiAgICAgICAgfSxcbiAgICAgICAgc2Vzc2lvbl90b2tlbjogY29va2llRGF0YS5zZXNzaW9uX3Rva2VuIHx8ICd1bmlmaWVkLXNlc3Npb24nLFxuICAgICAgICBleHBpcmVzX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gMjQgaG91cnMgZnJvbSBub3dcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZXNzaW9uXG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2sgdG8gZGF0YWJhc2UgdmVyaWZpY2F0aW9uIGZvciBsZWdhY3kgc2Vzc2lvbnNcbiAgICBpZiAoIWNvb2tpZURhdGEuc2Vzc2lvbl90b2tlbikge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBjb29raWVEYXRhLnNlc3Npb25fdG9rZW5cblxuICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0IGZvciBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IGNhY2hlZCA9IHNlc3Npb25DYWNoZS5nZXQoc2Vzc2lvblRva2VuKVxuICAgIGlmIChjYWNoZWQgJiYgY2FjaGVkLmV4cGlyeSA+IERhdGUubm93KCkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiBsb2FkZWQgZnJvbSBjYWNoZScpXG4gICAgICByZXR1cm4gY2FjaGVkLnNlc3Npb25cbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgdGhlIHNlc3Npb24gdG9rZW4gYWdhaW5zdCB0aGUgZGF0YWJhc2VcbiAgICBjb25zb2xlLmxvZygn8J+UjSBERUJVRzogTG9va2luZyBmb3Igc2Vzc2lvbiB0b2tlbjonLCBzZXNzaW9uVG9rZW4pXG4gICAgY29uc3QgeyBkYXRhOiBzZXNzaW9uRGF0YSwgZXJyb3I6IHNlc3Npb25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX3Nlc3Npb25zJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICB1c2VyX2lkLFxuICAgICAgICBzZXNzaW9uX3Rva2VuLFxuICAgICAgICBleHBpcmVzX2F0LFxuICAgICAgICB1c2VycyAoXG4gICAgICAgICAgaWQsXG4gICAgICAgICAgZW1haWwsXG4gICAgICAgICAgZnVsbF9uYW1lLFxuICAgICAgICAgIHVzZXJfdHlwZSxcbiAgICAgICAgICBpc192ZXJpZmllZCxcbiAgICAgICAgICBpc19hY3RpdmVcbiAgICAgICAgKVxuICAgICAgYClcbiAgICAgIC5lcSgnc2Vzc2lvbl90b2tlbicsIHNlc3Npb25Ub2tlbilcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgY29uc29sZS5sb2coJ/CflI0gREVCVUc6IFNlc3Npb24gcXVlcnkgcmVzdWx0OicsIHsgc2Vzc2lvbkRhdGEsIHNlc3Npb25FcnJvciB9KVxuXG4gICAgaWYgKHNlc3Npb25FcnJvciB8fCAhc2Vzc2lvbkRhdGEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgSW52YWxpZCBzZXNzaW9uIHRva2VuOicsIHNlc3Npb25FcnJvcilcbiAgICAgIC8vIFJlbW92ZSBmcm9tIGNhY2hlIGlmIGl0IHdhcyBpbnZhbGlkXG4gICAgICBzZXNzaW9uQ2FjaGUuZGVsZXRlKHNlc3Npb25Ub2tlbilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgc2Vzc2lvbiBpcyBleHBpcmVkXG4gICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoc2Vzc2lvbkRhdGEuZXhwaXJlc19hdClcbiAgICBpZiAoZXhwaXJlc0F0IDwgbmV3IERhdGUoKSkge1xuICAgICAgY29uc29sZS5sb2coJ+KdjCBTZXNzaW9uIGV4cGlyZWQnKVxuICAgICAgLy8gQ2xlYW4gdXAgZXhwaXJlZCBzZXNzaW9uIGFuZCBjYWNoZVxuICAgICAgc2Vzc2lvbkNhY2hlLmRlbGV0ZShzZXNzaW9uVG9rZW4pXG4gICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9zZXNzaW9ucycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ3Nlc3Npb25fdG9rZW4nLCBzZXNzaW9uVG9rZW4pXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIC8vIENyZWF0ZSBzZXNzaW9uIG9iamVjdFxuICAgIGNvbnN0IHNlc3Npb246IFNlcnZlclNlc3Npb24gPSB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiAoc2Vzc2lvbkRhdGEudXNlcnMgYXMgYW55KS5pZCxcbiAgICAgICAgZW1haWw6IChzZXNzaW9uRGF0YS51c2VycyBhcyBhbnkpLmVtYWlsLFxuICAgICAgICBmdWxsX25hbWU6IChzZXNzaW9uRGF0YS51c2VycyBhcyBhbnkpLmZ1bGxfbmFtZSxcbiAgICAgICAgdXNlcl90eXBlOiAoc2Vzc2lvbkRhdGEudXNlcnMgYXMgYW55KS51c2VyX3R5cGUsXG4gICAgICAgIGlzX3ZlcmlmaWVkOiAoc2Vzc2lvbkRhdGEudXNlcnMgYXMgYW55KS5pc192ZXJpZmllZCxcbiAgICAgICAgaXNfYWN0aXZlOiAoc2Vzc2lvbkRhdGEudXNlcnMgYXMgYW55KS5pc19hY3RpdmVcbiAgICAgIH0sXG4gICAgICBzZXNzaW9uX3Rva2VuOiBzZXNzaW9uRGF0YS5zZXNzaW9uX3Rva2VuLFxuICAgICAgZXhwaXJlc19hdDogZXhwaXJlc0F0XG4gICAgfVxuXG4gICAgLy8gQ2FjaGUgdGhlIHZhbGlkYXRlZCBzZXNzaW9uXG4gICAgc2Vzc2lvbkNhY2hlLnNldChzZXNzaW9uVG9rZW4sIHtcbiAgICAgIHNlc3Npb24sXG4gICAgICBleHBpcnk6IERhdGUubm93KCkgKyBDQUNIRV9UVExfTVNcbiAgICB9KVxuXG4gICAgLy8gVXBkYXRlIGxhc3QgYWNjZXNzZWQgdGltZSAoYXN5bmMsIGRvbid0IHdhaXQpXG4gICAgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX3Nlc3Npb25zJylcbiAgICAgIC51cGRhdGUoeyBsYXN0X2FjY2Vzc2VkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSlcbiAgICAgIC5lcSgnc2Vzc2lvbl90b2tlbicsIHNlc3Npb25Ub2tlbilcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEZhaWxlZCB0byB1cGRhdGUgc2Vzc2lvbiBhY2Nlc3MgdGltZTonLCByZXN1bHQuZXJyb3IpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSBTZXNzaW9uIGFjY2VzcyB0aW1lIHVwZGF0ZWQnKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgcmV0dXJuIHNlc3Npb25cblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciB2ZXJpZnlpbmcgc2VydmVyIHNlc3Npb246JywgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vKipcbiAqIFJlcXVpcmUgYXV0aGVudGljYXRpb24gYW5kIG9wdGlvbmFsbHkgc3BlY2lmaWMgdXNlciB0eXBlXG4gKiBUaHJvd3MgcmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWQgb3Igd3JvbmcgdXNlciB0eXBlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXV0aChhbGxvd2VkVXNlclR5cGVzPzogc3RyaW5nW10pOiBQcm9taXNlPFNlcnZlclNlc3Npb24+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oKVxuICBcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmVkaXJlY3QoJy9sb2dpbicpXG4gIH1cbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyLmlzX2FjdGl2ZSkge1xuICAgIHJlZGlyZWN0KCcvYWNjb3VudC1kaXNhYmxlZCcpXG4gIH1cbiAgXG4gIGlmIChhbGxvd2VkVXNlclR5cGVzICYmICFhbGxvd2VkVXNlclR5cGVzLmluY2x1ZGVzKHNlc3Npb24udXNlci51c2VyX3R5cGUpKSB7XG4gICAgcmVkaXJlY3QoJy91bmF1dGhvcml6ZWQnKVxuICB9XG4gIFxuICByZXR1cm4gc2Vzc2lvblxufVxuXG4vKipcbiAqIFJlcXVpcmUgc3BlY2lmaWMgdXNlciB0eXBlIGZvciBBUEkgcm91dGVzXG4gKiBSZXR1cm5zIGVycm9yIHJlc3BvbnNlIGlmIG5vdCBhdXRob3JpemVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXBpQXV0aChhbGxvd2VkVXNlclR5cGVzPzogc3RyaW5nW10pOiBQcm9taXNlPHsgc2Vzc2lvbjogU2VydmVyU2Vzc2lvbiB9IHwgeyBlcnJvcjogUmVzcG9uc2UgfT4ge1xuICAvLyBUcnkgdW5pZmllZCBzZXNzaW9uIGZpcnN0XG4gIGNvbnN0IHVuaWZpZWRTZXNzaW9uID0gYXdhaXQgU2Vzc2lvbk1hbmFnZXIuZ2V0U2Vzc2lvbigpXG4gIFxuICBpZiAodW5pZmllZFNlc3Npb24pIHtcbiAgICAvLyBDb252ZXJ0IHVuaWZpZWQgc2Vzc2lvbiB0byBTZXJ2ZXJTZXNzaW9uIGZvcm1hdFxuICAgIGNvbnN0IHNlc3Npb246IFNlcnZlclNlc3Npb24gPSB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiB1bmlmaWVkU2Vzc2lvbi5pZCxcbiAgICAgICAgZW1haWw6IHVuaWZpZWRTZXNzaW9uLmVtYWlsLFxuICAgICAgICBmdWxsX25hbWU6IHVuaWZpZWRTZXNzaW9uLm5hbWUsXG4gICAgICAgIHVzZXJfdHlwZTogdW5pZmllZFNlc3Npb24udXNlcl90eXBlIGFzICdpbmRpdmlkdWFsJyB8ICd0aGVyYXBpc3QnIHwgJ3BhcnRuZXInIHwgJ2FkbWluJyxcbiAgICAgICAgaXNfdmVyaWZpZWQ6IHVuaWZpZWRTZXNzaW9uLmlzX3ZlcmlmaWVkLFxuICAgICAgICBpc19hY3RpdmU6IHVuaWZpZWRTZXNzaW9uLmlzX2FjdGl2ZVxuICAgICAgfSxcbiAgICAgIHNlc3Npb25fdG9rZW46IHVuaWZpZWRTZXNzaW9uLnNlc3Npb25fdG9rZW4gfHwgJycsXG4gICAgICBleHBpcmVzX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gMjQgaG91cnMgZnJvbSBub3dcbiAgICB9XG4gICAgXG4gICAgaWYgKCFzZXNzaW9uLnVzZXIuaXNfYWN0aXZlKSB7XG4gICAgICByZXR1cm4geyBcbiAgICAgICAgZXJyb3I6IG5ldyBSZXNwb25zZShcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnQWNjb3VudCBkaXNhYmxlZCcgfSksIFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDMsIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9IH1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoYWxsb3dlZFVzZXJUeXBlcyAmJiAhYWxsb3dlZFVzZXJUeXBlcy5pbmNsdWRlcyhzZXNzaW9uLnVzZXIudXNlcl90eXBlKSkge1xuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIGVycm9yOiBuZXcgUmVzcG9uc2UoXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycgfSksIFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDMsIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9IH1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBzZXNzaW9uIH1cbiAgfVxuICBcbiAgLy8gRmFsbGJhY2sgdG8gb2xkIHNlc3Npb24gc3lzdGVtXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKClcbiAgXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7IFxuICAgICAgZXJyb3I6IG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyB9KSwgXG4gICAgICAgIHsgc3RhdHVzOiA0MDEsIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9IH1cbiAgICAgIClcbiAgICB9XG4gIH1cbiAgXG4gIGlmICghc2Vzc2lvbi51c2VyLmlzX2FjdGl2ZSkge1xuICAgIHJldHVybiB7IFxuICAgICAgZXJyb3I6IG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ0FjY291bnQgZGlzYWJsZWQnIH0pLCBcbiAgICAgICAgeyBzdGF0dXM6IDQwMywgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0gfVxuICAgICAgKVxuICAgIH1cbiAgfVxuICBcbiAgaWYgKGFsbG93ZWRVc2VyVHlwZXMgJiYgIWFsbG93ZWRVc2VyVHlwZXMuaW5jbHVkZXMoc2Vzc2lvbi51c2VyLnVzZXJfdHlwZSkpIHtcbiAgICByZXR1cm4geyBcbiAgICAgIGVycm9yOiBuZXcgUmVzcG9uc2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6ICdJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnIH0pLCBcbiAgICAgICAgeyBzdGF0dXM6IDQwMywgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0gfVxuICAgICAgKVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHsgc2Vzc2lvbiB9XG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImNyZWF0ZUNsaWVudCIsInJlZGlyZWN0IiwiU2Vzc2lvbk1hbmFnZXIiLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwic2Vzc2lvbkNhY2hlIiwiTWFwIiwiQ0FDSEVfVFRMX01TIiwiZ2V0U2VydmVyU2Vzc2lvbiIsImNvb2tpZVN0b3JlIiwiY29va2llTmFtZXMiLCJ1c2VyQ29va2llIiwiY29va2llRGF0YSIsImNvb2tpZU5hbWUiLCJnZXQiLCJjb25zb2xlIiwibG9nIiwiand0VmVyaWZ5IiwiSldUX1NFQ1JFVCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwicGF5bG9hZCIsInZhbHVlIiwic2Vzc2lvbl90b2tlbiIsImlkIiwiZW1haWwiLCJmdWxsX25hbWUiLCJuYW1lIiwidXNlcl90eXBlIiwicm9sZSIsImlzX3ZlcmlmaWVkIiwiaXNfYWN0aXZlIiwiSlNPTiIsInBhcnNlIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZXJyb3IiLCJzZXNzaW9uIiwidXNlciIsImV4cGlyZXNfYXQiLCJEYXRlIiwibm93Iiwic2Vzc2lvblRva2VuIiwiY2FjaGVkIiwiZXhwaXJ5IiwiZGF0YSIsInNlc3Npb25EYXRhIiwic2Vzc2lvbkVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiZGVsZXRlIiwiZXhwaXJlc0F0IiwidXNlcnMiLCJzZXQiLCJ1cGRhdGUiLCJsYXN0X2FjY2Vzc2VkX2F0IiwidG9JU09TdHJpbmciLCJ0aGVuIiwicmVzdWx0Iiwid2FybiIsInJlcXVpcmVBdXRoIiwiYWxsb3dlZFVzZXJUeXBlcyIsImluY2x1ZGVzIiwicmVxdWlyZUFwaUF1dGgiLCJ1bmlmaWVkU2Vzc2lvbiIsImdldFNlc3Npb24iLCJSZXNwb25zZSIsInN0cmluZ2lmeSIsInN0YXR1cyIsImhlYWRlcnMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/server-auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/session-manager.ts":
/*!********************************!*\
  !*** ./lib/session-manager.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SessionManager: () => (/* binding */ SessionManager),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\n\n\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || 'trpi-super-secret-key-2024-therapy-platform');\nclass SessionManager {\n    static{\n        this.COOKIE_NAME = 'quiet_session';\n    }\n    static{\n        this.MAX_AGE = 24 * 60 * 60 * 1000 // 24 hours (healthcare-grade security)\n        ;\n    }\n    static{\n        this.REFRESH_WINDOW = 6 * 60 * 60 * 1000 // Refresh if < 6 hours left\n        ;\n    }\n    static{\n        this.GRACE_PERIOD = 30 * 60 * 1000 // 30 minutes grace after expiry\n        ;\n    }\n    static{\n        this.ABSOLUTE_MAX_AGE = 30 * 24 * 60 * 60 * 1000 // 30 days absolute maximum\n        ;\n    }\n    /**\n   * Create a new session and set the cookie\n   */ static async createSession(sessionData) {\n        const token = await new jose__WEBPACK_IMPORTED_MODULE_2__.SignJWT(sessionData).setProtectedHeader({\n            alg: 'HS256'\n        }).setIssuedAt().setExpirationTime('24h') // Healthcare-grade: 24 hours\n        .sign(JWT_SECRET);\n        // Set the cookie\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        cookieStore.set(this.COOKIE_NAME, token, {\n            httpOnly: true,\n            secure: \"development\" === 'production',\n            sameSite: 'lax',\n            maxAge: this.MAX_AGE,\n            path: '/'\n        });\n        return token;\n    }\n    /**\n   * Get the current session from the cookie\n   */ static async getSession() {\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n            const token = cookieStore.get(this.COOKIE_NAME)?.value;\n            if (!token) {\n                console.log('🔍 No session cookie found');\n                return null;\n            }\n            console.log('🍪 Raw cookie value:', token.substring(0, 50) + '...');\n            const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(token, JWT_SECRET);\n            const sessionData = payload;\n            // Basic validation\n            if (!sessionData.id || !sessionData.email) {\n                console.error('❌ Invalid session data structure');\n                return null;\n            }\n            console.log('✅ Session validated for user:', sessionData.email);\n            return sessionData;\n        } catch (error) {\n            // Distinguish between expired and invalid tokens\n            if (error?.code === 'ERR_JWT_EXPIRED' || error?.message?.includes('exp')) {\n                console.log('⏰ Session token expired');\n            } else {\n                console.error('❌ Session retrieval error:', error);\n            }\n            return null;\n        }\n    }\n    /**\n   * Get session with automatic refresh if nearing expiration\n   */ static async getSessionWithRefresh() {\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n            const token = cookieStore.get(this.COOKIE_NAME)?.value;\n            if (!token) {\n                console.log('🔍 No session cookie found');\n                return null;\n            }\n            try {\n                const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(token, JWT_SECRET);\n                const sessionData = payload;\n                // Check if token is nearing expiration (less than 6 hours remaining)\n                const expiryTime = (payload.exp || 0) * 1000;\n                const timeUntilExpiry = expiryTime - Date.now();\n                if (timeUntilExpiry < this.REFRESH_WINDOW && timeUntilExpiry > 0) {\n                    console.log('🔄 Session nearing expiration, refreshing...');\n                    // Refresh the session\n                    await this.createSession(sessionData);\n                    console.log('✅ Session refreshed successfully');\n                }\n                return sessionData;\n            } catch (error) {\n                // If token is expired but within grace period (30 minutes), allow refresh\n                if (error?.code === 'ERR_JWT_EXPIRED' || error?.message?.includes('exp')) {\n                    console.log('⏰ Token expired, checking if within grace period...');\n                    try {\n                        // Decode without verification to check expiry time\n                        const decoded = JSON.parse(Buffer.from(token.split('.')[1], 'base64').toString());\n                        const expiryTime = decoded.exp * 1000;\n                        const timeSinceExpiry = Date.now() - expiryTime;\n                        // Allow refresh if expired less than 30 minutes ago (grace period)\n                        if (timeSinceExpiry < this.GRACE_PERIOD && timeSinceExpiry > 0) {\n                            console.log('✅ Within 30-minute grace period, refreshing session...');\n                            const sessionData = decoded;\n                            await this.createSession(sessionData);\n                            return sessionData;\n                        } else {\n                            console.log('❌ Expired beyond grace period, cannot refresh');\n                        }\n                    } catch (decodeError) {\n                        console.error('❌ Error decoding expired token:', decodeError);\n                    }\n                }\n                console.error('❌ Session retrieval error:', error);\n                return null;\n            }\n        } catch (error) {\n            console.error('❌ Session refresh error:', error);\n            return null;\n        }\n    }\n    /**\n   * Get session from request (for API routes)\n   */ static async getSessionFromRequest(request) {\n        try {\n            const sessionCookie = request.cookies.get(this.COOKIE_NAME)?.value;\n            if (!sessionCookie) {\n                console.log('🔍 No session cookie found');\n                return null;\n            }\n            console.log('🍪 Raw cookie value:', sessionCookie.substring(0, 50) + '...');\n            // Verify JWT token\n            const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(sessionCookie, JWT_SECRET);\n            const sessionData = payload;\n            // Basic validation\n            if (!sessionData.id || !sessionData.email) {\n                console.error('❌ Invalid session data structure');\n                return null;\n            }\n            console.log('✅ Session found for user:', sessionData.email);\n            return sessionData;\n        } catch (error) {\n            console.error('❌ Session retrieval error:', error);\n            return null;\n        }\n    }\n    /**\n   * Clear the session cookie\n   */ static async clearSession() {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        cookieStore.delete(this.COOKIE_NAME);\n    }\n    /**\n   * Clear expired session cookie from request\n   */ static async clearExpiredSession(request) {\n        const token = request.cookies.get(this.COOKIE_NAME)?.value;\n        if (token) {\n            try {\n                await (0,jose__WEBPACK_IMPORTED_MODULE_3__.jwtVerify)(token, JWT_SECRET);\n            } catch (error) {\n                // Token is expired or invalid, clear it\n                if (error instanceof Error && error.message.includes('exp')) {\n                    const response = next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next();\n                    response.cookies.delete(this.COOKIE_NAME);\n                    return;\n                }\n            }\n        }\n    }\n    /**\n   * Update session data (useful for profile updates)\n   */ static async updateSession(updates) {\n        const currentSession = await this.getSession();\n        if (!currentSession) {\n            return null;\n        }\n        const updatedSession = {\n            ...currentSession,\n            ...updates\n        };\n        await this.createSession(updatedSession);\n        return updatedSession;\n    }\n    /**\n   * Check if user has specific role\n   */ static async hasRole(role) {\n        const session = await this.getSession();\n        return session?.role === role;\n    }\n    /**\n   * Require specific role (throws if not authorized)\n   */ static async requireRole(role) {\n        const session = await this.getSession();\n        if (!session || session.role !== role) {\n            throw new Error(`Access denied. Required role: ${role}`);\n        }\n        return session;\n    }\n}\n/**\n * Middleware helper for API routes\n */ async function requireAuth(requiredRole) {\n    return async (request)=>{\n        const session = await SessionManager.getSessionFromRequest(request);\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: 'Authentication required'\n            }, {\n                status: 401\n            });\n        }\n        if (requiredRole && session.role !== requiredRole) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: `Access denied. Required role: ${requiredRole}`\n            }, {\n                status: 403\n            });\n        }\n        return {\n            session\n        };\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2Vzc2lvbi1tYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF5QztBQUNIO0FBQ2lCO0FBRXZELE1BQU1JLGFBQWEsSUFBSUMsY0FBY0MsTUFBTSxDQUFDQyxRQUFRQyxHQUFHLENBQUNKLFVBQVUsSUFBSTtBQWEvRCxNQUFNSzs7YUFDYUMsY0FBYzs7O2FBQ2RDLFVBQVUsS0FBSyxLQUFLLEtBQUssS0FBSyx1Q0FBdUM7Ozs7YUFDckVDLGlCQUFpQixJQUFJLEtBQUssS0FBSyxLQUFLLDRCQUE0Qjs7OzthQUNoRUMsZUFBZSxLQUFLLEtBQUssS0FBSyxnQ0FBZ0M7Ozs7YUFDOURDLG1CQUFtQixLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUssMkJBQTJCOzs7SUFFL0Y7O0dBRUMsR0FDRCxhQUFhQyxjQUFjQyxXQUF3QixFQUFtQjtRQUNwRSxNQUFNQyxRQUFRLE1BQU0sSUFBSWpCLHlDQUFPQSxDQUFDZ0IsYUFDN0JFLGtCQUFrQixDQUFDO1lBQUVDLEtBQUs7UUFBUSxHQUNsQ0MsV0FBVyxHQUNYQyxpQkFBaUIsQ0FBQyxPQUFPLDZCQUE2QjtTQUN0REMsSUFBSSxDQUFDbEI7UUFFUixpQkFBaUI7UUFDakIsTUFBTW1CLGNBQWMsTUFBTXJCLHFEQUFPQTtRQUNqQ3FCLFlBQVlDLEdBQUcsQ0FBQyxJQUFJLENBQUNkLFdBQVcsRUFBRU8sT0FBTztZQUN2Q1EsVUFBVTtZQUNWQyxRQUFRbkIsa0JBQXlCO1lBQ2pDb0IsVUFBVTtZQUNWQyxRQUFRLElBQUksQ0FBQ2pCLE9BQU87WUFDcEJrQixNQUFNO1FBQ1I7UUFFQSxPQUFPWjtJQUNUO0lBRUE7O0dBRUMsR0FDRCxhQUFhYSxhQUEwQztRQUNyRCxJQUFJO1lBQ0YsTUFBTVAsY0FBYyxNQUFNckIscURBQU9BO1lBQ2pDLE1BQU1lLFFBQVFNLFlBQVlRLEdBQUcsQ0FBQyxJQUFJLENBQUNyQixXQUFXLEdBQUdzQjtZQUVqRCxJQUFJLENBQUNmLE9BQU87Z0JBQ1ZnQixRQUFRQyxHQUFHLENBQUM7Z0JBQ1osT0FBTztZQUNUO1lBRUFELFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JqQixNQUFNa0IsU0FBUyxDQUFDLEdBQUcsTUFBTTtZQUU3RCxNQUFNLEVBQUVDLE9BQU8sRUFBRSxHQUFHLE1BQU1uQywrQ0FBU0EsQ0FBQ2dCLE9BQU9iO1lBQzNDLE1BQU1ZLGNBQWNvQjtZQUVwQixtQkFBbUI7WUFDbkIsSUFBSSxDQUFDcEIsWUFBWXFCLEVBQUUsSUFBSSxDQUFDckIsWUFBWXNCLEtBQUssRUFBRTtnQkFDekNMLFFBQVFNLEtBQUssQ0FBQztnQkFDZCxPQUFPO1lBQ1Q7WUFFQU4sUUFBUUMsR0FBRyxDQUFDLGlDQUFpQ2xCLFlBQVlzQixLQUFLO1lBQzlELE9BQU90QjtRQUNULEVBQUUsT0FBT3VCLE9BQVk7WUFDbkIsaURBQWlEO1lBQ2pELElBQUlBLE9BQU9DLFNBQVMscUJBQXFCRCxPQUFPRSxTQUFTQyxTQUFTLFFBQVE7Z0JBQ3hFVCxRQUFRQyxHQUFHLENBQUM7WUFDZCxPQUFPO2dCQUNMRCxRQUFRTSxLQUFLLENBQUMsOEJBQThCQTtZQUM5QztZQUNBLE9BQU87UUFDVDtJQUNGO0lBRUE7O0dBRUMsR0FDRCxhQUFhSSx3QkFBcUQ7UUFDaEUsSUFBSTtZQUNGLE1BQU1wQixjQUFjLE1BQU1yQixxREFBT0E7WUFDakMsTUFBTWUsUUFBUU0sWUFBWVEsR0FBRyxDQUFDLElBQUksQ0FBQ3JCLFdBQVcsR0FBR3NCO1lBRWpELElBQUksQ0FBQ2YsT0FBTztnQkFDVmdCLFFBQVFDLEdBQUcsQ0FBQztnQkFDWixPQUFPO1lBQ1Q7WUFFQSxJQUFJO2dCQUNGLE1BQU0sRUFBRUUsT0FBTyxFQUFFLEdBQUcsTUFBTW5DLCtDQUFTQSxDQUFDZ0IsT0FBT2I7Z0JBQzNDLE1BQU1ZLGNBQWNvQjtnQkFFcEIscUVBQXFFO2dCQUNyRSxNQUFNUSxhQUFhLENBQUNSLFFBQVFTLEdBQUcsSUFBSSxLQUFLO2dCQUN4QyxNQUFNQyxrQkFBa0JGLGFBQWFHLEtBQUtDLEdBQUc7Z0JBRTdDLElBQUlGLGtCQUFrQixJQUFJLENBQUNsQyxjQUFjLElBQUlrQyxrQkFBa0IsR0FBRztvQkFDaEViLFFBQVFDLEdBQUcsQ0FBQztvQkFDWixzQkFBc0I7b0JBQ3RCLE1BQU0sSUFBSSxDQUFDbkIsYUFBYSxDQUFDQztvQkFDekJpQixRQUFRQyxHQUFHLENBQUM7Z0JBQ2Q7Z0JBRUEsT0FBT2xCO1lBQ1QsRUFBRSxPQUFPdUIsT0FBWTtnQkFDbkIsMEVBQTBFO2dCQUMxRSxJQUFJQSxPQUFPQyxTQUFTLHFCQUFxQkQsT0FBT0UsU0FBU0MsU0FBUyxRQUFRO29CQUN4RVQsUUFBUUMsR0FBRyxDQUFDO29CQUVaLElBQUk7d0JBQ0YsbURBQW1EO3dCQUNuRCxNQUFNZSxVQUFVQyxLQUFLQyxLQUFLLENBQUNDLE9BQU9DLElBQUksQ0FBQ3BDLE1BQU1xQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxVQUFVQyxRQUFRO3dCQUM5RSxNQUFNWCxhQUFhSyxRQUFRSixHQUFHLEdBQUc7d0JBQ2pDLE1BQU1XLGtCQUFrQlQsS0FBS0MsR0FBRyxLQUFLSjt3QkFFckMsbUVBQW1FO3dCQUNuRSxJQUFJWSxrQkFBa0IsSUFBSSxDQUFDM0MsWUFBWSxJQUFJMkMsa0JBQWtCLEdBQUc7NEJBQzlEdkIsUUFBUUMsR0FBRyxDQUFDOzRCQUNaLE1BQU1sQixjQUFjaUM7NEJBQ3BCLE1BQU0sSUFBSSxDQUFDbEMsYUFBYSxDQUFDQzs0QkFDekIsT0FBT0E7d0JBQ1QsT0FBTzs0QkFDTGlCLFFBQVFDLEdBQUcsQ0FBQzt3QkFDZDtvQkFDRixFQUFFLE9BQU91QixhQUFhO3dCQUNwQnhCLFFBQVFNLEtBQUssQ0FBQyxtQ0FBbUNrQjtvQkFDbkQ7Z0JBQ0Y7Z0JBRUF4QixRQUFRTSxLQUFLLENBQUMsOEJBQThCQTtnQkFDNUMsT0FBTztZQUNUO1FBQ0YsRUFBRSxPQUFPQSxPQUFPO1lBQ2ROLFFBQVFNLEtBQUssQ0FBQyw0QkFBNEJBO1lBQzFDLE9BQU87UUFDVDtJQUNGO0lBRUE7O0dBRUMsR0FDRCxhQUFhbUIsc0JBQXNCQyxPQUFvQixFQUErQjtRQUNwRixJQUFJO1lBQ0YsTUFBTUMsZ0JBQWdCRCxRQUFRekQsT0FBTyxDQUFDNkIsR0FBRyxDQUFDLElBQUksQ0FBQ3JCLFdBQVcsR0FBR3NCO1lBRTdELElBQUksQ0FBQzRCLGVBQWU7Z0JBQ2xCM0IsUUFBUUMsR0FBRyxDQUFDO2dCQUNaLE9BQU87WUFDVDtZQUVBRCxRQUFRQyxHQUFHLENBQUMsd0JBQXdCMEIsY0FBY3pCLFNBQVMsQ0FBQyxHQUFHLE1BQU07WUFFckUsbUJBQW1CO1lBQ25CLE1BQU0sRUFBRUMsT0FBTyxFQUFFLEdBQUcsTUFBTW5DLCtDQUFTQSxDQUFDMkQsZUFBZXhEO1lBQ25ELE1BQU1ZLGNBQWNvQjtZQUVwQixtQkFBbUI7WUFDbkIsSUFBSSxDQUFDcEIsWUFBWXFCLEVBQUUsSUFBSSxDQUFDckIsWUFBWXNCLEtBQUssRUFBRTtnQkFDekNMLFFBQVFNLEtBQUssQ0FBQztnQkFDZCxPQUFPO1lBQ1Q7WUFFQU4sUUFBUUMsR0FBRyxDQUFDLDZCQUE2QmxCLFlBQVlzQixLQUFLO1lBQzFELE9BQU90QjtRQUVULEVBQUUsT0FBT3VCLE9BQU87WUFDZE4sUUFBUU0sS0FBSyxDQUFDLDhCQUE4QkE7WUFDNUMsT0FBTztRQUNUO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGFBQWFzQixlQUE4QjtRQUN6QyxNQUFNdEMsY0FBYyxNQUFNckIscURBQU9BO1FBQ2pDcUIsWUFBWXVDLE1BQU0sQ0FBQyxJQUFJLENBQUNwRCxXQUFXO0lBQ3JDO0lBRUE7O0dBRUMsR0FDRCxhQUFhcUQsb0JBQW9CSixPQUFvQixFQUFpQjtRQUNwRSxNQUFNMUMsUUFBUTBDLFFBQVF6RCxPQUFPLENBQUM2QixHQUFHLENBQUMsSUFBSSxDQUFDckIsV0FBVyxHQUFHc0I7UUFDckQsSUFBSWYsT0FBTztZQUNULElBQUk7Z0JBQ0YsTUFBTWhCLCtDQUFTQSxDQUFDZ0IsT0FBT2I7WUFDekIsRUFBRSxPQUFPbUMsT0FBTztnQkFDZCx3Q0FBd0M7Z0JBQ3hDLElBQUlBLGlCQUFpQnlCLFNBQVN6QixNQUFNRSxPQUFPLENBQUNDLFFBQVEsQ0FBQyxRQUFRO29CQUMzRCxNQUFNdUIsV0FBVzlELHFEQUFZQSxDQUFDK0QsSUFBSTtvQkFDbENELFNBQVMvRCxPQUFPLENBQUM0RCxNQUFNLENBQUMsSUFBSSxDQUFDcEQsV0FBVztvQkFDeEM7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGFBQWF5RCxjQUFjQyxPQUE2QixFQUErQjtRQUNyRixNQUFNQyxpQkFBaUIsTUFBTSxJQUFJLENBQUN2QyxVQUFVO1FBQzVDLElBQUksQ0FBQ3VDLGdCQUFnQjtZQUNuQixPQUFPO1FBQ1Q7UUFFQSxNQUFNQyxpQkFBaUI7WUFBRSxHQUFHRCxjQUFjO1lBQUUsR0FBR0QsT0FBTztRQUFDO1FBQ3ZELE1BQU0sSUFBSSxDQUFDckQsYUFBYSxDQUFDdUQ7UUFDekIsT0FBT0E7SUFDVDtJQUVBOztHQUVDLEdBQ0QsYUFBYUMsUUFBUUMsSUFBeUIsRUFBb0I7UUFDaEUsTUFBTUMsVUFBVSxNQUFNLElBQUksQ0FBQzNDLFVBQVU7UUFDckMsT0FBTzJDLFNBQVNELFNBQVNBO0lBQzNCO0lBRUE7O0dBRUMsR0FDRCxhQUFhRSxZQUFZRixJQUF5QixFQUF3QjtRQUN4RSxNQUFNQyxVQUFVLE1BQU0sSUFBSSxDQUFDM0MsVUFBVTtRQUNyQyxJQUFJLENBQUMyQyxXQUFXQSxRQUFRRCxJQUFJLEtBQUtBLE1BQU07WUFDckMsTUFBTSxJQUFJUixNQUFNLENBQUMsOEJBQThCLEVBQUVRLE1BQU07UUFDekQ7UUFDQSxPQUFPQztJQUNUO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVFLFlBQVlDLFlBQWtDO0lBQ2xFLE9BQU8sT0FBT2pCO1FBQ1osTUFBTWMsVUFBVSxNQUFNaEUsZUFBZWlELHFCQUFxQixDQUFDQztRQUUzRCxJQUFJLENBQUNjLFNBQVM7WUFDWixPQUFPdEUscURBQVlBLENBQUMwRSxJQUFJLENBQUM7Z0JBQUV0QyxPQUFPO1lBQTBCLEdBQUc7Z0JBQUV1QyxRQUFRO1lBQUk7UUFDL0U7UUFFQSxJQUFJRixnQkFBZ0JILFFBQVFELElBQUksS0FBS0ksY0FBYztZQUNqRCxPQUFPekUscURBQVlBLENBQUMwRSxJQUFJLENBQUM7Z0JBQUV0QyxPQUFPLENBQUMsOEJBQThCLEVBQUVxQyxjQUFjO1lBQUMsR0FBRztnQkFBRUUsUUFBUTtZQUFJO1FBQ3JHO1FBRUEsT0FBTztZQUFFTDtRQUFRO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWNib29rL0Rlc2t0b3AvdHJwaS1hcHAvbGliL3Nlc3Npb24tbWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaWduSldULCBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJ1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcblxuY29uc3QgSldUX1NFQ1JFVCA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd0cnBpLXN1cGVyLXNlY3JldC1rZXktMjAyNC10aGVyYXB5LXBsYXRmb3JtJylcblxuZXhwb3J0IGludGVyZmFjZSBTZXNzaW9uRGF0YSB7XG4gIGlkOiBzdHJpbmdcbiAgZW1haWw6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgcm9sZTogJ2luZGl2aWR1YWwnIHwgJ3RoZXJhcGlzdCcgfCAncGFydG5lcicgfCAnYWRtaW4nXG4gIHVzZXJfdHlwZTogc3RyaW5nXG4gIGlzX3ZlcmlmaWVkOiBib29sZWFuXG4gIGlzX2FjdGl2ZTogYm9vbGVhblxuICBzZXNzaW9uX3Rva2VuPzogc3RyaW5nXG59XG5cbmV4cG9ydCBjbGFzcyBTZXNzaW9uTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENPT0tJRV9OQU1FID0gJ3F1aWV0X3Nlc3Npb24nXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1BWF9BR0UgPSAyNCAqIDYwICogNjAgKiAxMDAwIC8vIDI0IGhvdXJzIChoZWFsdGhjYXJlLWdyYWRlIHNlY3VyaXR5KVxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBSRUZSRVNIX1dJTkRPVyA9IDYgKiA2MCAqIDYwICogMTAwMCAvLyBSZWZyZXNoIGlmIDwgNiBob3VycyBsZWZ0XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEdSQUNFX1BFUklPRCA9IDMwICogNjAgKiAxMDAwIC8vIDMwIG1pbnV0ZXMgZ3JhY2UgYWZ0ZXIgZXhwaXJ5XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEFCU09MVVRFX01BWF9BR0UgPSAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDAgLy8gMzAgZGF5cyBhYnNvbHV0ZSBtYXhpbXVtXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBzZXNzaW9uIGFuZCBzZXQgdGhlIGNvb2tpZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGNyZWF0ZVNlc3Npb24oc2Vzc2lvbkRhdGE6IFNlc3Npb25EYXRhKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IG5ldyBTaWduSldUKHNlc3Npb25EYXRhIGFzIGFueSlcbiAgICAgIC5zZXRQcm90ZWN0ZWRIZWFkZXIoeyBhbGc6ICdIUzI1NicgfSlcbiAgICAgIC5zZXRJc3N1ZWRBdCgpXG4gICAgICAuc2V0RXhwaXJhdGlvblRpbWUoJzI0aCcpIC8vIEhlYWx0aGNhcmUtZ3JhZGU6IDI0IGhvdXJzXG4gICAgICAuc2lnbihKV1RfU0VDUkVUKVxuXG4gICAgLy8gU2V0IHRoZSBjb29raWVcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuICAgIGNvb2tpZVN0b3JlLnNldCh0aGlzLkNPT0tJRV9OQU1FLCB0b2tlbiwge1xuICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICBzYW1lU2l0ZTogJ2xheCcsXG4gICAgICBtYXhBZ2U6IHRoaXMuTUFYX0FHRSwgLy8gMjQgaG91cnNcbiAgICAgIHBhdGg6ICcvJ1xuICAgIH0pXG5cbiAgICByZXR1cm4gdG9rZW5cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvbiBmcm9tIHRoZSBjb29raWVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRTZXNzaW9uKCk6IFByb21pc2U8U2Vzc2lvbkRhdGEgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gICAgICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldCh0aGlzLkNPT0tJRV9OQU1FKT8udmFsdWVcblxuICAgICAgaWYgKCF0b2tlbikge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBObyBzZXNzaW9uIGNvb2tpZSBmb3VuZCcpXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfwn42qIFJhdyBjb29raWUgdmFsdWU6JywgdG9rZW4uc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nKVxuXG4gICAgICBjb25zdCB7IHBheWxvYWQgfSA9IGF3YWl0IGp3dFZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVClcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gcGF5bG9hZCBhcyBhbnkgYXMgU2Vzc2lvbkRhdGFcblxuICAgICAgLy8gQmFzaWMgdmFsaWRhdGlvblxuICAgICAgaWYgKCFzZXNzaW9uRGF0YS5pZCB8fCAhc2Vzc2lvbkRhdGEuZW1haWwpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEludmFsaWQgc2Vzc2lvbiBkYXRhIHN0cnVjdHVyZScpXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiB2YWxpZGF0ZWQgZm9yIHVzZXI6Jywgc2Vzc2lvbkRhdGEuZW1haWwpXG4gICAgICByZXR1cm4gc2Vzc2lvbkRhdGFcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBEaXN0aW5ndWlzaCBiZXR3ZWVuIGV4cGlyZWQgYW5kIGludmFsaWQgdG9rZW5zXG4gICAgICBpZiAoZXJyb3I/LmNvZGUgPT09ICdFUlJfSldUX0VYUElSRUQnIHx8IGVycm9yPy5tZXNzYWdlPy5pbmNsdWRlcygnZXhwJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KPsCBTZXNzaW9uIHRva2VuIGV4cGlyZWQnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFNlc3Npb24gcmV0cmlldmFsIGVycm9yOicsIGVycm9yKVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHNlc3Npb24gd2l0aCBhdXRvbWF0aWMgcmVmcmVzaCBpZiBuZWFyaW5nIGV4cGlyYXRpb25cbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRTZXNzaW9uV2l0aFJlZnJlc2goKTogUHJvbWlzZTxTZXNzaW9uRGF0YSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgICAgIGNvbnN0IHRva2VuID0gY29va2llU3RvcmUuZ2V0KHRoaXMuQ09PS0lFX05BTUUpPy52YWx1ZVxuXG4gICAgICBpZiAoIXRva2VuKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIE5vIHNlc3Npb24gY29va2llIGZvdW5kJylcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQpXG4gICAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gcGF5bG9hZCBhcyBhbnkgYXMgU2Vzc2lvbkRhdGFcblxuICAgICAgICAvLyBDaGVjayBpZiB0b2tlbiBpcyBuZWFyaW5nIGV4cGlyYXRpb24gKGxlc3MgdGhhbiA2IGhvdXJzIHJlbWFpbmluZylcbiAgICAgICAgY29uc3QgZXhwaXJ5VGltZSA9IChwYXlsb2FkLmV4cCB8fCAwKSAqIDEwMDBcbiAgICAgICAgY29uc3QgdGltZVVudGlsRXhwaXJ5ID0gZXhwaXJ5VGltZSAtIERhdGUubm93KClcblxuICAgICAgICBpZiAodGltZVVudGlsRXhwaXJ5IDwgdGhpcy5SRUZSRVNIX1dJTkRPVyAmJiB0aW1lVW50aWxFeHBpcnkgPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgU2Vzc2lvbiBuZWFyaW5nIGV4cGlyYXRpb24sIHJlZnJlc2hpbmcuLi4nKVxuICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIHNlc3Npb25cbiAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZVNlc3Npb24oc2Vzc2lvbkRhdGEpXG4gICAgICAgICAgY29uc29sZS5sb2coJ+KchSBTZXNzaW9uIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlc3Npb25EYXRhXG4gICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIC8vIElmIHRva2VuIGlzIGV4cGlyZWQgYnV0IHdpdGhpbiBncmFjZSBwZXJpb2QgKDMwIG1pbnV0ZXMpLCBhbGxvdyByZWZyZXNoXG4gICAgICAgIGlmIChlcnJvcj8uY29kZSA9PT0gJ0VSUl9KV1RfRVhQSVJFRCcgfHwgZXJyb3I/Lm1lc3NhZ2U/LmluY2x1ZGVzKCdleHAnKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfij7AgVG9rZW4gZXhwaXJlZCwgY2hlY2tpbmcgaWYgd2l0aGluIGdyYWNlIHBlcmlvZC4uLicpXG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIERlY29kZSB3aXRob3V0IHZlcmlmaWNhdGlvbiB0byBjaGVjayBleHBpcnkgdGltZVxuICAgICAgICAgICAgY29uc3QgZGVjb2RlZCA9IEpTT04ucGFyc2UoQnVmZmVyLmZyb20odG9rZW4uc3BsaXQoJy4nKVsxXSwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICBjb25zdCBleHBpcnlUaW1lID0gZGVjb2RlZC5leHAgKiAxMDAwXG4gICAgICAgICAgICBjb25zdCB0aW1lU2luY2VFeHBpcnkgPSBEYXRlLm5vdygpIC0gZXhwaXJ5VGltZVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBbGxvdyByZWZyZXNoIGlmIGV4cGlyZWQgbGVzcyB0aGFuIDMwIG1pbnV0ZXMgYWdvIChncmFjZSBwZXJpb2QpXG4gICAgICAgICAgICBpZiAodGltZVNpbmNlRXhwaXJ5IDwgdGhpcy5HUkFDRV9QRVJJT0QgJiYgdGltZVNpbmNlRXhwaXJ5ID4gMCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIFdpdGhpbiAzMC1taW51dGUgZ3JhY2UgcGVyaW9kLCByZWZyZXNoaW5nIHNlc3Npb24uLi4nKVxuICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uRGF0YSA9IGRlY29kZWQgYXMgU2Vzc2lvbkRhdGFcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVTZXNzaW9uKHNlc3Npb25EYXRhKVxuICAgICAgICAgICAgICByZXR1cm4gc2Vzc2lvbkRhdGFcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinYwgRXhwaXJlZCBiZXlvbmQgZ3JhY2UgcGVyaW9kLCBjYW5ub3QgcmVmcmVzaCcpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZGVjb2RlRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBkZWNvZGluZyBleHBpcmVkIHRva2VuOicsIGRlY29kZUVycm9yKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFNlc3Npb24gcmV0cmlldmFsIGVycm9yOicsIGVycm9yKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgU2Vzc2lvbiByZWZyZXNoIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHNlc3Npb24gZnJvbSByZXF1ZXN0IChmb3IgQVBJIHJvdXRlcylcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRTZXNzaW9uRnJvbVJlcXVlc3QocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPFNlc3Npb25EYXRhIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZXNzaW9uQ29va2llID0gcmVxdWVzdC5jb29raWVzLmdldCh0aGlzLkNPT0tJRV9OQU1FKT8udmFsdWVcblxuICAgICAgaWYgKCFzZXNzaW9uQ29va2llKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIE5vIHNlc3Npb24gY29va2llIGZvdW5kJylcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ/CfjaogUmF3IGNvb2tpZSB2YWx1ZTonLCBzZXNzaW9uQ29va2llLnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJylcblxuICAgICAgLy8gVmVyaWZ5IEpXVCB0b2tlblxuICAgICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkoc2Vzc2lvbkNvb2tpZSwgSldUX1NFQ1JFVClcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gcGF5bG9hZCBhcyBhbnkgYXMgU2Vzc2lvbkRhdGFcblxuICAgICAgLy8gQmFzaWMgdmFsaWRhdGlvblxuICAgICAgaWYgKCFzZXNzaW9uRGF0YS5pZCB8fCAhc2Vzc2lvbkRhdGEuZW1haWwpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEludmFsaWQgc2Vzc2lvbiBkYXRhIHN0cnVjdHVyZScpXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiBmb3VuZCBmb3IgdXNlcjonLCBzZXNzaW9uRGF0YS5lbWFpbClcbiAgICAgIHJldHVybiBzZXNzaW9uRGF0YVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBTZXNzaW9uIHJldHJpZXZhbCBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIHRoZSBzZXNzaW9uIGNvb2tpZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGNsZWFyU2Vzc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuICAgIGNvb2tpZVN0b3JlLmRlbGV0ZSh0aGlzLkNPT0tJRV9OQU1FKVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIGV4cGlyZWQgc2Vzc2lvbiBjb29raWUgZnJvbSByZXF1ZXN0XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgY2xlYXJFeHBpcmVkU2Vzc2lvbihyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldCh0aGlzLkNPT0tJRV9OQU1FKT8udmFsdWVcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGp3dFZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVClcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFRva2VuIGlzIGV4cGlyZWQgb3IgaW52YWxpZCwgY2xlYXIgaXRcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnZXhwJykpIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5uZXh0KClcbiAgICAgICAgICByZXNwb25zZS5jb29raWVzLmRlbGV0ZSh0aGlzLkNPT0tJRV9OQU1FKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBzZXNzaW9uIGRhdGEgKHVzZWZ1bCBmb3IgcHJvZmlsZSB1cGRhdGVzKVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHVwZGF0ZVNlc3Npb24odXBkYXRlczogUGFydGlhbDxTZXNzaW9uRGF0YT4pOiBQcm9taXNlPFNlc3Npb25EYXRhIHwgbnVsbD4ge1xuICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gYXdhaXQgdGhpcy5nZXRTZXNzaW9uKClcbiAgICBpZiAoIWN1cnJlbnRTZXNzaW9uKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uID0geyAuLi5jdXJyZW50U2Vzc2lvbiwgLi4udXBkYXRlcyB9XG4gICAgYXdhaXQgdGhpcy5jcmVhdGVTZXNzaW9uKHVwZGF0ZWRTZXNzaW9uKVxuICAgIHJldHVybiB1cGRhdGVkU2Vzc2lvblxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHVzZXIgaGFzIHNwZWNpZmljIHJvbGVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBoYXNSb2xlKHJvbGU6IFNlc3Npb25EYXRhWydyb2xlJ10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgdGhpcy5nZXRTZXNzaW9uKClcbiAgICByZXR1cm4gc2Vzc2lvbj8ucm9sZSA9PT0gcm9sZVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVpcmUgc3BlY2lmaWMgcm9sZSAodGhyb3dzIGlmIG5vdCBhdXRob3JpemVkKVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHJlcXVpcmVSb2xlKHJvbGU6IFNlc3Npb25EYXRhWydyb2xlJ10pOiBQcm9taXNlPFNlc3Npb25EYXRhPiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgaWYgKCFzZXNzaW9uIHx8IHNlc3Npb24ucm9sZSAhPT0gcm9sZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY2Nlc3MgZGVuaWVkLiBSZXF1aXJlZCByb2xlOiAke3JvbGV9YClcbiAgICB9XG4gICAgcmV0dXJuIHNlc3Npb25cbiAgfVxufVxuXG4vKipcbiAqIE1pZGRsZXdhcmUgaGVscGVyIGZvciBBUEkgcm91dGVzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXV0aChyZXF1aXJlZFJvbGU/OiBTZXNzaW9uRGF0YVsncm9sZSddKSB7XG4gIHJldHVybiBhc3luYyAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgU2Vzc2lvbk1hbmFnZXIuZ2V0U2Vzc2lvbkZyb21SZXF1ZXN0KHJlcXVlc3QpXG4gICAgXG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAxIH0pXG4gICAgfVxuXG4gICAgaWYgKHJlcXVpcmVkUm9sZSAmJiBzZXNzaW9uLnJvbGUgIT09IHJlcXVpcmVkUm9sZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGBBY2Nlc3MgZGVuaWVkLiBSZXF1aXJlZCByb2xlOiAke3JlcXVpcmVkUm9sZX1gIH0sIHsgc3RhdHVzOiA0MDMgfSlcbiAgICB9XG5cbiAgICByZXR1cm4geyBzZXNzaW9uIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbIlNpZ25KV1QiLCJqd3RWZXJpZnkiLCJjb29raWVzIiwiTmV4dFJlc3BvbnNlIiwiSldUX1NFQ1JFVCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwicHJvY2VzcyIsImVudiIsIlNlc3Npb25NYW5hZ2VyIiwiQ09PS0lFX05BTUUiLCJNQVhfQUdFIiwiUkVGUkVTSF9XSU5ET1ciLCJHUkFDRV9QRVJJT0QiLCJBQlNPTFVURV9NQVhfQUdFIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb25EYXRhIiwidG9rZW4iLCJzZXRQcm90ZWN0ZWRIZWFkZXIiLCJhbGciLCJzZXRJc3N1ZWRBdCIsInNldEV4cGlyYXRpb25UaW1lIiwic2lnbiIsImNvb2tpZVN0b3JlIiwic2V0IiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJnZXRTZXNzaW9uIiwiZ2V0IiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwic3Vic3RyaW5nIiwicGF5bG9hZCIsImlkIiwiZW1haWwiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJnZXRTZXNzaW9uV2l0aFJlZnJlc2giLCJleHBpcnlUaW1lIiwiZXhwIiwidGltZVVudGlsRXhwaXJ5IiwiRGF0ZSIsIm5vdyIsImRlY29kZWQiLCJKU09OIiwicGFyc2UiLCJCdWZmZXIiLCJmcm9tIiwic3BsaXQiLCJ0b1N0cmluZyIsInRpbWVTaW5jZUV4cGlyeSIsImRlY29kZUVycm9yIiwiZ2V0U2Vzc2lvbkZyb21SZXF1ZXN0IiwicmVxdWVzdCIsInNlc3Npb25Db29raWUiLCJjbGVhclNlc3Npb24iLCJkZWxldGUiLCJjbGVhckV4cGlyZWRTZXNzaW9uIiwiRXJyb3IiLCJyZXNwb25zZSIsIm5leHQiLCJ1cGRhdGVTZXNzaW9uIiwidXBkYXRlcyIsImN1cnJlbnRTZXNzaW9uIiwidXBkYXRlZFNlc3Npb24iLCJoYXNSb2xlIiwicm9sZSIsInNlc3Npb24iLCJyZXF1aXJlUm9sZSIsInJlcXVpcmVBdXRoIiwicmVxdWlyZWRSb2xlIiwianNvbiIsInN0YXR1cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/session-manager.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createServerClient: () => (/* binding */ createServerClient),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\nconst supabaseUrl = \"https://frzciymslvpohhyefmtr.supabase.co\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyenNjaXltc2x2cG9oaHllZm10ciIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzU0NzA4NDgyLCJleHAiOjIwNzAyODQ0ODJ9.y_CSv6rhYngCDvSe9Z6NuEPzPLgBV_huXq5f3WbGiLM\" || 0;\n// Client-side Supabase client with real-time disabled to prevent WebSocket errors\nconst supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createBrowserClient)(supabaseUrl, supabaseAnonKey, {\n    realtime: {\n        enabled: false\n    }\n});\n// Server-side Supabase client with service role key\nconst createServerClient = ()=>{\n    const serverSupabaseUrl = \"https://frzciymslvpohhyefmtr.supabase.co\" || 0;\n    // Use anon key as fallback if service role key is invalid\n    const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    const anonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyenNjaXltc2x2cG9oaHllZm10ciIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzU0NzA4NDgyLCJleHAiOjIwNzAyODQ0ODJ9.y_CSv6rhYngCDvSe9Z6NuEPzPLgBV_huXq5f3WbGiLM\" || 0;\n    console.log('🔍 createServerClient: Service role key exists:', !!serviceRoleKey);\n    console.log('🔍 createServerClient: Service role key length:', serviceRoleKey?.length);\n    console.log('🔍 createServerClient: Anon key length:', anonKey?.length);\n    // Use service role key if available, otherwise fallback to anon key\n    const serverSupabaseKey = serviceRoleKey || anonKey;\n    console.log('🔍 createServerClient: Using key type:', serviceRoleKey ? 'service_role' : 'anon');\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(serverSupabaseUrl, serverSupabaseKey, {\n        auth: {\n            persistSession: false\n        }\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFvRDtBQUNEO0FBRW5ELE1BQU1FLGNBQWNDLDBDQUFvQyxJQUFJLENBQUU7QUFDOUQsTUFBTUcsa0JBQWtCSCxtTkFBeUMsSUFBSSxDQUFFO0FBRXZFLGtGQUFrRjtBQUMzRSxNQUFNSyxXQUFXUCxrRUFBbUJBLENBQUNDLGFBQWFJLGlCQUFpQjtJQUN4RUcsVUFBVTtRQUNSQyxTQUFTO0lBQ1g7QUFDRixHQUFFO0FBRUYsb0RBQW9EO0FBQzdDLE1BQU1DLHFCQUFxQjtJQUNoQyxNQUFNQyxvQkFBb0JULDBDQUFvQyxJQUFJLENBQTBDO0lBRTVHLDBEQUEwRDtJQUMxRCxNQUFNVSxpQkFBaUJWLFFBQVFDLEdBQUcsQ0FBQ1UseUJBQXlCO0lBQzVELE1BQU1DLFVBQVVaLG1OQUF5QyxJQUFJLENBQUU7SUFFL0RhLFFBQVFDLEdBQUcsQ0FBQyxtREFBbUQsQ0FBQyxDQUFDSjtJQUNqRUcsUUFBUUMsR0FBRyxDQUFDLG1EQUFtREosZ0JBQWdCSztJQUMvRUYsUUFBUUMsR0FBRyxDQUFDLDJDQUEyQ0YsU0FBU0c7SUFFaEUsb0VBQW9FO0lBQ3BFLE1BQU1DLG9CQUFvQk4sa0JBQWtCRTtJQUU1Q0MsUUFBUUMsR0FBRyxDQUFDLDBDQUEwQ0osaUJBQWlCLGlCQUFpQjtJQUV4RixPQUFPYixtRUFBWUEsQ0FBQ1ksbUJBQW1CTyxtQkFBbUI7UUFDeERDLE1BQU07WUFDSkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFDRixFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvbWFjYm9vay9EZXNrdG9wL3RycGktYXBwL2xpYi9zdXBhYmFzZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCJcbmltcG9ydCB7IGNyZWF0ZUJyb3dzZXJDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3NzclwiXG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICcnXG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAnJ1xuXG4vLyBDbGllbnQtc2lkZSBTdXBhYmFzZSBjbGllbnQgd2l0aCByZWFsLXRpbWUgZGlzYWJsZWQgdG8gcHJldmVudCBXZWJTb2NrZXQgZXJyb3JzXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVCcm93c2VyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXksIHtcbiAgcmVhbHRpbWU6IHtcbiAgICBlbmFibGVkOiBmYWxzZVxuICB9XG59KVxuXG4vLyBTZXJ2ZXItc2lkZSBTdXBhYmFzZSBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUga2V5XG5leHBvcnQgY29uc3QgY3JlYXRlU2VydmVyQ2xpZW50ID0gKCkgPT4ge1xuICBjb25zdCBzZXJ2ZXJTdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnaHR0cHM6Ly9mcnpjaXltc2x2cG9oaHllZm10ci5zdXBhYmFzZS5jbydcbiAgXG4gIC8vIFVzZSBhbm9uIGtleSBhcyBmYWxsYmFjayBpZiBzZXJ2aWNlIHJvbGUga2V5IGlzIGludmFsaWRcbiAgY29uc3Qgc2VydmljZVJvbGVLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZXG4gIGNvbnN0IGFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAnJ1xuICBcbiAgY29uc29sZS5sb2coJ/CflI0gY3JlYXRlU2VydmVyQ2xpZW50OiBTZXJ2aWNlIHJvbGUga2V5IGV4aXN0czonLCAhIXNlcnZpY2VSb2xlS2V5KVxuICBjb25zb2xlLmxvZygn8J+UjSBjcmVhdGVTZXJ2ZXJDbGllbnQ6IFNlcnZpY2Ugcm9sZSBrZXkgbGVuZ3RoOicsIHNlcnZpY2VSb2xlS2V5Py5sZW5ndGgpXG4gIGNvbnNvbGUubG9nKCfwn5SNIGNyZWF0ZVNlcnZlckNsaWVudDogQW5vbiBrZXkgbGVuZ3RoOicsIGFub25LZXk/Lmxlbmd0aClcbiAgXG4gIC8vIFVzZSBzZXJ2aWNlIHJvbGUga2V5IGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGZhbGxiYWNrIHRvIGFub24ga2V5XG4gIGNvbnN0IHNlcnZlclN1cGFiYXNlS2V5ID0gc2VydmljZVJvbGVLZXkgfHwgYW5vbktleVxuICBcbiAgY29uc29sZS5sb2coJ/CflI0gY3JlYXRlU2VydmVyQ2xpZW50OiBVc2luZyBrZXkgdHlwZTonLCBzZXJ2aWNlUm9sZUtleSA/ICdzZXJ2aWNlX3JvbGUnIDogJ2Fub24nKVxuICBcbiAgcmV0dXJuIGNyZWF0ZUNsaWVudChzZXJ2ZXJTdXBhYmFzZVVybCwgc2VydmVyU3VwYWJhc2VLZXksIHtcbiAgICBhdXRoOiB7XG4gICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsXG4gICAgfSxcbiAgfSlcbn1cblxuLy8gRGF0YWJhc2UgdHlwZXMgKHdpbGwgYmUgZ2VuZXJhdGVkIGZyb20gU3VwYWJhc2UpXG5leHBvcnQgaW50ZXJmYWNlIERhdGFiYXNlIHtcbiAgcHVibGljOiB7XG4gICAgVGFibGVzOiB7XG4gICAgICB1c2Vyczoge1xuICAgICAgICBSb3c6IHtcbiAgICAgICAgICBpZDogc3RyaW5nXG4gICAgICAgICAgZW1haWw6IHN0cmluZ1xuICAgICAgICAgIGZ1bGxfbmFtZTogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIHVzZXJfdHlwZTogXCJpbmRpdmlkdWFsXCIgfCBcInBhcnRuZXJcIiB8IFwidGhlcmFwaXN0XCIgfCBcImFkbWluXCJcbiAgICAgICAgICBwYXJ0bmVyX2lkOiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgY3JlYXRlZF9hdDogc3RyaW5nXG4gICAgICAgICAgdXBkYXRlZF9hdDogc3RyaW5nXG4gICAgICAgICAgaXNfdmVyaWZpZWQ6IGJvb2xlYW5cbiAgICAgICAgICBpc19hY3RpdmU6IGJvb2xlYW5cbiAgICAgICAgfVxuICAgICAgICBJbnNlcnQ6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIGVtYWlsOiBzdHJpbmdcbiAgICAgICAgICBmdWxsX25hbWU/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgdXNlcl90eXBlOiBcImluZGl2aWR1YWxcIiB8IFwicGFydG5lclwiIHwgXCJ0aGVyYXBpc3RcIiB8IFwiYWRtaW5cIlxuICAgICAgICAgIHBhcnRuZXJfaWQ/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICBpc192ZXJpZmllZD86IGJvb2xlYW5cbiAgICAgICAgICBpc19hY3RpdmU/OiBib29sZWFuXG4gICAgICAgIH1cbiAgICAgICAgVXBkYXRlOiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICBlbWFpbD86IHN0cmluZ1xuICAgICAgICAgIGZ1bGxfbmFtZT86IHN0cmluZyB8IG51bGxcbiAgICAgICAgICB1c2VyX3R5cGU/OiBcImluZGl2aWR1YWxcIiB8IFwicGFydG5lclwiIHwgXCJ0aGVyYXBpc3RcIiB8IFwiYWRtaW5cIlxuICAgICAgICAgIHBhcnRuZXJfaWQ/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICBpc192ZXJpZmllZD86IGJvb2xlYW5cbiAgICAgICAgICBpc19hY3RpdmU/OiBib29sZWFuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoZXJhcGlzdHM6IHtcbiAgICAgICAgUm93OiB7XG4gICAgICAgICAgaWQ6IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ6IHN0cmluZ1xuICAgICAgICAgIHNwZWNpYWxpemF0aW9uOiBzdHJpbmdcbiAgICAgICAgICBtZGNuX2NvZGU6IHN0cmluZ1xuICAgICAgICAgIGV4cGVyaWVuY2VfeWVhcnM6IG51bWJlclxuICAgICAgICAgIGJpbzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGhvdXJseV9yYXRlOiBudW1iZXJcbiAgICAgICAgICBpc192ZXJpZmllZDogYm9vbGVhblxuICAgICAgICAgIHZlcmlmaWNhdGlvbl9zdGF0dXM6IFwicGVuZGluZ1wiIHwgXCJhcHByb3ZlZFwiIHwgXCJyZWplY3RlZFwiXG4gICAgICAgICAgY3JlYXRlZF9hdDogc3RyaW5nXG4gICAgICAgICAgdXBkYXRlZF9hdDogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgSW5zZXJ0OiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB1c2VyX2lkOiBzdHJpbmdcbiAgICAgICAgICBzcGVjaWFsaXphdGlvbjogc3RyaW5nXG4gICAgICAgICAgbWRjbl9jb2RlOiBzdHJpbmdcbiAgICAgICAgICBleHBlcmllbmNlX3llYXJzOiBudW1iZXJcbiAgICAgICAgICBiaW8/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgaG91cmx5X3JhdGU6IG51bWJlclxuICAgICAgICAgIGlzX3ZlcmlmaWVkPzogYm9vbGVhblxuICAgICAgICAgIHZlcmlmaWNhdGlvbl9zdGF0dXM/OiBcInBlbmRpbmdcIiB8IFwiYXBwcm92ZWRcIiB8IFwicmVqZWN0ZWRcIlxuICAgICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICB1cGRhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgVXBkYXRlOiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB1c2VyX2lkPzogc3RyaW5nXG4gICAgICAgICAgc3BlY2lhbGl6YXRpb24/OiBzdHJpbmdcbiAgICAgICAgICBtZGNuX2NvZGU/OiBzdHJpbmdcbiAgICAgICAgICBleHBlcmllbmNlX3llYXJzPzogbnVtYmVyXG4gICAgICAgICAgYmlvPzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGhvdXJseV9yYXRlPzogbnVtYmVyXG4gICAgICAgICAgaXNfdmVyaWZpZWQ/OiBib29sZWFuXG4gICAgICAgICAgdmVyaWZpY2F0aW9uX3N0YXR1cz86IFwicGVuZGluZ1wiIHwgXCJhcHByb3ZlZFwiIHwgXCJyZWplY3RlZFwiXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcGFydG5lcnM6IHtcbiAgICAgICAgUm93OiB7XG4gICAgICAgICAgaWQ6IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ6IHN0cmluZ1xuICAgICAgICAgIG9yZ2FuaXphdGlvbl9uYW1lOiBzdHJpbmdcbiAgICAgICAgICBvcmdhbml6YXRpb25fdHlwZTogXCJob3NwaXRhbFwiIHwgXCJjbGluaWNcIiB8IFwibmdvXCIgfCBcInNjaG9vbFwiIHwgXCJjb3Jwb3JhdGVcIiB8IFwiZ292ZXJubWVudFwiXG4gICAgICAgICAgY29udGFjdF9wZXJzb246IHN0cmluZ1xuICAgICAgICAgIHBob25lOiBzdHJpbmdcbiAgICAgICAgICBhZGRyZXNzOiBzdHJpbmdcbiAgICAgICAgICB3ZWJzaXRlOiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgaXNfdmVyaWZpZWQ6IGJvb2xlYW5cbiAgICAgICAgICB2ZXJpZmljYXRpb25fc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwiYXBwcm92ZWRcIiB8IFwicmVqZWN0ZWRcIlxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ6IHN0cmluZ1xuICAgICAgICB9XG4gICAgICAgIEluc2VydDoge1xuICAgICAgICAgIGlkPzogc3RyaW5nXG4gICAgICAgICAgdXNlcl9pZDogc3RyaW5nXG4gICAgICAgICAgb3JnYW5pemF0aW9uX25hbWU6IHN0cmluZ1xuICAgICAgICAgIG9yZ2FuaXphdGlvbl90eXBlOiBcImhvc3BpdGFsXCIgfCBcImNsaW5pY1wiIHwgXCJuZ29cIiB8IFwic2Nob29sXCIgfCBcImNvcnBvcmF0ZVwiIHwgXCJnb3Zlcm5tZW50XCJcbiAgICAgICAgICBjb250YWN0X3BlcnNvbjogc3RyaW5nXG4gICAgICAgICAgcGhvbmU6IHN0cmluZ1xuICAgICAgICAgIGFkZHJlc3M6IHN0cmluZ1xuICAgICAgICAgIHdlYnNpdGU/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgaXNfdmVyaWZpZWQ/OiBib29sZWFuXG4gICAgICAgICAgdmVyaWZpY2F0aW9uX3N0YXR1cz86IFwicGVuZGluZ1wiIHwgXCJhcHByb3ZlZFwiIHwgXCJyZWplY3RlZFwiXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgICBVcGRhdGU6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ/OiBzdHJpbmdcbiAgICAgICAgICBvcmdhbml6YXRpb25fbmFtZT86IHN0cmluZ1xuICAgICAgICAgIG9yZ2FuaXphdGlvbl90eXBlPzogXCJob3NwaXRhbFwiIHwgXCJjbGluaWNcIiB8IFwibmdvXCIgfCBcInNjaG9vbFwiIHwgXCJjb3Jwb3JhdGVcIiB8IFwiZ292ZXJubWVudFwiXG4gICAgICAgICAgY29udGFjdF9wZXJzb24/OiBzdHJpbmdcbiAgICAgICAgICBwaG9uZT86IHN0cmluZ1xuICAgICAgICAgIGFkZHJlc3M/OiBzdHJpbmdcbiAgICAgICAgICB3ZWJzaXRlPzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGlzX3ZlcmlmaWVkPzogYm9vbGVhblxuICAgICAgICAgIHZlcmlmaWNhdGlvbl9zdGF0dXM/OiBcInBlbmRpbmdcIiB8IFwiYXBwcm92ZWRcIiB8IFwicmVqZWN0ZWRcIlxuICAgICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICB1cGRhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNlc3Npb25zOiB7XG4gICAgICAgIFJvdzoge1xuICAgICAgICAgIGlkOiBzdHJpbmdcbiAgICAgICAgICBjbGllbnRfaWQ6IHN0cmluZ1xuICAgICAgICAgIHRoZXJhcGlzdF9pZDogc3RyaW5nXG4gICAgICAgICAgcGFydG5lcl9pZDogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIHNlc3Npb25fZGF0ZTogc3RyaW5nXG4gICAgICAgICAgc3RhcnRfdGltZTogc3RyaW5nXG4gICAgICAgICAgZW5kX3RpbWU6IHN0cmluZ1xuICAgICAgICAgIGR1cmF0aW9uX21pbnV0ZXM6IG51bWJlclxuICAgICAgICAgIHNlc3Npb25fdHlwZTogc3RyaW5nXG4gICAgICAgICAgc3RhdHVzOiBcInNjaGVkdWxlZFwiIHwgXCJjb21wbGV0ZWRcIiB8IFwiY2FuY2VsbGVkXCIgfCBcIm5vX3Nob3dcIlxuICAgICAgICAgIGFtb3VudDogbnVtYmVyXG4gICAgICAgICAgcGF5bWVudF9zdGF0dXM6IFwicGVuZGluZ1wiIHwgXCJwYWlkXCIgfCBcInJlZnVuZGVkXCJcbiAgICAgICAgICBub3Rlczogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ6IHN0cmluZ1xuICAgICAgICB9XG4gICAgICAgIEluc2VydDoge1xuICAgICAgICAgIGlkPzogc3RyaW5nXG4gICAgICAgICAgY2xpZW50X2lkOiBzdHJpbmdcbiAgICAgICAgICB0aGVyYXBpc3RfaWQ6IHN0cmluZ1xuICAgICAgICAgIHBhcnRuZXJfaWQ/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgc2Vzc2lvbl9kYXRlOiBzdHJpbmdcbiAgICAgICAgICBzdGFydF90aW1lOiBzdHJpbmdcbiAgICAgICAgICBlbmRfdGltZTogc3RyaW5nXG4gICAgICAgICAgZHVyYXRpb25fbWludXRlczogbnVtYmVyXG4gICAgICAgICAgc2Vzc2lvbl90eXBlOiBzdHJpbmdcbiAgICAgICAgICBzdGF0dXM/OiBcInNjaGVkdWxlZFwiIHwgXCJjb21wbGV0ZWRcIiB8IFwiY2FuY2VsbGVkXCIgfCBcIm5vX3Nob3dcIlxuICAgICAgICAgIGFtb3VudDogbnVtYmVyXG4gICAgICAgICAgcGF5bWVudF9zdGF0dXM/OiBcInBlbmRpbmdcIiB8IFwicGFpZFwiIHwgXCJyZWZ1bmRlZFwiXG4gICAgICAgICAgbm90ZXM/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgICBVcGRhdGU6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIGNsaWVudF9pZD86IHN0cmluZ1xuICAgICAgICAgIHRoZXJhcGlzdF9pZD86IHN0cmluZ1xuICAgICAgICAgIHBhcnRuZXJfaWQ/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgc2Vzc2lvbl9kYXRlPzogc3RyaW5nXG4gICAgICAgICAgc3RhcnRfdGltZT86IHN0cmluZ1xuICAgICAgICAgIGVuZF90aW1lPzogc3RyaW5nXG4gICAgICAgICAgZHVyYXRpb25fbWludXRlcz86IG51bWJlclxuICAgICAgICAgIHNlc3Npb25fdHlwZT86IHN0cmluZ1xuICAgICAgICAgIHN0YXR1cz86IFwic2NoZWR1bGVkXCIgfCBcImNvbXBsZXRlZFwiIHwgXCJjYW5jZWxsZWRcIiB8IFwibm9fc2hvd1wiXG4gICAgICAgICAgYW1vdW50PzogbnVtYmVyXG4gICAgICAgICAgcGF5bWVudF9zdGF0dXM/OiBcInBlbmRpbmdcIiB8IFwicGFpZFwiIHwgXCJyZWZ1bmRlZFwiXG4gICAgICAgICAgbm90ZXM/OiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcGF5bWVudHM6IHtcbiAgICAgICAgUm93OiB7XG4gICAgICAgICAgaWQ6IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ6IHN0cmluZ1xuICAgICAgICAgIHNlc3Npb25faWQ6IHN0cmluZyB8IG51bGxcbiAgICAgICAgICBhbW91bnQ6IG51bWJlclxuICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiBcInBheXN0YWNrXCIgfCBcImNyZWRpdHNcIiB8IFwiYmFua190cmFuc2ZlclwiXG4gICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwiY29tcGxldGVkXCIgfCBcImZhaWxlZFwiIHwgXCJyZWZ1bmRlZFwiXG4gICAgICAgICAgcmVmZXJlbmNlOiBzdHJpbmdcbiAgICAgICAgICBjcmVkaXRzX3B1cmNoYXNlZDogbnVtYmVyXG4gICAgICAgICAgY3JlYXRlZF9hdDogc3RyaW5nXG4gICAgICAgICAgdXBkYXRlZF9hdDogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgSW5zZXJ0OiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB1c2VyX2lkOiBzdHJpbmdcbiAgICAgICAgICBzZXNzaW9uX2lkPzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGFtb3VudDogbnVtYmVyXG4gICAgICAgICAgcGF5bWVudF9tZXRob2Q6IFwicGF5c3RhY2tcIiB8IFwiY3JlZGl0c1wiIHwgXCJiYW5rX3RyYW5zZmVyXCJcbiAgICAgICAgICBzdGF0dXM/OiBcInBlbmRpbmdcIiB8IFwiY29tcGxldGVkXCIgfCBcImZhaWxlZFwiIHwgXCJyZWZ1bmRlZFwiXG4gICAgICAgICAgcmVmZXJlbmNlOiBzdHJpbmdcbiAgICAgICAgICBjcmVkaXRzX3B1cmNoYXNlZDogbnVtYmVyXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgICBVcGRhdGU6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ/OiBzdHJpbmdcbiAgICAgICAgICBzZXNzaW9uX2lkPzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIGFtb3VudD86IG51bWJlclxuICAgICAgICAgIHBheW1lbnRfbWV0aG9kPzogXCJwYXlzdGFja1wiIHwgXCJjcmVkaXRzXCIgfCBcImJhbmtfdHJhbnNmZXJcIlxuICAgICAgICAgIHN0YXR1cz86IFwicGVuZGluZ1wiIHwgXCJjb21wbGV0ZWRcIiB8IFwiZmFpbGVkXCIgfCBcInJlZnVuZGVkXCJcbiAgICAgICAgICByZWZlcmVuY2U/OiBzdHJpbmdcbiAgICAgICAgICBjcmVkaXRzX3B1cmNoYXNlZD86IG51bWJlclxuICAgICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICB1cGRhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNyZWRpdHM6IHtcbiAgICAgICAgUm93OiB7XG4gICAgICAgICAgaWQ6IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ6IHN0cmluZ1xuICAgICAgICAgIGNyZWRpdHNfYmFsYW5jZTogbnVtYmVyXG4gICAgICAgICAgY3JlZGl0c191c2VkOiBudW1iZXJcbiAgICAgICAgICBjcmVkaXRzX3B1cmNoYXNlZDogbnVtYmVyXG4gICAgICAgICAgbGFzdF91cGRhdGVkOiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgICBJbnNlcnQ6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIHVzZXJfaWQ6IHN0cmluZ1xuICAgICAgICAgIGNyZWRpdHNfYmFsYW5jZT86IG51bWJlclxuICAgICAgICAgIGNyZWRpdHNfdXNlZD86IG51bWJlclxuICAgICAgICAgIGNyZWRpdHNfcHVyY2hhc2VkPzogbnVtYmVyXG4gICAgICAgICAgbGFzdF91cGRhdGVkPzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgVXBkYXRlOiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB1c2VyX2lkPzogc3RyaW5nXG4gICAgICAgICAgY3JlZGl0c19iYWxhbmNlPzogbnVtYmVyXG4gICAgICAgICAgY3JlZGl0c191c2VkPzogbnVtYmVyXG4gICAgICAgICAgY3JlZGl0c19wdXJjaGFzZWQ/OiBudW1iZXJcbiAgICAgICAgICBsYXN0X3VwZGF0ZWQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhlcmFwaXN0X2F2YWlsYWJpbGl0eToge1xuICAgICAgICBSb3c6IHtcbiAgICAgICAgICBpZDogc3RyaW5nXG4gICAgICAgICAgdGhlcmFwaXN0X2lkOiBzdHJpbmdcbiAgICAgICAgICBkYXlfb2Zfd2VlazogbnVtYmVyXG4gICAgICAgICAgc3RhcnRfdGltZTogc3RyaW5nXG4gICAgICAgICAgZW5kX3RpbWU6IHN0cmluZ1xuICAgICAgICAgIGlzX2F2YWlsYWJsZTogYm9vbGVhblxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IHN0cmluZ1xuICAgICAgICB9XG4gICAgICAgIEluc2VydDoge1xuICAgICAgICAgIGlkPzogc3RyaW5nXG4gICAgICAgICAgdGhlcmFwaXN0X2lkOiBzdHJpbmdcbiAgICAgICAgICBkYXlfb2Zfd2VlazogbnVtYmVyXG4gICAgICAgICAgc3RhcnRfdGltZTogc3RyaW5nXG4gICAgICAgICAgZW5kX3RpbWU6IHN0cmluZ1xuICAgICAgICAgIGlzX2F2YWlsYWJsZT86IGJvb2xlYW5cbiAgICAgICAgICBjcmVhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgVXBkYXRlOiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB0aGVyYXBpc3RfaWQ/OiBzdHJpbmdcbiAgICAgICAgICBkYXlfb2Zfd2Vlaz86IG51bWJlclxuICAgICAgICAgIHN0YXJ0X3RpbWU/OiBzdHJpbmdcbiAgICAgICAgICBlbmRfdGltZT86IHN0cmluZ1xuICAgICAgICAgIGlzX2F2YWlsYWJsZT86IGJvb2xlYW5cbiAgICAgICAgICBjcmVhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgUm93OiB7XG4gICAgICAgICAgaWQ6IHN0cmluZ1xuICAgICAgICAgIHRpdGxlOiBzdHJpbmdcbiAgICAgICAgICBjb250ZW50X3R5cGU6IFwiYXJ0aWNsZVwiIHwgXCJ2aWRlb1wiIHwgXCJpbWFnZVwiXG4gICAgICAgICAgY2F0ZWdvcnk6IHN0cmluZ1xuICAgICAgICAgIGF1dGhvcl9pZDogc3RyaW5nXG4gICAgICAgICAgY29udGVudDogc3RyaW5nXG4gICAgICAgICAgc3RhdHVzOiBcImRyYWZ0XCIgfCBcInB1Ymxpc2hlZFwiIHwgXCJhcmNoaXZlZFwiXG4gICAgICAgICAgdmlld3M6IG51bWJlclxuICAgICAgICAgIHRhZ3M6IHN0cmluZ1tdXG4gICAgICAgICAgY3JlYXRlZF9hdDogc3RyaW5nXG4gICAgICAgICAgdXBkYXRlZF9hdDogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgSW5zZXJ0OiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB0aXRsZTogc3RyaW5nXG4gICAgICAgICAgY29udGVudF90eXBlOiBcImFydGljbGVcIiB8IFwidmlkZW9cIiB8IFwiaW1hZ2VcIlxuICAgICAgICAgIGNhdGVnb3J5OiBzdHJpbmdcbiAgICAgICAgICBhdXRob3JfaWQ6IHN0cmluZ1xuICAgICAgICAgIGNvbnRlbnQ6IHN0cmluZ1xuICAgICAgICAgIHN0YXR1cz86IFwiZHJhZnRcIiB8IFwicHVibGlzaGVkXCIgfCBcImFyY2hpdmVkXCJcbiAgICAgICAgICB2aWV3cz86IG51bWJlclxuICAgICAgICAgIHRhZ3M/OiBzdHJpbmdbXVxuICAgICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgICB1cGRhdGVkX2F0Pzogc3RyaW5nXG4gICAgICAgIH1cbiAgICAgICAgVXBkYXRlOiB7XG4gICAgICAgICAgaWQ/OiBzdHJpbmdcbiAgICAgICAgICB0aXRsZT86IHN0cmluZ1xuICAgICAgICAgIGNvbnRlbnRfdHlwZT86IFwiYXJ0aWNsZVwiIHwgXCJ2aWRlb1wiIHwgXCJpbWFnZVwiXG4gICAgICAgICAgY2F0ZWdvcnk/OiBzdHJpbmdcbiAgICAgICAgICBhdXRob3JfaWQ/OiBzdHJpbmdcbiAgICAgICAgICBjb250ZW50Pzogc3RyaW5nXG4gICAgICAgICAgc3RhdHVzPzogXCJkcmFmdFwiIHwgXCJwdWJsaXNoZWRcIiB8IFwiYXJjaGl2ZWRcIlxuICAgICAgICAgIHZpZXdzPzogbnVtYmVyXG4gICAgICAgICAgdGFncz86IHN0cmluZ1tdXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYWRtaW5fbG9nczoge1xuICAgICAgICBSb3c6IHtcbiAgICAgICAgICBpZDogc3RyaW5nXG4gICAgICAgICAgYWRtaW5faWQ6IHN0cmluZ1xuICAgICAgICAgIGFjdGlvbjogc3RyaW5nXG4gICAgICAgICAgdGFibGVfbmFtZTogc3RyaW5nXG4gICAgICAgICAgcmVjb3JkX2lkOiBzdHJpbmcgfCBudWxsXG4gICAgICAgICAgb2xkX3ZhbHVlczogYW55IHwgbnVsbFxuICAgICAgICAgIG5ld192YWx1ZXM6IGFueSB8IG51bGxcbiAgICAgICAgICBpcF9hZGRyZXNzOiBzdHJpbmdcbiAgICAgICAgICB1c2VyX2FnZW50OiBzdHJpbmdcbiAgICAgICAgICBjcmVhdGVkX2F0OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgICBJbnNlcnQ6IHtcbiAgICAgICAgICBpZD86IHN0cmluZ1xuICAgICAgICAgIGFkbWluX2lkOiBzdHJpbmdcbiAgICAgICAgICBhY3Rpb246IHN0cmluZ1xuICAgICAgICAgIHRhYmxlX25hbWU6IHN0cmluZ1xuICAgICAgICAgIHJlY29yZF9pZD86IHN0cmluZyB8IG51bGxcbiAgICAgICAgICBvbGRfdmFsdWVzPzogYW55IHwgbnVsbFxuICAgICAgICAgIG5ld192YWx1ZXM/OiBhbnkgfCBudWxsXG4gICAgICAgICAgaXBfYWRkcmVzczogc3RyaW5nXG4gICAgICAgICAgdXNlcl9hZ2VudDogc3RyaW5nXG4gICAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICAgICAgICB9XG4gICAgICAgIFVwZGF0ZToge1xuICAgICAgICAgIGlkPzogc3RyaW5nXG4gICAgICAgICAgYWRtaW5faWQ/OiBzdHJpbmdcbiAgICAgICAgICBhY3Rpb24/OiBzdHJpbmdcbiAgICAgICAgICB0YWJsZV9uYW1lPzogc3RyaW5nXG4gICAgICAgICAgcmVjb3JkX2lkPzogc3RyaW5nIHwgbnVsbFxuICAgICAgICAgIG9sZF92YWx1ZXM/OiBhbnkgfCBudWxsXG4gICAgICAgICAgbmV3X3ZhbHVlcz86IGFueSB8IG51bGxcbiAgICAgICAgICBpcF9hZGRyZXNzPzogc3RyaW5nXG4gICAgICAgICAgdXNlcl9hZ2VudD86IHN0cmluZ1xuICAgICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBWaWV3czoge1xuICAgICAgW18gaW4gbmV2ZXJdOiBuZXZlclxuICAgIH1cbiAgICBGdW5jdGlvbnM6IHtcbiAgICAgIFtfIGluIG5ldmVyXTogbmV2ZXJcbiAgICB9XG4gICAgRW51bXM6IHtcbiAgICAgIFtfIGluIG5ldmVyXTogbmV2ZXJcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJjcmVhdGVCcm93c2VyQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VBbm9uS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSIsInJlYWx0aW1lIiwiZW5hYmxlZCIsImNyZWF0ZVNlcnZlckNsaWVudCIsInNlcnZlclN1cGFiYXNlVXJsIiwic2VydmljZVJvbGVLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYW5vbktleSIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJzZXJ2ZXJTdXBhYmFzZUtleSIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&page=%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute.ts&appDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&page=%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute.ts&appDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_macbook_Desktop_trpi_app_app_api_therapist_availability_template_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/therapist/availability/template/route.ts */ \"(rsc)/./app/api/therapist/availability/template/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/therapist/availability/template/route\",\n        pathname: \"/api/therapist/availability/template\",\n        filename: \"route\",\n        bundlePath: \"app/api/therapist/availability/template/route\"\n    },\n    resolvedPagePath: \"/Users/macbook/Desktop/trpi-app/app/api/therapist/availability/template/route.ts\",\n    nextConfigOutput,\n    userland: _Users_macbook_Desktop_trpi_app_app_api_therapist_availability_template_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZ0aGVyYXBpc3QlMkZhdmFpbGFiaWxpdHklMkZ0ZW1wbGF0ZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGdGhlcmFwaXN0JTJGYXZhaWxhYmlsaXR5JTJGdGVtcGxhdGUlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ0aGVyYXBpc3QlMkZhdmFpbGFiaWxpdHklMkZ0ZW1wbGF0ZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1hY2Jvb2slMkZEZXNrdG9wJTJGdHJwaS1hcHAlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbWFjYm9vayUyRkRlc2t0b3AlMkZ0cnBpLWFwcCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2dDO0FBQzdHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvbWFjYm9vay9EZXNrdG9wL3RycGktYXBwL2FwcC9hcGkvdGhlcmFwaXN0L2F2YWlsYWJpbGl0eS90ZW1wbGF0ZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RoZXJhcGlzdC9hdmFpbGFiaWxpdHkvdGVtcGxhdGUvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90aGVyYXBpc3QvYXZhaWxhYmlsaXR5L3RlbXBsYXRlXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS90aGVyYXBpc3QvYXZhaWxhYmlsaXR5L3RlbXBsYXRlL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL21hY2Jvb2svRGVza3RvcC90cnBpLWFwcC9hcHAvYXBpL3RoZXJhcGlzdC9hdmFpbGFiaWxpdHkvdGVtcGxhdGUvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&page=%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute.ts&appDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./types/availability.ts":
/*!*******************************!*\
  !*** ./types/availability.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DAYS_OF_WEEK: () => (/* binding */ DAYS_OF_WEEK),\n/* harmony export */   DEFAULT_DAY_AVAILABILITY: () => (/* binding */ DEFAULT_DAY_AVAILABILITY),\n/* harmony export */   DEFAULT_SESSION_DURATIONS: () => (/* binding */ DEFAULT_SESSION_DURATIONS),\n/* harmony export */   DEFAULT_TIME_SLOT: () => (/* binding */ DEFAULT_TIME_SLOT),\n/* harmony export */   DEFAULT_WEEKLY_AVAILABILITY: () => (/* binding */ DEFAULT_WEEKLY_AVAILABILITY),\n/* harmony export */   OVERRIDE_TYPES: () => (/* binding */ OVERRIDE_TYPES),\n/* harmony export */   SESSION_TYPES: () => (/* binding */ SESSION_TYPES)\n/* harmony export */ });\n/**\n * Enhanced 3-Level Availability System Types\n * \n * This file defines the TypeScript interfaces for the comprehensive availability system\n * that supports weekly templates, specific date overrides, and real-time availability.\n */ // ============================================================================\n// CORE AVAILABILITY TYPES\n// ============================================================================\n// ============================================================================\n// CONSTANTS\n// ============================================================================\nconst DAYS_OF_WEEK = [\n    'sunday',\n    'monday',\n    'tuesday',\n    'wednesday',\n    'thursday',\n    'friday',\n    'saturday'\n];\nconst SESSION_TYPES = [\n    'individual',\n    'group',\n    'consultation'\n];\nconst OVERRIDE_TYPES = [\n    'unavailable',\n    'custom_hours',\n    'reduced_hours'\n];\nconst DEFAULT_SESSION_DURATIONS = [\n    30,\n    45,\n    60,\n    90,\n    120\n];\nconst DEFAULT_TIME_SLOT = {\n    id: '',\n    start: '09:00',\n    end: '10:00',\n    duration: 60,\n    type: 'individual',\n    maxSessions: 1,\n    title: 'Individual Therapy Session',\n    isAvailable: true\n};\nconst DEFAULT_DAY_AVAILABILITY = {\n    enabled: false,\n    customSlots: [],\n    timeSlots: [],\n    breaks: [],\n    notes: ''\n};\nconst DEFAULT_WEEKLY_AVAILABILITY = {\n    standardHours: {\n        monday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: true\n        },\n        tuesday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: true\n        },\n        wednesday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: true\n        },\n        thursday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: true\n        },\n        friday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: true\n        },\n        saturday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: false\n        },\n        sunday: {\n            ...DEFAULT_DAY_AVAILABILITY,\n            enabled: false\n        }\n    },\n    sessionSettings: {\n        sessionDuration: 60,\n        bufferTime: 15,\n        maxSessionsPerDay: 8,\n        advanceBookingDays: 30,\n        cancellationHours: 24\n    },\n    timezone: 'UTC',\n    lastUpdated: new Date().toISOString()\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi90eXBlcy9hdmFpbGFiaWxpdHkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7OztDQUtDLEdBRUQsK0VBQStFO0FBQy9FLDBCQUEwQjtBQUMxQiwrRUFBK0U7QUErTy9FLCtFQUErRTtBQUMvRSxZQUFZO0FBQ1osK0VBQStFO0FBRXhFLE1BQU1BLGVBQWU7SUFDMUI7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRCxDQUFVO0FBRUosTUFBTUMsZ0JBQWdCO0lBQzNCO0lBQ0E7SUFDQTtDQUNELENBQVU7QUFFSixNQUFNQyxpQkFBaUI7SUFDNUI7SUFDQTtJQUNBO0NBQ0QsQ0FBVTtBQUVKLE1BQU1DLDRCQUE0QjtJQUFDO0lBQUk7SUFBSTtJQUFJO0lBQUk7Q0FBSSxDQUFVO0FBRWpFLE1BQU1DLG9CQUE4QjtJQUN6Q0MsSUFBSTtJQUNKQyxPQUFPO0lBQ1BDLEtBQUs7SUFDTEMsVUFBVTtJQUNWQyxNQUFNO0lBQ05DLGFBQWE7SUFDYkMsT0FBTztJQUNQQyxhQUFhO0FBQ2YsRUFBRTtBQUVLLE1BQU1DLDJCQUE0QztJQUN2REMsU0FBUztJQUNUQyxhQUFhLEVBQUU7SUFDZkMsV0FBVyxFQUFFO0lBQ2JDLFFBQVEsRUFBRTtJQUNWQyxPQUFPO0FBQ1QsRUFBRTtBQUVLLE1BQU1DLDhCQUFrRDtJQUM3REMsZUFBZTtRQUNiQyxRQUFRO1lBQUUsR0FBR1Isd0JBQXdCO1lBQUVDLFNBQVM7UUFBSztRQUNyRFEsU0FBUztZQUFFLEdBQUdULHdCQUF3QjtZQUFFQyxTQUFTO1FBQUs7UUFDdERTLFdBQVc7WUFBRSxHQUFHVix3QkFBd0I7WUFBRUMsU0FBUztRQUFLO1FBQ3hEVSxVQUFVO1lBQUUsR0FBR1gsd0JBQXdCO1lBQUVDLFNBQVM7UUFBSztRQUN2RFcsUUFBUTtZQUFFLEdBQUdaLHdCQUF3QjtZQUFFQyxTQUFTO1FBQUs7UUFDckRZLFVBQVU7WUFBRSxHQUFHYix3QkFBd0I7WUFBRUMsU0FBUztRQUFNO1FBQ3hEYSxRQUFRO1lBQUUsR0FBR2Qsd0JBQXdCO1lBQUVDLFNBQVM7UUFBTTtJQUN4RDtJQUNBYyxpQkFBaUI7UUFDZkMsaUJBQWlCO1FBQ2pCQyxZQUFZO1FBQ1pDLG1CQUFtQjtRQUNuQkMsb0JBQW9CO1FBQ3BCQyxtQkFBbUI7SUFDckI7SUFDQUMsVUFBVTtJQUNWQyxhQUFhLElBQUlDLE9BQU9DLFdBQVc7QUFDckMsRUFBRSIsInNvdXJjZXMiOlsiL1VzZXJzL21hY2Jvb2svRGVza3RvcC90cnBpLWFwcC90eXBlcy9hdmFpbGFiaWxpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmhhbmNlZCAzLUxldmVsIEF2YWlsYWJpbGl0eSBTeXN0ZW0gVHlwZXNcbiAqIFxuICogVGhpcyBmaWxlIGRlZmluZXMgdGhlIFR5cGVTY3JpcHQgaW50ZXJmYWNlcyBmb3IgdGhlIGNvbXByZWhlbnNpdmUgYXZhaWxhYmlsaXR5IHN5c3RlbVxuICogdGhhdCBzdXBwb3J0cyB3ZWVrbHkgdGVtcGxhdGVzLCBzcGVjaWZpYyBkYXRlIG92ZXJyaWRlcywgYW5kIHJlYWwtdGltZSBhdmFpbGFiaWxpdHkuXG4gKi9cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09SRSBBVkFJTEFCSUxJVFkgVFlQRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBUaW1lUmFuZ2Uge1xuICBzdGFydDogc3RyaW5nOyAvLyBGb3JtYXQ6IFwiSEg6TU1cIiAoMjQtaG91cilcbiAgZW5kOiBzdHJpbmc7ICAgLy8gRm9ybWF0OiBcIkhIOk1NXCIgKDI0LWhvdXIpXG4gIHR5cGU6ICdhdmFpbGFibGUnIHwgJ2JyZWFrJyB8ICd1bmF2YWlsYWJsZSc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGltZVNsb3Qge1xuICBpZDogc3RyaW5nO1xuICBzdGFydDogc3RyaW5nOyAvLyBGb3JtYXQ6IFwiSEg6TU1cIlxuICBlbmQ6IHN0cmluZzsgICAvLyBGb3JtYXQ6IFwiSEg6TU1cIlxuICBkdXJhdGlvbjogbnVtYmVyOyAvLyBpbiBtaW51dGVzXG4gIHR5cGU6ICdpbmRpdmlkdWFsJyB8ICdncm91cCcgfCAnY29uc3VsdGF0aW9uJztcbiAgbWF4U2Vzc2lvbnM6IG51bWJlcjtcbiAgdGl0bGU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGlzQXZhaWxhYmxlOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERheUF2YWlsYWJpbGl0eSB7XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG4gIGdlbmVyYWxIb3Vycz86IHtcbiAgICBzdGFydDogc3RyaW5nOyAvLyBGb3JtYXQ6IFwiSEg6TU1cIlxuICAgIGVuZDogc3RyaW5nOyAgIC8vIEZvcm1hdDogXCJISDpNTVwiXG4gICAgdG90YWxIb3VyczogbnVtYmVyOyAvLyBUb3RhbCBob3VycyBhdmFpbGFibGUgZm9yIHNlc3Npb25zXG4gICAgc2Vzc2lvbkR1cmF0aW9uOiBudW1iZXI7IC8vIER1cmF0aW9uIHBlciBzZXNzaW9uIGluIG1pbnV0ZXNcbiAgICBidWZmZXJUaW1lOiBudW1iZXI7IC8vIEJ1ZmZlciBiZXR3ZWVuIHNlc3Npb25zIGluIG1pbnV0ZXNcbiAgfTtcbiAgY3VzdG9tU2xvdHM6IFRpbWVTbG90W107IC8vIEN1c3RvbSBzbG90cyB0aGF0IG92ZXJyaWRlIGdlbmVyYWwgaG91cnNcbiAgdGltZVNsb3RzOiBUaW1lU2xvdFtdOyAvLyBMZWdhY3kgc3VwcG9ydFxuICBicmVha3M/OiBUaW1lUmFuZ2VbXTtcbiAgbm90ZXM/OiBzdHJpbmc7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFdFRUtMWSBBVkFJTEFCSUxJVFkgU1lTVEVNXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2Vla2x5QXZhaWxhYmlsaXR5IHtcbiAgc3RhbmRhcmRIb3Vyczoge1xuICAgIG1vbmRheTogRGF5QXZhaWxhYmlsaXR5O1xuICAgIHR1ZXNkYXk6IERheUF2YWlsYWJpbGl0eTtcbiAgICB3ZWRuZXNkYXk6IERheUF2YWlsYWJpbGl0eTtcbiAgICB0aHVyc2RheTogRGF5QXZhaWxhYmlsaXR5O1xuICAgIGZyaWRheTogRGF5QXZhaWxhYmlsaXR5O1xuICAgIHNhdHVyZGF5OiBEYXlBdmFpbGFiaWxpdHk7XG4gICAgc3VuZGF5OiBEYXlBdmFpbGFiaWxpdHk7XG4gIH07XG4gIHNlc3Npb25TZXR0aW5nczogU2Vzc2lvblNldHRpbmdzO1xuICB0aW1lem9uZTogc3RyaW5nO1xuICBsYXN0VXBkYXRlZDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlc3Npb25TZXR0aW5ncyB7XG4gIHNlc3Npb25EdXJhdGlvbjogbnVtYmVyOyAvLyBpbiBtaW51dGVzXG4gIGJ1ZmZlclRpbWU6IG51bWJlcjsgLy8gaW4gbWludXRlcyBiZXR3ZWVuIHNlc3Npb25zXG4gIG1heFNlc3Npb25zUGVyRGF5OiBudW1iZXI7XG4gIGFkdmFuY2VCb29raW5nRGF5czogbnVtYmVyOyAvLyBob3cgbWFueSBkYXlzIGluIGFkdmFuY2UgY2xpZW50cyBjYW4gYm9va1xuICBjYW5jZWxsYXRpb25Ib3VyczogbnVtYmVyOyAvLyBtaW5pbXVtIGhvdXJzIGJlZm9yZSBzZXNzaW9uIHRvIGNhbmNlbFxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBVkFJTEFCSUxJVFkgT1ZFUlJJREVTIFNZU1RFTVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIEF2YWlsYWJpbGl0eU92ZXJyaWRlIHtcbiAgaWQ6IHN0cmluZztcbiAgdGhlcmFwaXN0SWQ6IHN0cmluZztcbiAgZGF0ZTogc3RyaW5nOyAvLyBGb3JtYXQ6IFwiWVlZWS1NTS1ERFwiXG4gIHR5cGU6ICd1bmF2YWlsYWJsZScgfCAnY3VzdG9tX2hvdXJzJyB8ICdyZWR1Y2VkX2hvdXJzJztcbiAgaXNBdmFpbGFibGU6IGJvb2xlYW47XG4gIGN1c3RvbUhvdXJzPzoge1xuICAgIHN0YXJ0OiBzdHJpbmc7XG4gICAgZW5kOiBzdHJpbmc7XG4gICAgdGltZVNsb3RzOiBUaW1lU2xvdFtdO1xuICB9O1xuICByZWFzb246IHN0cmluZztcbiAgbm90ZXM/OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ6IHN0cmluZztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUkVBTC1USU1FIEFWQUlMQUJJTElUWSBTWVNURU1cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBSZWFsVGltZUF2YWlsYWJpbGl0eSB7XG4gIHRoZXJhcGlzdElkOiBzdHJpbmc7XG4gIGRhdGU6IHN0cmluZztcbiAgdGltZVNsb3RzOiBUaW1lU2xvdFtdO1xuICBpc09ubGluZTogYm9vbGVhbjtcbiAgbGFzdFNlZW46IHN0cmluZztcbiAgY3VycmVudFNlc3Npb24/OiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBzdGFydFRpbWU6IHN0cmluZztcbiAgICBlbmRUaW1lOiBzdHJpbmc7XG4gICAgY2xpZW50TmFtZTogc3RyaW5nO1xuICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBURU1QTEFURSBTWVNURU1cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBBdmFpbGFiaWxpdHlUZW1wbGF0ZSB7XG4gIGlkOiBzdHJpbmc7XG4gIHRoZXJhcGlzdElkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHdlZWtseUF2YWlsYWJpbGl0eTogV2Vla2x5QXZhaWxhYmlsaXR5O1xuICBpc0RlZmF1bHQ6IGJvb2xlYW47XG4gIGlzQWN0aXZlOiBib29sZWFuO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFQSSBSRVFVRVNUL1JFU1BPTlNFIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2F2ZUF2YWlsYWJpbGl0eVJlcXVlc3Qge1xuICB0aGVyYXBpc3RJZDogc3RyaW5nO1xuICBhdmFpbGFiaWxpdHk6IFdlZWtseUF2YWlsYWJpbGl0eTtcbiAgdGVtcGxhdGVOYW1lPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNhdmVBdmFpbGFiaWxpdHlSZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgYXZhaWxhYmlsaXR5PzogV2Vla2x5QXZhaWxhYmlsaXR5O1xuICB0ZW1wbGF0ZUlkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldEF2YWlsYWJpbGl0eVJlc3BvbnNlIHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHk7XG4gIG92ZXJyaWRlczogQXZhaWxhYmlsaXR5T3ZlcnJpZGVbXTtcbiAgdGVtcGxhdGVzOiBBdmFpbGFiaWxpdHlUZW1wbGF0ZVtdO1xuICByZWFsVGltZVN0YXR1cz86IFJlYWxUaW1lQXZhaWxhYmlsaXR5O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNhdmVPdmVycmlkZVJlcXVlc3Qge1xuICB0aGVyYXBpc3RJZDogc3RyaW5nO1xuICBkYXRlOiBzdHJpbmc7XG4gIHR5cGU6ICd1bmF2YWlsYWJsZScgfCAnY3VzdG9tX2hvdXJzJyB8ICdyZWR1Y2VkX2hvdXJzJztcbiAgaXNBdmFpbGFibGU6IGJvb2xlYW47XG4gIGN1c3RvbUhvdXJzPzoge1xuICAgIHN0YXJ0OiBzdHJpbmc7XG4gICAgZW5kOiBzdHJpbmc7XG4gICAgdGltZVNsb3RzOiBUaW1lU2xvdFtdO1xuICB9O1xuICByZWFzb246IHN0cmluZztcbiAgbm90ZXM/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2F2ZU92ZXJyaWRlUmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIG92ZXJyaWRlOiBBdmFpbGFiaWxpdHlPdmVycmlkZTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ0FMRU5EQVIgQ09NUE9ORU5UIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FsZW5kYXJEYXkge1xuICBkYXRlOiBzdHJpbmc7XG4gIGRheU5hbWU6IHN0cmluZztcbiAgZGF5T2ZXZWVrOiBudW1iZXI7XG4gIGlzVG9kYXk6IGJvb2xlYW47XG4gIGlzUGFzdDogYm9vbGVhbjtcbiAgaXNDdXJyZW50TW9udGg6IGJvb2xlYW47XG4gIGF2YWlsYWJpbGl0eTogRGF5QXZhaWxhYmlsaXR5O1xuICBvdmVycmlkZT86IEF2YWlsYWJpbGl0eU92ZXJyaWRlO1xuICBzZXNzaW9ucz86IFNlc3Npb25JbmZvW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvbkluZm8ge1xuICBpZDogc3RyaW5nO1xuICBzdGFydFRpbWU6IHN0cmluZztcbiAgZW5kVGltZTogc3RyaW5nO1xuICBjbGllbnROYW1lOiBzdHJpbmc7XG4gIHN0YXR1czogJ3NjaGVkdWxlZCcgfCAnaW5fcHJvZ3Jlc3MnIHwgJ2NvbXBsZXRlZCcgfCAnY2FuY2VsbGVkJztcbiAgdHlwZTogJ2luZGl2aWR1YWwnIHwgJ2dyb3VwJztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVVRJTElUWSBUWVBFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIEF2YWlsYWJpbGl0eVN0YXRzIHtcbiAgdG90YWxBdmFpbGFibGVIb3VyczogbnVtYmVyO1xuICB0b3RhbFNlc3Npb25zU2NoZWR1bGVkOiBudW1iZXI7XG4gIGF2ZXJhZ2VTZXNzaW9uc1BlckRheTogbnVtYmVyO1xuICBtb3N0UG9wdWxhclRpbWVTbG90czogc3RyaW5nW107XG4gIHVwY29taW5nU2Vzc2lvbnM6IFNlc3Npb25JbmZvW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGltZVNsb3RWYWxpZGF0aW9uIHtcbiAgaXNWYWxpZDogYm9vbGVhbjtcbiAgZXJyb3JzOiBzdHJpbmdbXTtcbiAgd2FybmluZ3M6IHN0cmluZ1tdO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT01QT05FTlQgUFJPUFMgVFlQRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBBdmFpbGFiaWxpdHlNYW5hZ2VyUHJvcHMge1xuICB0aGVyYXBpc3RJZDogc3RyaW5nO1xuICBpbml0aWFsQXZhaWxhYmlsaXR5PzogV2Vla2x5QXZhaWxhYmlsaXR5O1xuICBvblNhdmU/OiAoYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHkpID0+IHZvaWQ7XG4gIG9uRXJyb3I/OiAoZXJyb3I6IHN0cmluZykgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXZWVrbHlDYWxlbmRhclByb3BzIHtcbiAgYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHk7XG4gIG9uQXZhaWxhYmlsaXR5Q2hhbmdlOiAoYXZhaWxhYmlsaXR5OiBXZWVrbHlBdmFpbGFiaWxpdHkpID0+IHZvaWQ7XG4gIG9uRGF5Q2xpY2s/OiAoZGF0ZTogc3RyaW5nKSA9PiB2b2lkO1xuICBvblRpbWVTbG90Q2xpY2s/OiAoZGF0ZTogc3RyaW5nLCB0aW1lU2xvdDogVGltZVNsb3QpID0+IHZvaWQ7XG4gIHJlYWRPbmx5PzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaW1lU2xvdEVkaXRvclByb3BzIHtcbiAgdGltZVNsb3Q6IFRpbWVTbG90O1xuICBvblVwZGF0ZTogKHRpbWVTbG90OiBUaW1lU2xvdCkgPT4gdm9pZDtcbiAgb25EZWxldGU6ICh0aW1lU2xvdElkOiBzdHJpbmcpID0+IHZvaWQ7XG4gIGF2YWlsYWJsZVR5cGVzOiBzdHJpbmdbXTtcbiAgbWF4RHVyYXRpb24/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXZhaWxhYmlsaXR5T3ZlcnJpZGVQcm9wcyB7XG4gIHRoZXJhcGlzdElkOiBzdHJpbmc7XG4gIHNlbGVjdGVkRGF0ZT86IHN0cmluZztcbiAgb25PdmVycmlkZVNhdmVkPzogKG92ZXJyaWRlOiBBdmFpbGFiaWxpdHlPdmVycmlkZSkgPT4gdm9pZDtcbiAgb25PdmVycmlkZURlbGV0ZWQ/OiAob3ZlcnJpZGVJZDogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05TVEFOVFNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IERBWVNfT0ZfV0VFSyA9IFtcbiAgJ3N1bmRheScsXG4gICdtb25kYXknLCBcbiAgJ3R1ZXNkYXknLFxuICAnd2VkbmVzZGF5JyxcbiAgJ3RodXJzZGF5JyxcbiAgJ2ZyaWRheScsXG4gICdzYXR1cmRheSdcbl0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBTRVNTSU9OX1RZUEVTID0gW1xuICAnaW5kaXZpZHVhbCcsXG4gICdncm91cCcsXG4gICdjb25zdWx0YXRpb24nXG5dIGFzIGNvbnN0O1xuXG5leHBvcnQgY29uc3QgT1ZFUlJJREVfVFlQRVMgPSBbXG4gICd1bmF2YWlsYWJsZScsXG4gICdjdXN0b21faG91cnMnLFxuICAncmVkdWNlZF9ob3Vycydcbl0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFU1NJT05fRFVSQVRJT05TID0gWzMwLCA0NSwgNjAsIDkwLCAxMjBdIGFzIGNvbnN0O1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9USU1FX1NMT1Q6IFRpbWVTbG90ID0ge1xuICBpZDogJycsXG4gIHN0YXJ0OiAnMDk6MDAnLFxuICBlbmQ6ICcxMDowMCcsXG4gIGR1cmF0aW9uOiA2MCxcbiAgdHlwZTogJ2luZGl2aWR1YWwnLFxuICBtYXhTZXNzaW9uczogMSxcbiAgdGl0bGU6ICdJbmRpdmlkdWFsIFRoZXJhcHkgU2Vzc2lvbicsXG4gIGlzQXZhaWxhYmxlOiB0cnVlXG59O1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9EQVlfQVZBSUxBQklMSVRZOiBEYXlBdmFpbGFiaWxpdHkgPSB7XG4gIGVuYWJsZWQ6IGZhbHNlLFxuICBjdXN0b21TbG90czogW10sXG4gIHRpbWVTbG90czogW10sIC8vIExlZ2FjeSBzdXBwb3J0XG4gIGJyZWFrczogW10sXG4gIG5vdGVzOiAnJ1xufTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfV0VFS0xZX0FWQUlMQUJJTElUWTogV2Vla2x5QXZhaWxhYmlsaXR5ID0ge1xuICBzdGFuZGFyZEhvdXJzOiB7XG4gICAgbW9uZGF5OiB7IC4uLkRFRkFVTFRfREFZX0FWQUlMQUJJTElUWSwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgIHR1ZXNkYXk6IHsgLi4uREVGQVVMVF9EQVlfQVZBSUxBQklMSVRZLCBlbmFibGVkOiB0cnVlIH0sXG4gICAgd2VkbmVzZGF5OiB7IC4uLkRFRkFVTFRfREFZX0FWQUlMQUJJTElUWSwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgIHRodXJzZGF5OiB7IC4uLkRFRkFVTFRfREFZX0FWQUlMQUJJTElUWSwgZW5hYmxlZDogdHJ1ZSB9LFxuICAgIGZyaWRheTogeyAuLi5ERUZBVUxUX0RBWV9BVkFJTEFCSUxJVFksIGVuYWJsZWQ6IHRydWUgfSxcbiAgICBzYXR1cmRheTogeyAuLi5ERUZBVUxUX0RBWV9BVkFJTEFCSUxJVFksIGVuYWJsZWQ6IGZhbHNlIH0sXG4gICAgc3VuZGF5OiB7IC4uLkRFRkFVTFRfREFZX0FWQUlMQUJJTElUWSwgZW5hYmxlZDogZmFsc2UgfVxuICB9LFxuICBzZXNzaW9uU2V0dGluZ3M6IHtcbiAgICBzZXNzaW9uRHVyYXRpb246IDYwLFxuICAgIGJ1ZmZlclRpbWU6IDE1LFxuICAgIG1heFNlc3Npb25zUGVyRGF5OiA4LFxuICAgIGFkdmFuY2VCb29raW5nRGF5czogMzAsXG4gICAgY2FuY2VsbGF0aW9uSG91cnM6IDI0XG4gIH0sXG4gIHRpbWV6b25lOiAnVVRDJyxcbiAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxufTtcbiJdLCJuYW1lcyI6WyJEQVlTX09GX1dFRUsiLCJTRVNTSU9OX1RZUEVTIiwiT1ZFUlJJREVfVFlQRVMiLCJERUZBVUxUX1NFU1NJT05fRFVSQVRJT05TIiwiREVGQVVMVF9USU1FX1NMT1QiLCJpZCIsInN0YXJ0IiwiZW5kIiwiZHVyYXRpb24iLCJ0eXBlIiwibWF4U2Vzc2lvbnMiLCJ0aXRsZSIsImlzQXZhaWxhYmxlIiwiREVGQVVMVF9EQVlfQVZBSUxBQklMSVRZIiwiZW5hYmxlZCIsImN1c3RvbVNsb3RzIiwidGltZVNsb3RzIiwiYnJlYWtzIiwibm90ZXMiLCJERUZBVUxUX1dFRUtMWV9BVkFJTEFCSUxJVFkiLCJzdGFuZGFyZEhvdXJzIiwibW9uZGF5IiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5Iiwic2F0dXJkYXkiLCJzdW5kYXkiLCJzZXNzaW9uU2V0dGluZ3MiLCJzZXNzaW9uRHVyYXRpb24iLCJidWZmZXJUaW1lIiwibWF4U2Vzc2lvbnNQZXJEYXkiLCJhZHZhbmNlQm9va2luZ0RheXMiLCJjYW5jZWxsYXRpb25Ib3VycyIsInRpbWV6b25lIiwibGFzdFVwZGF0ZWQiLCJEYXRlIiwidG9JU09TdHJpbmciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./types/availability.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/jose","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&page=%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftherapist%2Favailability%2Ftemplate%2Froute.ts&appDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmacbook%2FDesktop%2Ftrpi-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();